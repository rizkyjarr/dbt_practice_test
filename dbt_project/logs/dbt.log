[0m02:01:58.167482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cc44a050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cc9a0690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cc4481d0>]}


============================== 02:01:58.169998 | f30404dd-70bc-499f-b040-8dec280d234b ==============================
[0m02:01:58.169998 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:01:58.171483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:01:58.194779 [info ] [MainThread]: dbt version: 1.9.0
[0m02:01:58.196604 [info ] [MainThread]: python version: 3.11.2
[0m02:01:58.199261 [info ] [MainThread]: python path: /usr/local/bin/python
[0m02:01:58.200610 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m02:01:58.202280 [info ] [MainThread]: Using profiles dir at /usr/app/dbt_project
[0m02:01:58.204031 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt_project/profiles.yml
[0m02:01:58.205188 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m02:01:58.303120 [info ] [MainThread]: Configuration:
[0m02:01:58.304294 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m02:01:58.305538 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:01:58.306951 [info ] [MainThread]: Required dependencies:
[0m02:01:58.308008 [debug] [MainThread]: Executing "git --help"
[0m02:01:58.323742 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:01:58.324603 [debug] [MainThread]: STDERR: "b''"
[0m02:01:58.325333 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:01:58.326344 [info ] [MainThread]: Connection test skipped since no profile was found
[0m02:01:58.327995 [info ] [MainThread]: [31m1 check failed:[0m
[0m02:01:58.329152 [info ] [MainThread]: dbt looked for a profiles.yml file in /usr/app/dbt_project/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m02:01:58.331588 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.21399155, "process_in_blocks": "776", "process_kernel_time": 0.060459, "process_mem_max_rss": "90472", "process_out_blocks": "0", "process_user_time": 0.977432}
[0m02:01:58.332640 [debug] [MainThread]: Command `dbt debug` failed at 02:01:58.332515 after 0.22 seconds
[0m02:01:58.333781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cc429c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cfd6d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52cfd6d150>]}
[0m02:01:58.334968 [debug] [MainThread]: Flushing usage events
[0m02:01:59.648058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:01.751208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58c3dce910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58c42af7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58c3dcd990>]}


============================== 02:03:01.755328 | 7f50ea83-094b-4ed3-971d-39636c6fa73a ==============================
[0m02:03:01.755328 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:03:01.756721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:03:01.767470 [info ] [MainThread]: dbt version: 1.9.0
[0m02:03:01.768348 [info ] [MainThread]: python version: 3.11.2
[0m02:03:01.769784 [info ] [MainThread]: python path: /usr/local/bin/python
[0m02:03:01.770739 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m02:03:02.302614 [info ] [MainThread]: Using profiles dir at /usr/app/dbt_project
[0m02:03:02.303759 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt_project/profiles.yml
[0m02:03:02.304871 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m02:03:02.305801 [info ] [MainThread]: adapter type: bigquery
[0m02:03:02.307297 [info ] [MainThread]: adapter version: 1.9.0
[0m02:03:02.402199 [info ] [MainThread]: Configuration:
[0m02:03:02.403292 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:03:02.404241 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:03:02.405112 [info ] [MainThread]: Required dependencies:
[0m02:03:02.406134 [debug] [MainThread]: Executing "git --help"
[0m02:03:02.408326 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:03:02.409631 [debug] [MainThread]: STDERR: "b''"
[0m02:03:02.410439 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:03:02.411349 [info ] [MainThread]: Connection:
[0m02:03:02.412438 [info ] [MainThread]:   method: service-account
[0m02:03:02.413312 [info ] [MainThread]:   database: purwadika
[0m02:03:02.414164 [info ] [MainThread]:   execution_project: purwadika
[0m02:03:02.415144 [info ] [MainThread]:   schema: rizky_dwh_hailing_source
[0m02:03:02.416415 [info ] [MainThread]:   location: None
[0m02:03:02.417588 [info ] [MainThread]:   priority: None
[0m02:03:02.418533 [info ] [MainThread]:   maximum_bytes_billed: None
[0m02:03:02.419663 [info ] [MainThread]:   impersonate_service_account: None
[0m02:03:02.420829 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m02:03:02.422152 [info ] [MainThread]:   job_retries: 1
[0m02:03:02.423846 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m02:03:02.424872 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m02:03:02.426031 [info ] [MainThread]:   timeout_seconds: None
[0m02:03:02.427484 [info ] [MainThread]:   client_id: None
[0m02:03:02.428781 [info ] [MainThread]:   token_uri: None
[0m02:03:02.430586 [info ] [MainThread]:   dataproc_region: None
[0m02:03:02.431899 [info ] [MainThread]:   dataproc_cluster_name: None
[0m02:03:02.432880 [info ] [MainThread]:   gcs_bucket: None
[0m02:03:02.434031 [info ] [MainThread]:   dataproc_batch: None
[0m02:03:02.435123 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m02:03:02.502738 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m02:03:02.503622 [debug] [MainThread]: On debug: select 1 as id
[0m02:03:02.504454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:03:02.531994 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: '[Errno 21] Is a directory: '/root/.dbt/credentials.json''
[0m02:03:02.533124 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
select 1 as id
[0m02:03:02.534054 [debug] [MainThread]: BigQuery adapter: Database Error
  [Errno 21] Is a directory: '/root/.dbt/credentials.json'
[0m02:03:02.534785 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m02:03:02.535672 [info ] [MainThread]: [31m1 check failed:[0m
[0m02:03:02.536718 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >'NoneType' object has no attribute 'close'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m02:03:02.538374 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.8450967, "process_in_blocks": "696", "process_kernel_time": 0.1747, "process_mem_max_rss": "207440", "process_out_blocks": "24", "process_user_time": 2.733544}
[0m02:03:02.539326 [debug] [MainThread]: Command `dbt debug` failed at 02:03:02.539222 after 0.85 seconds
[0m02:03:02.540230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58c3e04450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5896576250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58c4aaf290>]}
[0m02:03:02.541443 [debug] [MainThread]: Flushing usage events
[0m02:03:03.693784 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:04:31.038959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd596e53810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd596f60e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd596e87090>]}


============================== 02:04:31.043418 | 81d713c9-fbc7-4523-921b-5a295ad22e3d ==============================
[0m02:04:31.043418 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:04:31.044686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:04:31.051027 [info ] [MainThread]: dbt version: 1.9.0
[0m02:04:31.051864 [info ] [MainThread]: python version: 3.11.2
[0m02:04:31.054054 [info ] [MainThread]: python path: /usr/local/bin/python
[0m02:04:31.055178 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m02:04:31.556857 [info ] [MainThread]: Using profiles dir at /usr/app/dbt_project
[0m02:04:31.558394 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt_project/profiles.yml
[0m02:04:31.559756 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m02:04:31.561102 [info ] [MainThread]: adapter type: bigquery
[0m02:04:31.562446 [info ] [MainThread]: adapter version: 1.9.0
[0m02:04:31.641979 [info ] [MainThread]: Configuration:
[0m02:04:31.644292 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:04:31.645262 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:04:31.646400 [info ] [MainThread]: Required dependencies:
[0m02:04:31.647547 [debug] [MainThread]: Executing "git --help"
[0m02:04:31.649460 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:04:31.650135 [debug] [MainThread]: STDERR: "b''"
[0m02:04:31.650881 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:04:31.651960 [info ] [MainThread]: Connection:
[0m02:04:31.653391 [info ] [MainThread]:   method: service-account
[0m02:04:31.654439 [info ] [MainThread]:   database: purwadika
[0m02:04:31.655544 [info ] [MainThread]:   execution_project: purwadika
[0m02:04:31.656705 [info ] [MainThread]:   schema: rizky_dwh_hailing_source
[0m02:04:31.659063 [info ] [MainThread]:   location: None
[0m02:04:31.660554 [info ] [MainThread]:   priority: None
[0m02:04:31.661527 [info ] [MainThread]:   maximum_bytes_billed: None
[0m02:04:31.662408 [info ] [MainThread]:   impersonate_service_account: None
[0m02:04:31.663369 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m02:04:31.664496 [info ] [MainThread]:   job_retries: 1
[0m02:04:31.665590 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m02:04:31.666913 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m02:04:31.667968 [info ] [MainThread]:   timeout_seconds: None
[0m02:04:31.668867 [info ] [MainThread]:   client_id: None
[0m02:04:31.669906 [info ] [MainThread]:   token_uri: None
[0m02:04:31.670765 [info ] [MainThread]:   dataproc_region: None
[0m02:04:31.671720 [info ] [MainThread]:   dataproc_cluster_name: None
[0m02:04:31.672753 [info ] [MainThread]:   gcs_bucket: None
[0m02:04:31.673635 [info ] [MainThread]:   dataproc_batch: None
[0m02:04:31.674714 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m02:04:31.729175 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m02:04:31.730186 [debug] [MainThread]: On debug: select 1 as id
[0m02:04:31.731072 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:04:32.794278 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:87d88a11-3360-405e-8b46-a8ca6bbbbf3c&page=queryresults
[0m02:04:33.636786 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:04:33.638193 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:04:33.639993 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.6463816, "process_in_blocks": "1728", "process_kernel_time": 0.200069, "process_mem_max_rss": "212840", "process_out_blocks": "1952", "process_user_time": 2.727258}
[0m02:04:33.641273 [debug] [MainThread]: Command `dbt debug` succeeded at 02:04:33.641161 after 2.65 seconds
[0m02:04:33.642154 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:04:33.643123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd596ccfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59a8ed810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59a5f4b90>]}
[0m02:04:33.644089 [debug] [MainThread]: Flushing usage events
[0m02:04:35.179263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:13:23.075436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40d3efc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40d3eed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40d4f9c90>]}


============================== 02:13:23.078000 | c09a6ece-1481-4071-b0cc-401b4b306eb2 ==============================
[0m02:13:23.078000 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:13:23.079859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:13:23.657306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c09a6ece-1481-4071-b0cc-401b4b306eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3df58ee90>]}
[0m02:13:23.701756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c09a6ece-1481-4071-b0cc-401b4b306eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3df668f10>]}
[0m02:13:23.703096 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m02:13:23.769821 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:13:23.772243 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:13:23.773545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c09a6ece-1481-4071-b0cc-401b4b306eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3df304610>]}
[0m02:13:24.778057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c09a6ece-1481-4071-b0cc-401b4b306eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3df184190>]}
[0m02:13:24.848924 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m02:13:24.854999 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m02:13:24.878854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c09a6ece-1481-4071-b0cc-401b4b306eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3dd7f51d0>]}
[0m02:13:24.880016 [info ] [MainThread]: Found 4 models, 4 sources, 487 macros
[0m02:13:24.881104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c09a6ece-1481-4071-b0cc-401b4b306eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3df174a90>]}
[0m02:13:24.883858 [info ] [MainThread]: 
[0m02:13:24.884947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:13:24.885962 [info ] [MainThread]: 
[0m02:13:24.887547 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:13:24.892377 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m02:13:24.893723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:13:25.533676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now create_purwadika_rizky_dwh_hailing_source_staging_layer)
[0m02:13:25.534636 [debug] [ThreadPool]: Creating schema "database: "purwadika"
schema: "rizky_dwh_hailing_source_staging_layer"
"
[0m02:13:25.544110 [debug] [ThreadPool]: On create_purwadika_rizky_dwh_hailing_source_staging_layer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "connection_name": "create_purwadika_rizky_dwh_hailing_source_staging_layer"} */
create schema if not exists `purwadika`.`rizky_dwh_hailing_source_staging_layer`
  
[0m02:13:25.545018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:13:26.420654 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:ff549e3d-6554-4cfb-bd1b-ec70f66fdf2b&page=queryresults
[0m02:13:27.364350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_purwadika_rizky_dwh_hailing_source_staging_layer, now list_purwadika_rizky_dwh_hailing_source_staging_layer)
[0m02:13:27.365587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:13:27.962897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c09a6ece-1481-4071-b0cc-401b4b306eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3df3d4a90>]}
[0m02:13:27.964146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:13:27.968860 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m02:13:27.969238 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m02:13:27.969552 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m02:13:27.969869 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m02:13:27.970397 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source_staging_layer.stg_customer  [RUN]
[0m02:13:27.971371 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source_staging_layer.stg_driver  [RUN]
[0m02:13:27.972555 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source_staging_layer.stg_ride  [RUN]
[0m02:13:27.973745 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source_staging_layer.stg_vehicle  [RUN]
[0m02:13:27.974666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source_staging_layer, now model.hailing_project.stg_customer)
[0m02:13:27.975693 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m02:13:27.976480 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m02:13:27.977492 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m02:13:27.978532 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m02:13:27.979457 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m02:13:27.980371 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m02:13:27.981171 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m02:13:27.990440 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m02:13:27.993778 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m02:13:27.997289 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m02:13:28.002557 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m02:13:28.013883 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m02:13:28.020199 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m02:13:28.055805 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m02:13:28.077280 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m02:13:28.094918 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m02:13:28.095777 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m02:13:28.098535 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m02:13:28.102086 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m02:13:28.113235 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_staging_layer`.`stg_customer`
      
    
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
),

cleaned AS (
    SELECT
        customer_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m02:13:28.114468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:13:28.114968 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_staging_layer`.`stg_ride`
      
    
    

    OPTIONS()
    as (
      

SELECT *
FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
    );
  
[0m02:13:28.116441 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_staging_layer`.`stg_vehicle`
      
    
    

    OPTIONS()
    as (
      

SELECT *
FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
    );
  
[0m02:13:28.117278 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:13:28.118506 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:13:28.120172 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_staging_layer`.`stg_driver`
      
    
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m02:13:28.168238 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:13:28.521749 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:646f9616-63cc-45b6-bf88-99d73b4ed749&page=queryresults
[0m02:13:28.523204 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:646f9616-63cc-45b6-bf88-99d73b4ed749&page=queryresults
[0m02:13:28.528143 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f54b5075-3bf2-4aba-9c4a-dd2e97f5d340&page=queryresults
[0m02:13:28.529736 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:33a93330-c5ad-4749-9727-560eebeb7501&page=queryresults
[0m02:13:28.530267 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f54b5075-3bf2-4aba-9c4a-dd2e97f5d340&page=queryresults
[0m02:13:28.531426 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:33a93330-c5ad-4749-9727-560eebeb7501&page=queryresults
[0m02:13:28.541292 [debug] [Thread-4 (]: Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql
[0m02:13:28.542367 [debug] [Thread-1 (]: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m02:13:28.543449 [debug] [Thread-2 (]: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m02:13:28.545777 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c09a6ece-1481-4071-b0cc-401b4b306eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3df15de50>]}
[0m02:13:28.546575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c09a6ece-1481-4071-b0cc-401b4b306eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3dcc6e4d0>]}
[0m02:13:28.547746 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c09a6ece-1481-4071-b0cc-401b4b306eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3dcb1f610>]}
[0m02:13:28.549150 [error] [Thread-4 (]: 4 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_staging_layer.stg_vehicle  [[31mERROR[0m in 0.57s]
[0m02:13:28.551069 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_staging_layer.stg_customer  [[31mERROR[0m in 0.57s]
[0m02:13:28.553330 [error] [Thread-2 (]: 2 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_staging_layer.stg_driver  [[31mERROR[0m in 0.57s]
[0m02:13:28.554927 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m02:13:28.556276 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m02:13:28.557515 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m02:13:28.558931 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_vehicle' to be skipped because of status 'error'.  Reason: Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql.
[0m02:13:28.561649 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_customer' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql.
[0m02:13:28.562905 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_driver' to be skipped because of status 'error'.  Reason: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql.
[0m02:13:28.565097 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:4885aa9d-e541-4d05-bcc8-860385bcb7c1&page=queryresults
[0m02:13:28.566302 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:4885aa9d-e541-4d05-bcc8-860385bcb7c1&page=queryresults
[0m02:13:28.570401 [debug] [Thread-3 (]: Database Error in model stg_ride (models/staging/stg_ride.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql
[0m02:13:28.571656 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c09a6ece-1481-4071-b0cc-401b4b306eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3dd7053d0>]}
[0m02:13:28.572987 [error] [Thread-3 (]: 3 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_staging_layer.stg_ride  [[31mERROR[0m in 0.60s]
[0m02:13:28.574379 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m02:13:28.575882 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_ride' to be skipped because of status 'error'.  Reason: Database Error in model stg_ride (models/staging/stg_ride.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql.
[0m02:13:28.578237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:13:28.581305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:13:28.581993 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m02:13:28.582844 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m02:13:28.583559 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m02:13:28.584355 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m02:13:28.585086 [info ] [MainThread]: 
[0m02:13:28.586045 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m02:13:28.587818 [debug] [MainThread]: Command end result
[0m02:13:28.623846 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m02:13:28.628422 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m02:13:28.637064 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m02:13:28.637811 [info ] [MainThread]: 
[0m02:13:28.638883 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m02:13:28.640157 [info ] [MainThread]: 
[0m02:13:28.642484 [error] [MainThread]:   Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql
[0m02:13:28.644360 [info ] [MainThread]: 
[0m02:13:28.645843 [error] [MainThread]:   Database Error in model stg_customer (models/staging/stg_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m02:13:28.646854 [info ] [MainThread]: 
[0m02:13:28.647998 [error] [MainThread]:   Database Error in model stg_driver (models/staging/stg_driver.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m02:13:28.649370 [info ] [MainThread]: 
[0m02:13:28.651287 [error] [MainThread]:   Database Error in model stg_ride (models/staging/stg_ride.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql
[0m02:13:28.652467 [info ] [MainThread]: 
[0m02:13:28.653536 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m02:13:28.655363 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.626566, "process_in_blocks": "2952", "process_kernel_time": 0.239406, "process_mem_max_rss": "227664", "process_out_blocks": "120", "process_user_time": 3.980132}
[0m02:13:28.656716 [debug] [MainThread]: Command `dbt run` failed at 02:13:28.656571 after 5.63 seconds
[0m02:13:28.657757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40d26fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40d26f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff410d3c910>]}
[0m02:13:28.659269 [debug] [MainThread]: Flushing usage events
[0m02:13:29.808444 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:18:45.087750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165de0af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165de0b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165de0a810>]}


============================== 02:18:45.090624 | 4a4e9f48-a67f-4b7f-8886-913783f5298a ==============================
[0m02:18:45.090624 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:18:45.091889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:18:45.170120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a4e9f48-a67f-4b7f-8886-913783f5298a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165dd4a150>]}
[0m02:18:45.236071 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19432564, "process_in_blocks": "16", "process_kernel_time": 0.09933, "process_mem_max_rss": "90056", "process_out_blocks": "0", "process_user_time": 0.913843}
[0m02:18:45.237553 [debug] [MainThread]: Command `dbt clean` succeeded at 02:18:45.237391 after 0.20 seconds
[0m02:18:45.238719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165de5fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165de5fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1661600c10>]}
[0m02:18:45.239771 [debug] [MainThread]: Flushing usage events
[0m02:18:46.409339 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:18:47.583171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa9834b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa988b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa9c2de50>]}


============================== 02:18:47.586327 | bdee2df0-a205-4d95-a78f-035433b48340 ==============================
[0m02:18:47.586327 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:18:47.587616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:18:47.673552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdee2df0-a205-4d95-a78f-035433b48340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa96e7590>]}
[0m02:18:47.687732 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:18:47.690576 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:18:47.692333 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15736815, "process_in_blocks": "224", "process_kernel_time": 0.099129, "process_mem_max_rss": "90016", "process_out_blocks": "0", "process_user_time": 1.001206}
[0m02:18:47.693464 [debug] [MainThread]: Command `dbt deps` succeeded at 02:18:47.693309 after 0.16 seconds
[0m02:18:47.694459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fad028c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fad185350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fad1850d0>]}
[0m02:18:47.695615 [debug] [MainThread]: Flushing usage events
[0m02:18:48.762707 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:18:52.308476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38623fb090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38624289d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3862429210>]}


============================== 02:18:52.311249 | 995e2a61-4840-4443-befc-8244674169b3 ==============================
[0m02:18:52.311249 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:18:52.312645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:18:52.907063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '995e2a61-4840-4443-befc-8244674169b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38623fded0>]}
[0m02:18:52.955932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '995e2a61-4840-4443-befc-8244674169b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f383885ef10>]}
[0m02:18:52.957296 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m02:18:53.026383 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:18:53.028816 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:18:53.029763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '995e2a61-4840-4443-befc-8244674169b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38386fdcd0>]}
[0m02:18:54.032005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '995e2a61-4840-4443-befc-8244674169b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38381e0890>]}
[0m02:18:54.103335 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m02:18:54.109105 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m02:18:54.126461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '995e2a61-4840-4443-befc-8244674169b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38381fe650>]}
[0m02:18:54.127461 [info ] [MainThread]: Found 4 models, 4 sources, 487 macros
[0m02:18:54.128376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '995e2a61-4840-4443-befc-8244674169b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3838301450>]}
[0m02:18:54.130972 [info ] [MainThread]: 
[0m02:18:54.132065 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:18:54.133306 [info ] [MainThread]: 
[0m02:18:54.134660 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:18:54.139423 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m02:18:54.140644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:54.790776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now create_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer)
[0m02:18:54.791786 [debug] [ThreadPool]: Creating schema "database: "purwadika"
schema: "rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer"
"
[0m02:18:54.799925 [debug] [ThreadPool]: On create_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "connection_name": "create_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer"} */
create schema if not exists `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer`
  
[0m02:18:54.800625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:55.669445 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:285fe163-a733-42d8-bdca-8b8d38f7b5b4&page=queryresults
[0m02:18:56.649128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer, now list_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer)
[0m02:18:56.650897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:57.247028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '995e2a61-4840-4443-befc-8244674169b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38385a43d0>]}
[0m02:18:57.247999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:18:57.253541 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m02:18:57.253984 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m02:18:57.254370 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m02:18:57.254750 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m02:18:57.255599 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer.stg_customer  [RUN]
[0m02:18:57.256713 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer.stg_driver  [RUN]
[0m02:18:57.258216 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer.stg_ride  [RUN]
[0m02:18:57.259397 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer.stg_vehicle  [RUN]
[0m02:18:57.260814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer, now model.hailing_project.stg_customer)
[0m02:18:57.261950 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m02:18:57.263136 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m02:18:57.264714 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m02:18:57.266058 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m02:18:57.268773 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m02:18:57.271434 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m02:18:57.273046 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m02:18:57.284746 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m02:18:57.289441 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m02:18:57.294893 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m02:18:57.299210 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m02:18:57.310739 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m02:18:57.317324 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m02:18:57.376507 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m02:18:57.382602 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m02:18:57.390017 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m02:18:57.390640 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m02:18:57.393482 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m02:18:57.397157 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m02:18:57.408477 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer`.`stg_driver`
      
    
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m02:18:57.410030 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:18:57.410566 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer`.`stg_ride`
      
    
    

    OPTIONS()
    as (
      

SELECT *
FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
    );
  
[0m02:18:57.411426 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer`.`stg_vehicle`
      
    
    

    OPTIONS()
    as (
      

SELECT *
FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
    );
  
[0m02:18:57.413100 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:18:57.413703 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer`.`stg_customer`
      
    
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
),

cleaned AS (
    SELECT
        customer_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m02:18:57.438615 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:18:57.441446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:57.764466 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6107e896-4330-4e03-92fd-74ee8ca3a5bf&page=queryresults
[0m02:18:57.767348 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6107e896-4330-4e03-92fd-74ee8ca3a5bf&page=queryresults
[0m02:18:57.768242 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c7171be9-3886-4586-806c-f92482b5aba9&page=queryresults
[0m02:18:57.771344 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c7171be9-3886-4586-806c-f92482b5aba9&page=queryresults
[0m02:18:57.774681 [debug] [Thread-2 (]: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m02:18:57.777527 [debug] [Thread-4 (]: Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql
[0m02:18:57.779421 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2c108a5b-ad82-48ce-aaae-e21c5ac369d1&page=queryresults
[0m02:18:57.779887 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '995e2a61-4840-4443-befc-8244674169b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3831dde650>]}
[0m02:18:57.780818 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '995e2a61-4840-4443-befc-8244674169b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3831ca1250>]}
[0m02:18:57.781873 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2c108a5b-ad82-48ce-aaae-e21c5ac369d1&page=queryresults
[0m02:18:57.783172 [error] [Thread-2 (]: 2 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer.stg_driver  [[31mERROR[0m in 0.52s]
[0m02:18:57.784548 [error] [Thread-4 (]: 4 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer.stg_vehicle  [[31mERROR[0m in 0.52s]
[0m02:18:57.788188 [debug] [Thread-1 (]: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m02:18:57.789031 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m02:18:57.790559 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m02:18:57.792189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '995e2a61-4840-4443-befc-8244674169b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3831c256d0>]}
[0m02:18:57.793376 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_driver' to be skipped because of status 'error'.  Reason: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql.
[0m02:18:57.795166 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer.stg_customer  [[31mERROR[0m in 0.53s]
[0m02:18:57.796610 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_vehicle' to be skipped because of status 'error'.  Reason: Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql.
[0m02:18:57.797827 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m02:18:57.800033 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_customer' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql.
[0m02:18:57.840670 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:703422ab-858d-4051-99c6-58851df2b19d&page=queryresults
[0m02:18:57.842184 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:703422ab-858d-4051-99c6-58851df2b19d&page=queryresults
[0m02:18:57.846614 [debug] [Thread-3 (]: Database Error in model stg_ride (models/staging/stg_ride.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql
[0m02:18:57.847909 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '995e2a61-4840-4443-befc-8244674169b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3831c30c10>]}
[0m02:18:57.849065 [error] [Thread-3 (]: 3 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer.stg_ride  [[31mERROR[0m in 0.58s]
[0m02:18:57.850382 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m02:18:57.851855 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_ride' to be skipped because of status 'error'.  Reason: Database Error in model stg_ride (models/staging/stg_ride.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql.
[0m02:18:57.854570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:18:57.857707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:57.858629 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m02:18:57.859634 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m02:18:57.860714 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m02:18:57.861703 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m02:18:57.862721 [info ] [MainThread]: 
[0m02:18:57.863614 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m02:18:57.865233 [debug] [MainThread]: Command end result
[0m02:18:57.896602 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m02:18:57.900681 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m02:18:57.908344 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m02:18:57.909181 [info ] [MainThread]: 
[0m02:18:57.910394 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m02:18:57.911592 [info ] [MainThread]: 
[0m02:18:57.912736 [error] [MainThread]:   Database Error in model stg_driver (models/staging/stg_driver.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m02:18:57.913900 [info ] [MainThread]: 
[0m02:18:57.915756 [error] [MainThread]:   Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql
[0m02:18:57.917607 [info ] [MainThread]: 
[0m02:18:57.919166 [error] [MainThread]:   Database Error in model stg_customer (models/staging/stg_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m02:18:57.920601 [info ] [MainThread]: 
[0m02:18:57.922638 [error] [MainThread]:   Database Error in model stg_ride (models/staging/stg_ride.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_source_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql
[0m02:18:57.924235 [info ] [MainThread]: 
[0m02:18:57.926002 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m02:18:57.929051 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.6718855, "process_in_blocks": "0", "process_kernel_time": 0.240604, "process_mem_max_rss": "228632", "process_out_blocks": "0", "process_user_time": 4.130384}
[0m02:18:57.930771 [debug] [MainThread]: Command `dbt run` failed at 02:18:57.930469 after 5.67 seconds
[0m02:18:57.932291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38627f2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3865ee57d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3865d70850>]}
[0m02:18:57.933518 [debug] [MainThread]: Flushing usage events
[0m02:18:58.973754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:19:43.036703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f4546e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f459b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f493e110>]}


============================== 02:19:43.039152 | 7f508b4b-59f7-4147-8cd6-0d08a45c1978 ==============================
[0m02:19:43.039152 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:19:43.040884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:19:43.124750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f508b4b-59f7-4147-8cd6-0d08a45c1978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f493e4d0>]}
[0m02:19:43.174142 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18960154, "process_in_blocks": "0", "process_kernel_time": 0.080068, "process_mem_max_rss": "90120", "process_out_blocks": "0", "process_user_time": 0.930793}
[0m02:19:43.175183 [debug] [MainThread]: Command `dbt clean` succeeded at 02:19:43.175049 after 0.19 seconds
[0m02:19:43.176197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f45a3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f45a3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f7d10c10>]}
[0m02:19:43.177249 [debug] [MainThread]: Flushing usage events
[0m02:19:44.249420 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:19:45.393126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec9d1af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec9d6b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec9d1ab10>]}


============================== 02:19:45.395761 | 50629c51-5b48-4916-bf16-b08f55f53855 ==============================
[0m02:19:45.395761 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:19:45.397063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:19:45.475692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50629c51-5b48-4916-bf16-b08f55f53855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec9bc6d50>]}
[0m02:19:45.485546 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:19:45.488201 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:19:45.489894 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14864384, "process_in_blocks": "0", "process_kernel_time": 0.059938, "process_mem_max_rss": "90020", "process_out_blocks": "0", "process_user_time": 1.018951}
[0m02:19:45.490991 [debug] [MainThread]: Command `dbt deps` succeeded at 02:19:45.490853 after 0.15 seconds
[0m02:19:45.491753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecd508c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eca10e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec9d19910>]}
[0m02:19:45.492620 [debug] [MainThread]: Flushing usage events
[0m02:19:46.645759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:19:47.798072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced3a57b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced3e02510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced3e023d0>]}


============================== 02:19:47.800876 | 36b4bddf-c76d-46a3-ba6c-257ff399de47 ==============================
[0m02:19:47.800876 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:19:47.802377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:19:48.399327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36b4bddf-c76d-46a3-ba6c-257ff399de47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea5d91d50>]}
[0m02:19:48.443383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36b4bddf-c76d-46a3-ba6c-257ff399de47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced5c7c850>]}
[0m02:19:48.444634 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m02:19:48.514047 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:19:48.516226 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:19:48.517453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '36b4bddf-c76d-46a3-ba6c-257ff399de47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea5b93790>]}
[0m02:19:49.503689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36b4bddf-c76d-46a3-ba6c-257ff399de47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea57e90d0>]}
[0m02:19:49.568227 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m02:19:49.574022 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m02:19:49.589989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36b4bddf-c76d-46a3-ba6c-257ff399de47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea5887290>]}
[0m02:19:49.591258 [info ] [MainThread]: Found 4 models, 4 sources, 487 macros
[0m02:19:49.592417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36b4bddf-c76d-46a3-ba6c-257ff399de47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea5a61790>]}
[0m02:19:49.594991 [info ] [MainThread]: 
[0m02:19:49.596181 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:19:49.597270 [info ] [MainThread]: 
[0m02:19:49.598509 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:19:49.603426 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m02:19:49.604465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:50.214126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now create_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer)
[0m02:19:50.215642 [debug] [ThreadPool]: Creating schema "database: "purwadika"
schema: "rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer"
"
[0m02:19:50.229867 [debug] [ThreadPool]: On create_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "connection_name": "create_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer"} */
create schema if not exists `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer`
  
[0m02:19:50.231396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:19:51.075076 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:eff2262a-9599-4bac-8e25-f6defc77ceb5&page=queryresults
[0m02:19:52.051860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer, now list_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer)
[0m02:19:52.052882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:19:52.647637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36b4bddf-c76d-46a3-ba6c-257ff399de47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcea5884410>]}
[0m02:19:52.649546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:19:52.654428 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m02:19:52.654897 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m02:19:52.655325 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m02:19:52.655779 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m02:19:52.656379 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_customer  [RUN]
[0m02:19:52.657696 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_driver  [RUN]
[0m02:19:52.659094 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_ride  [RUN]
[0m02:19:52.660466 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_vehicle  [RUN]
[0m02:19:52.661523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer, now model.hailing_project.stg_customer)
[0m02:19:52.662659 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m02:19:52.663775 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m02:19:52.665131 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m02:19:52.666395 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m02:19:52.667350 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m02:19:52.668200 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m02:19:52.669164 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m02:19:52.678200 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m02:19:52.681497 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m02:19:52.685727 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m02:19:52.689378 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m02:19:52.702546 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m02:19:52.709417 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m02:19:52.742979 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m02:19:52.743343 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m02:19:52.782538 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m02:19:52.785044 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m02:19:52.785581 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m02:19:52.788713 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m02:19:52.801166 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer`.`stg_customer`
      
    
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
),

cleaned AS (
    SELECT
        customer_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m02:19:52.802363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:52.803163 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer`.`stg_ride`
      
    
    

    OPTIONS()
    as (
      

SELECT *
FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
    );
  
[0m02:19:52.804698 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer`.`stg_driver`
      
    
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m02:19:52.805201 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:19:52.807701 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:19:52.809056 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer`.`stg_vehicle`
      
    
    

    OPTIONS()
    as (
      

SELECT *
FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
    );
  
[0m02:19:52.835926 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:19:53.069577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:efbadefb-97fe-4c22-a6c8-b73c0fb171d7&page=queryresults
[0m02:19:53.070866 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:efbadefb-97fe-4c22-a6c8-b73c0fb171d7&page=queryresults
[0m02:19:53.076360 [debug] [Thread-1 (]: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m02:19:53.079108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36b4bddf-c76d-46a3-ba6c-257ff399de47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7f3e5450>]}
[0m02:19:53.080368 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_customer  [[31mERROR[0m in 0.42s]
[0m02:19:53.081709 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m02:19:53.083138 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_customer' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql.
[0m02:19:53.160594 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:70c69ada-06e4-4a82-a967-4279d5e053f4&page=queryresults
[0m02:19:53.161707 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:70c69ada-06e4-4a82-a967-4279d5e053f4&page=queryresults
[0m02:19:53.165304 [debug] [Thread-2 (]: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m02:19:53.166187 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36b4bddf-c76d-46a3-ba6c-257ff399de47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7f140950>]}
[0m02:19:53.167406 [error] [Thread-2 (]: 2 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_driver  [[31mERROR[0m in 0.50s]
[0m02:19:53.168375 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m02:19:53.169604 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_driver' to be skipped because of status 'error'.  Reason: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql.
[0m02:19:53.189273 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:dbf52f61-28b6-4b38-9bd0-87e904709498&page=queryresults
[0m02:19:53.190659 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:dbf52f61-28b6-4b38-9bd0-87e904709498&page=queryresults
[0m02:19:53.194317 [debug] [Thread-4 (]: Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql
[0m02:19:53.195547 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36b4bddf-c76d-46a3-ba6c-257ff399de47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7f132d90>]}
[0m02:19:53.196796 [error] [Thread-4 (]: 4 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_vehicle  [[31mERROR[0m in 0.53s]
[0m02:19:53.198030 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m02:19:53.199262 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_vehicle' to be skipped because of status 'error'.  Reason: Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql.
[0m02:19:53.206344 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9d6d5eab-a475-46fa-9d54-3c7d7e00878d&page=queryresults
[0m02:19:53.207441 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9d6d5eab-a475-46fa-9d54-3c7d7e00878d&page=queryresults
[0m02:19:53.210872 [debug] [Thread-3 (]: Database Error in model stg_ride (models/staging/stg_ride.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql
[0m02:19:53.212108 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36b4bddf-c76d-46a3-ba6c-257ff399de47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce7f3f4390>]}
[0m02:19:53.213401 [error] [Thread-3 (]: 3 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_ride  [[31mERROR[0m in 0.55s]
[0m02:19:53.214467 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m02:19:53.215679 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_ride' to be skipped because of status 'error'.  Reason: Database Error in model stg_ride (models/staging/stg_ride.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql.
[0m02:19:53.217446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:19:53.221052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:19:53.221827 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m02:19:53.222608 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m02:19:53.223536 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m02:19:53.224323 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m02:19:53.225250 [info ] [MainThread]: 
[0m02:19:53.226377 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m02:19:53.228128 [debug] [MainThread]: Command end result
[0m02:19:53.264122 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m02:19:53.269292 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m02:19:53.278390 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m02:19:53.279099 [info ] [MainThread]: 
[0m02:19:53.280452 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m02:19:53.281929 [info ] [MainThread]: 
[0m02:19:53.283440 [error] [MainThread]:   Database Error in model stg_customer (models/staging/stg_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m02:19:53.284486 [info ] [MainThread]: 
[0m02:19:53.285700 [error] [MainThread]:   Database Error in model stg_driver (models/staging/stg_driver.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m02:19:53.286808 [info ] [MainThread]: 
[0m02:19:53.288665 [error] [MainThread]:   Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql
[0m02:19:53.290195 [info ] [MainThread]: 
[0m02:19:53.292798 [error] [MainThread]:   Database Error in model stg_ride (models/staging/stg_ride.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql
[0m02:19:53.296067 [info ] [MainThread]: 
[0m02:19:53.298499 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m02:19:53.301766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.559815, "process_in_blocks": "0", "process_kernel_time": 0.159599, "process_mem_max_rss": "227496", "process_out_blocks": "0", "process_user_time": 4.199452}
[0m02:19:53.304129 [debug] [MainThread]: Command `dbt run` failed at 02:19:53.303881 after 5.56 seconds
[0m02:19:53.309675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced3e028d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced5b8aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fced3a3f190>]}
[0m02:19:53.312580 [debug] [MainThread]: Flushing usage events
[0m02:19:54.432570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:22:59.298886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc582de2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc582de3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc582de2c90>]}


============================== 02:22:59.301439 | 598de295-1704-4dee-b3ae-d4343be14bee ==============================
[0m02:22:59.301439 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:22:59.304163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:22:59.897242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '598de295-1704-4dee-b3ae-d4343be14bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc559f64b50>]}
[0m02:22:59.941040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '598de295-1704-4dee-b3ae-d4343be14bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58505a210>]}
[0m02:22:59.942289 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m02:23:00.011330 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:23:00.078598 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m02:23:00.079893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '598de295-1704-4dee-b3ae-d4343be14bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc583be4390>]}
[0m02:23:01.075126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '598de295-1704-4dee-b3ae-d4343be14bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc558fa2d10>]}
[0m02:23:01.141482 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m02:23:01.148081 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m02:23:01.161756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '598de295-1704-4dee-b3ae-d4343be14bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc543122a50>]}
[0m02:23:01.162979 [info ] [MainThread]: Found 4 models, 4 sources, 487 macros
[0m02:23:01.164993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '598de295-1704-4dee-b3ae-d4343be14bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc558dea390>]}
[0m02:23:01.168040 [info ] [MainThread]: 
[0m02:23:01.169154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:23:01.170684 [info ] [MainThread]: 
[0m02:23:01.172194 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m02:23:01.176700 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m02:23:01.177769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:23:02.337608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer)
[0m02:23:02.338814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:23:02.888646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '598de295-1704-4dee-b3ae-d4343be14bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc558e3d850>]}
[0m02:23:02.893292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:23:02.898715 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m02:23:02.899162 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m02:23:02.899561 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m02:23:02.899911 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m02:23:02.900627 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_customer  [RUN]
[0m02:23:02.902948 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_driver  [RUN]
[0m02:23:02.905319 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_ride  [RUN]
[0m02:23:02.907001 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_vehicle  [RUN]
[0m02:23:02.908807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer, now model.hailing_project.stg_customer)
[0m02:23:02.910166 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m02:23:02.911458 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m02:23:02.912759 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m02:23:02.914024 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m02:23:02.914986 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m02:23:02.915994 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m02:23:02.916878 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m02:23:02.926278 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m02:23:02.929758 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m02:23:02.933442 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m02:23:02.937378 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m02:23:02.943149 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m02:23:02.944703 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m02:23:02.951044 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m02:23:02.951686 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m02:23:03.023351 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m02:23:03.026136 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m02:23:03.026779 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m02:23:03.029786 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m02:23:03.038455 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer`.`stg_vehicle`
      
    
    

    OPTIONS()
    as (
      

SELECT *
FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
    );
  
[0m02:23:03.039788 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer`.`stg_customer`
      
    
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
),

cleaned AS (
    SELECT
        customer_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m02:23:03.040237 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer`.`stg_driver`
      
    
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m02:23:03.041026 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:23:03.041683 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer`.`stg_ride`
      
    
    

    OPTIONS()
    as (
      

SELECT *
FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
    );
  
[0m02:23:03.042414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:23:03.043246 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:23:03.044854 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:23:03.359713 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:79e5f65c-7115-4456-8243-3c91fd64924f&page=queryresults
[0m02:23:03.361730 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:79e5f65c-7115-4456-8243-3c91fd64924f&page=queryresults
[0m02:23:03.362561 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:86310e65-be7e-4ea7-b55f-428455560bc9&page=queryresults
[0m02:23:03.365437 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:86310e65-be7e-4ea7-b55f-428455560bc9&page=queryresults
[0m02:23:03.369647 [debug] [Thread-4 (]: Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql
[0m02:23:03.370817 [debug] [Thread-2 (]: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m02:23:03.372341 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '598de295-1704-4dee-b3ae-d4343be14bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc507709590>]}
[0m02:23:03.373028 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '598de295-1704-4dee-b3ae-d4343be14bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5431e9b10>]}
[0m02:23:03.374161 [error] [Thread-4 (]: 4 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_vehicle  [[31mERROR[0m in 0.46s]
[0m02:23:03.375896 [error] [Thread-2 (]: 2 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_driver  [[31mERROR[0m in 0.46s]
[0m02:23:03.377233 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m02:23:03.378654 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m02:23:03.380169 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_vehicle' to be skipped because of status 'error'.  Reason: Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql.
[0m02:23:03.381903 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_driver' to be skipped because of status 'error'.  Reason: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql.
[0m02:23:03.413141 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a793c2ef-2f5d-41b2-a0a1-9a8012d35841&page=queryresults
[0m02:23:03.414247 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a793c2ef-2f5d-41b2-a0a1-9a8012d35841&page=queryresults
[0m02:23:03.417566 [debug] [Thread-1 (]: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m02:23:03.418427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '598de295-1704-4dee-b3ae-d4343be14bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc507728cd0>]}
[0m02:23:03.419705 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_customer  [[31mERROR[0m in 0.51s]
[0m02:23:03.420942 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m02:23:03.422227 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_customer' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql.
[0m02:23:03.431591 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:4f7e0877-0170-42bf-8f06-39971f85f0b7&page=queryresults
[0m02:23:03.433212 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:4f7e0877-0170-42bf-8f06-39971f85f0b7&page=queryresults
[0m02:23:03.436933 [debug] [Thread-3 (]: Database Error in model stg_ride (models/staging/stg_ride.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql
[0m02:23:03.438133 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '598de295-1704-4dee-b3ae-d4343be14bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5432431d0>]}
[0m02:23:03.439279 [error] [Thread-3 (]: 3 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer.stg_ride  [[31mERROR[0m in 0.53s]
[0m02:23:03.440640 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m02:23:03.442280 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_ride' to be skipped because of status 'error'.  Reason: Database Error in model stg_ride (models/staging/stg_ride.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql.
[0m02:23:03.444426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:23:03.447601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:23:03.448553 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m02:23:03.449372 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m02:23:03.450095 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m02:23:03.450805 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m02:23:03.451757 [info ] [MainThread]: 
[0m02:23:03.452678 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m02:23:03.454381 [debug] [MainThread]: Command end result
[0m02:23:03.485186 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m02:23:03.490386 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m02:23:03.497818 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m02:23:03.498665 [info ] [MainThread]: 
[0m02:23:03.499917 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m02:23:03.500952 [info ] [MainThread]: 
[0m02:23:03.502062 [error] [MainThread]:   Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql
[0m02:23:03.503073 [info ] [MainThread]: 
[0m02:23:03.504059 [error] [MainThread]:   Database Error in model stg_driver (models/staging/stg_driver.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m02:23:03.505185 [info ] [MainThread]: 
[0m02:23:03.506282 [error] [MainThread]:   Database Error in model stg_customer (models/staging/stg_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m02:23:03.507134 [info ] [MainThread]: 
[0m02:23:03.508120 [error] [MainThread]:   Database Error in model stg_ride (models/staging/stg_ride.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_staging_layer was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql
[0m02:23:03.509039 [info ] [MainThread]: 
[0m02:23:03.510102 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m02:23:03.511788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.2606525, "process_in_blocks": "0", "process_kernel_time": 0.212551, "process_mem_max_rss": "224192", "process_out_blocks": "0", "process_user_time": 4.078972}
[0m02:23:03.512753 [debug] [MainThread]: Command `dbt run` failed at 02:23:03.512647 after 4.26 seconds
[0m02:23:03.513724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc582e5d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc582e5f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58675d150>]}
[0m02:23:03.514650 [debug] [MainThread]: Flushing usage events
[0m02:23:05.016646 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:27:10.061335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7bafa2b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7bb4503d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7baff71d0>]}


============================== 02:27:10.063905 | 31c668d0-44a8-423d-9cba-07485a1d97cc ==============================
[0m02:27:10.063905 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:27:10.065631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:27:10.142962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31c668d0-44a8-423d-9cba-07485a1d97cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7bae36950>]}
[0m02:27:10.196558 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18368678, "process_in_blocks": "0", "process_kernel_time": 0.081932, "process_mem_max_rss": "90140", "process_out_blocks": "0", "process_user_time": 0.92174}
[0m02:27:10.197709 [debug] [MainThread]: Command `dbt clean` succeeded at 02:27:10.197592 after 0.19 seconds
[0m02:27:10.198861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7bb39a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7be8f1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7bafa1850>]}
[0m02:27:10.199813 [debug] [MainThread]: Flushing usage events
[0m02:27:11.381765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:27:12.492552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fb382950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fb3c0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fb77de10>]}


============================== 02:27:12.495880 | 105f7905-72f4-4f26-b25a-0023adc54469 ==============================
[0m02:27:12.495880 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:27:12.497159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:27:12.581002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '105f7905-72f4-4f26-b25a-0023adc54469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fb3d5950>]}
[0m02:27:12.591820 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:27:12.594827 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:27:12.596546 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15206721, "process_in_blocks": "0", "process_kernel_time": 0.079586, "process_mem_max_rss": "90212", "process_out_blocks": "0", "process_user_time": 0.974936}
[0m02:27:12.597503 [debug] [MainThread]: Command `dbt deps` succeeded at 02:27:12.597373 after 0.15 seconds
[0m02:27:12.598341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fb77e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fec6ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72fecfd5d0>]}
[0m02:27:12.599115 [debug] [MainThread]: Flushing usage events
[0m02:27:13.667226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:27:18.126541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9375bbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9379b2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9379b24d0>]}


============================== 02:27:18.129205 | ed0e3112-f793-4b76-89d4-df3e53df2e2c ==============================
[0m02:27:18.129205 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:27:18.130468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:27:18.714561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed0e3112-f793-4b76-89d4-df3e53df2e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9097b8450>]}
[0m02:27:18.757460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed0e3112-f793-4b76-89d4-df3e53df2e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff939868890>]}
[0m02:27:18.758844 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m02:27:18.827246 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:27:18.829601 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:27:18.830408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed0e3112-f793-4b76-89d4-df3e53df2e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff937615d10>]}
[0m02:27:19.666752 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_customer (models/staging/stg_customer.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m02:27:19.668956 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5943345, "process_in_blocks": "16", "process_kernel_time": 0.234997, "process_mem_max_rss": "211636", "process_out_blocks": "0", "process_user_time": 3.412571}
[0m02:27:19.670237 [debug] [MainThread]: Command `dbt run` failed at 02:27:19.670097 after 1.60 seconds
[0m02:27:19.671146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9375ea510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff937a70410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff90967fe50>]}
[0m02:27:19.672119 [debug] [MainThread]: Flushing usage events
[0m02:27:20.698749 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:29:19.756932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb876e4fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb876e02a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb876e022d0>]}


============================== 02:29:19.759598 | cfa47e46-00f7-47de-9070-f6658cefd0e9 ==============================
[0m02:29:19.759598 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:29:19.763323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:29:19.842269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfa47e46-00f7-47de-9070-f6658cefd0e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb876cc7150>]}
[0m02:29:19.857803 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.14823915, "process_in_blocks": "0", "process_kernel_time": 0.118135, "process_mem_max_rss": "90124", "process_out_blocks": "0", "process_user_time": 0.905702}
[0m02:29:19.858795 [debug] [MainThread]: Command `dbt clean` succeeded at 02:29:19.858683 after 0.15 seconds
[0m02:29:19.859609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb876e4f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb876e4f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb876f11b10>]}
[0m02:29:19.860396 [debug] [MainThread]: Flushing usage events
[0m02:29:21.008618 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:29:36.098313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dfb763a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dfb7a7090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dfb762b10>]}


============================== 02:29:36.100834 | ae7e7a25-d2f8-4c6c-97f2-7663699b82f7 ==============================
[0m02:29:36.100834 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:29:36.102185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m02:29:36.182096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae7e7a25-d2f8-4c6c-97f2-7663699b82f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dfb7dbdd0>]}
[0m02:29:36.192091 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:29:36.195892 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:29:36.197299 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1474884, "process_in_blocks": "0", "process_kernel_time": 0.089347, "process_mem_max_rss": "89884", "process_out_blocks": "0", "process_user_time": 0.93318}
[0m02:29:36.198655 [debug] [MainThread]: Command `dbt deps` succeeded at 02:29:36.198507 after 0.15 seconds
[0m02:29:36.199593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dfef5cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dff0e1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dff0e1110>]}
[0m02:29:36.200359 [debug] [MainThread]: Flushing usage events
[0m02:29:37.248158 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:29:42.747893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17872e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1793e7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff178afe550>]}


============================== 02:29:42.750836 | f2242523-1c80-44d8-8022-7848c9aa47cc ==============================
[0m02:29:42.750836 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:29:42.752017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:29:43.366137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2242523-1c80-44d8-8022-7848c9aa47cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14a90e2d0>]}
[0m02:29:43.412740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2242523-1c80-44d8-8022-7848c9aa47cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff14a950f10>]}
[0m02:29:43.413928 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m02:29:43.485356 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:29:43.487673 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:29:43.488700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f2242523-1c80-44d8-8022-7848c9aa47cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17858c590>]}
[0m02:29:44.327713 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_customer (models/staging/stg_customer.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m02:29:44.329316 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.6324943, "process_in_blocks": "0", "process_kernel_time": 0.18059, "process_mem_max_rss": "212028", "process_out_blocks": "0", "process_user_time": 3.551614}
[0m02:29:44.330421 [debug] [MainThread]: Command `dbt compile` failed at 02:29:44.330251 after 1.63 seconds
[0m02:29:44.331210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17857be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17857bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17c07d0d0>]}
[0m02:29:44.332149 [debug] [MainThread]: Flushing usage events
[0m02:29:45.589524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:29:53.502418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f183ca52fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f183ca85a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f183ca86f50>]}


============================== 02:29:53.505798 | 41cb02dc-0cc4-4c1b-965c-9dc620114dec ==============================
[0m02:29:53.505798 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:29:53.507274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:29:54.116437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41cb02dc-0cc4-4c1b-965c-9dc620114dec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f183ca53490>]}
[0m02:29:54.168556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41cb02dc-0cc4-4c1b-965c-9dc620114dec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f183ed06250>]}
[0m02:29:54.169894 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m02:29:54.238174 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:29:54.240432 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:29:54.241225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '41cb02dc-0cc4-4c1b-965c-9dc620114dec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f180ebe17d0>]}
[0m02:29:55.066343 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_customer (models/staging/stg_customer.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m02:29:55.068222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.617304, "process_in_blocks": "0", "process_kernel_time": 0.131437, "process_mem_max_rss": "211732", "process_out_blocks": "0", "process_user_time": 3.548801}
[0m02:29:55.069459 [debug] [MainThread]: Command `dbt run` failed at 02:29:55.069352 after 1.62 seconds
[0m02:29:55.070305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f183ca98910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f180eaa7810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1840409210>]}
[0m02:29:55.071221 [debug] [MainThread]: Flushing usage events
[0m02:29:56.099082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:30:20.664628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46baa52b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b9343350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b8a49f10>]}


============================== 02:30:20.667132 | 4630e5b5-e768-46ab-8517-fec3768dbd26 ==============================
[0m02:30:20.667132 [info ] [MainThread]: Running with dbt=1.9.0
[0m02:30:20.668783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:30:21.213151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4630e5b5-e768-46ab-8517-fec3768dbd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f468a7f5fd0>]}
[0m02:30:21.262779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4630e5b5-e768-46ab-8517-fec3768dbd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46ba8c6250>]}
[0m02:30:21.263928 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m02:30:21.327974 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m02:30:21.330285 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:30:21.332570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4630e5b5-e768-46ab-8517-fec3768dbd26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f468a997c50>]}
[0m02:30:22.115540 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_customer (models/staging/stg_customer.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m02:30:22.117385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5054442, "process_in_blocks": "0", "process_kernel_time": 0.180737, "process_mem_max_rss": "213952", "process_out_blocks": "0", "process_user_time": 3.383815}
[0m02:30:22.118554 [debug] [MainThread]: Command `dbt run` failed at 02:30:22.118408 after 1.51 seconds
[0m02:30:22.119529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b86cb810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b86cb750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f468a6a8d90>]}
[0m02:30:22.120437 [debug] [MainThread]: Flushing usage events
[0m02:30:23.406765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:48:46.577975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e03cbec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e04afbc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e040be110>]}


============================== 03:48:46.581100 | 4b6e4011-c2d3-4c10-ba46-fe102571ed89 ==============================
[0m03:48:46.581100 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:48:46.583063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:48:46.673982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b6e4011-c2d3-4c10-ba46-fe102571ed89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e03d16210>]}
[0m03:48:46.691460 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.17322543, "process_in_blocks": "0", "process_kernel_time": 0.071361, "process_mem_max_rss": "90076", "process_out_blocks": "0", "process_user_time": 0.937895}
[0m03:48:46.692203 [debug] [MainThread]: Command `dbt clean` succeeded at 03:48:46.692116 after 0.17 seconds
[0m03:48:46.692904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e03d15010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e03d14210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e074b8b90>]}
[0m03:48:46.693683 [debug] [MainThread]: Flushing usage events
[0m03:48:47.999145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:48:49.140859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b8f516cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b8f4c3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b8f4c2650>]}


============================== 03:48:49.143352 | 1f903d85-65ef-48f7-8c9a-aed9097531ac ==============================
[0m03:48:49.143352 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:48:49.144652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:48:49.228319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f903d85-65ef-48f7-8c9a-aed9097531ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b8f402090>]}
[0m03:48:49.239323 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:48:49.241814 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:48:49.243604 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1564101, "process_in_blocks": "0", "process_kernel_time": 0.120278, "process_mem_max_rss": "90156", "process_out_blocks": "0", "process_user_time": 0.962226}
[0m03:48:49.244668 [debug] [MainThread]: Command `dbt deps` succeeded at 03:48:49.244540 after 0.16 seconds
[0m03:48:49.245366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b8f516cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b8f8be8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b92cb8c10>]}
[0m03:48:49.246184 [debug] [MainThread]: Flushing usage events
[0m03:48:50.258690 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:48:52.041857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb74036e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb74036a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb74087950>]}


============================== 03:48:52.044630 | d45ae16e-a5ef-414b-92c4-b8dabf098e93 ==============================
[0m03:48:52.044630 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:48:52.045738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:48:52.628930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd45ae16e-a5ef-414b-92c4-b8dabf098e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb463df5d0>]}
[0m03:48:52.674213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd45ae16e-a5ef-414b-92c4-b8dabf098e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb46297490>]}
[0m03:48:52.675430 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m03:48:52.750946 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m03:48:52.753801 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:48:52.754901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd45ae16e-a5ef-414b-92c4-b8dabf098e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4cc71590>]}
[0m03:48:53.740104 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project.example
- models.dbt_project
[0m03:48:53.751432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd45ae16e-a5ef-414b-92c4-b8dabf098e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb460d4f10>]}
[0m03:48:53.818544 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m03:48:53.824729 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m03:48:53.841886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd45ae16e-a5ef-414b-92c4-b8dabf098e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb44626610>]}
[0m03:48:53.843072 [info ] [MainThread]: Found 4 models, 4 sources, 487 macros
[0m03:48:53.844252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd45ae16e-a5ef-414b-92c4-b8dabf098e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb46382550>]}
[0m03:48:53.847146 [info ] [MainThread]: 
[0m03:48:53.848265 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:48:53.849418 [info ] [MainThread]: 
[0m03:48:53.851660 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:48:53.856931 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m03:48:53.858131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:48:54.461050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m03:48:54.462308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:48:54.658101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd45ae16e-a5ef-414b-92c4-b8dabf098e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb45f3ad10>]}
[0m03:48:54.659578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:48:54.664912 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m03:48:54.665303 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m03:48:54.665665 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m03:48:54.666059 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m03:48:54.666709 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.stg_customer ....... [RUN]
[0m03:48:54.667970 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.stg_driver ......... [RUN]
[0m03:48:54.669068 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.stg_ride ........... [RUN]
[0m03:48:54.670214 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.stg_vehicle ........ [RUN]
[0m03:48:54.671678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.stg_customer)
[0m03:48:54.676645 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m03:48:54.674594 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m03:48:54.675816 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m03:48:54.673185 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m03:48:54.685826 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m03:48:54.686787 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m03:48:54.688038 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m03:48:54.689235 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m03:48:54.694104 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m03:48:54.697849 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m03:48:54.702073 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m03:48:54.714652 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m03:48:54.721008 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m03:48:54.742940 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m03:48:54.769683 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m03:48:54.832074 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m03:48:54.832728 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m03:48:54.833474 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m03:48:54.836786 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m03:48:54.847600 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
),
SELECT *
FROM source
    );
  
[0m03:48:54.848840 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:48:54.849350 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`stg_customer`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
),

cleaned AS (
    SELECT
        customer_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m03:48:54.850869 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`stg_ride`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
),

SELECT *
FROM source
    );
  
[0m03:48:54.851760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:48:54.852316 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`stg_driver`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m03:48:54.854713 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:48:54.880104 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:48:55.333011 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:867609ef-42fc-4e69-bce0-062e7c18a7a4&page=queryresults
[0m03:48:55.334001 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:867609ef-42fc-4e69-bce0-062e7c18a7a4&page=queryresults
[0m03:48:55.340453 [debug] [Thread-4 (]: Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [19:1]
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql
[0m03:48:55.342403 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd45ae16e-a5ef-414b-92c4-b8dabf098e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb444266d0>]}
[0m03:48:55.343664 [error] [Thread-4 (]: 4 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source.stg_vehicle  [[31mERROR[0m in 0.67s]
[0m03:48:55.345422 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m03:48:55.346745 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_vehicle' to be skipped because of status 'error'.  Reason: Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [19:1]
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql.
[0m03:48:55.383661 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:ca4ee090-40bb-4a20-bdb7-770e5b76ea45&page=queryresults
[0m03:48:55.384765 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:ca4ee090-40bb-4a20-bdb7-770e5b76ea45&page=queryresults
[0m03:48:55.388337 [debug] [Thread-3 (]: Database Error in model stg_ride (models/staging/stg_ride.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [20:1]
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql
[0m03:48:55.389174 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd45ae16e-a5ef-414b-92c4-b8dabf098e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb446b5f50>]}
[0m03:48:55.390177 [error] [Thread-3 (]: 3 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source.stg_ride .. [[31mERROR[0m in 0.71s]
[0m03:48:55.391380 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m03:48:55.392421 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_ride' to be skipped because of status 'error'.  Reason: Database Error in model stg_ride (models/staging/stg_ride.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [20:1]
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql.
[0m03:48:56.472613 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:26f5a9d0-22b5-4fc2-b25e-72b5439fe2c8&page=queryresults
[0m03:48:56.710713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c86efc61-8407-4610-87cc-2fd6b7c7c6f7&page=queryresults
[0m03:48:56.802393 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c86efc61-8407-4610-87cc-2fd6b7c7c6f7&page=queryresults
[0m03:48:56.806713 [debug] [Thread-1 (]: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Unrecognized name: customer_id; Did you mean cust_id? at [22:9]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m03:48:56.807969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd45ae16e-a5ef-414b-92c4-b8dabf098e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb44417d50>]}
[0m03:48:56.809454 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source.stg_customer  [[31mERROR[0m in 2.14s]
[0m03:48:56.811066 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m03:48:56.812800 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_customer' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Unrecognized name: customer_id; Did you mean cust_id? at [22:9]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql.
[0m03:48:58.223982 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd45ae16e-a5ef-414b-92c4-b8dabf098e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4441b490>]}
[0m03:48:58.225257 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_driver .... [[32mCREATE TABLE (70.0 rows, 4.8 KiB processed)[0m in 3.55s]
[0m03:48:58.226780 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m03:48:58.229292 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:48:58.232549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:48:58.233494 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m03:48:58.234578 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m03:48:58.235380 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m03:48:58.237180 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m03:48:58.238281 [info ] [MainThread]: 
[0m03:48:58.239667 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m03:48:58.241893 [debug] [MainThread]: Command end result
[0m03:48:58.276224 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m03:48:58.280265 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m03:48:58.288287 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m03:48:58.289101 [info ] [MainThread]: 
[0m03:48:58.290190 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m03:48:58.291264 [info ] [MainThread]: 
[0m03:48:58.292355 [error] [MainThread]:   Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [19:1]
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql
[0m03:48:58.293521 [info ] [MainThread]: 
[0m03:48:58.294788 [error] [MainThread]:   Database Error in model stg_ride (models/staging/stg_ride.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [20:1]
  compiled code at target/run/hailing_project/models/staging/stg_ride.sql
[0m03:48:58.295737 [info ] [MainThread]: 
[0m03:48:58.297045 [error] [MainThread]:   Database Error in model stg_customer (models/staging/stg_customer.sql)
  Unrecognized name: customer_id; Did you mean cust_id? at [22:9]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m03:48:58.297984 [info ] [MainThread]: 
[0m03:48:58.299187 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m03:48:58.300716 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.308942, "process_in_blocks": "0", "process_kernel_time": 0.217576, "process_mem_max_rss": "227536", "process_out_blocks": "0", "process_user_time": 4.11417}
[0m03:48:58.302115 [debug] [MainThread]: Command `dbt run` failed at 03:48:58.301996 after 6.31 seconds
[0m03:48:58.302959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb740b14d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb740b3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb779ed210>]}
[0m03:48:58.303931 [debug] [MainThread]: Flushing usage events
[0m03:48:59.325197 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:50:41.729427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f567077a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f567077a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f567077a610>]}


============================== 03:50:41.731891 | 529f87d7-6afb-4e1e-8bac-84c3ff408093 ==============================
[0m03:50:41.731891 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:50:41.734506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:50:41.815197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '529f87d7-6afb-4e1e-8bac-84c3ff408093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5670c90a50>]}
[0m03:50:41.874857 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19473526, "process_in_blocks": "0", "process_kernel_time": 0.06868, "process_mem_max_rss": "90052", "process_out_blocks": "0", "process_user_time": 0.93209}
[0m03:50:41.875697 [debug] [MainThread]: Command `dbt clean` succeeded at 03:50:41.875599 after 0.20 seconds
[0m03:50:41.876484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56707d1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56707cfa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56706c2a10>]}
[0m03:50:41.877255 [debug] [MainThread]: Flushing usage events
[0m03:50:42.997065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:50:44.109329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfb372e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfb76a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfb853750>]}


============================== 03:50:44.112663 | 850e8d11-8c97-4829-ae46-7eb0c2df9421 ==============================
[0m03:50:44.112663 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:50:44.114330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:50:44.197698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '850e8d11-8c97-4829-ae46-7eb0c2df9421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfb209650>]}
[0m03:50:44.211517 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.15543059, "process_in_blocks": "0", "process_kernel_time": 0.068863, "process_mem_max_rss": "89856", "process_out_blocks": "0", "process_user_time": 0.98377}
[0m03:50:44.212608 [debug] [MainThread]: Command `dbt clean` succeeded at 03:50:44.212482 after 0.16 seconds
[0m03:50:44.213587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfb3ce2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfb3cc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcfeb3cc50>]}
[0m03:50:44.214622 [debug] [MainThread]: Flushing usage events
[0m03:50:45.280840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:50:46.480062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377e7db010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377ebd6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377e80c490>]}


============================== 03:50:46.482657 | de1a6b8e-6207-4037-a5a6-884431cd32f9 ==============================
[0m03:50:46.482657 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:50:46.483781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m03:50:46.570851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de1a6b8e-6207-4037-a5a6-884431cd32f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377e82e290>]}
[0m03:50:46.582813 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:50:46.585585 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:50:46.587296 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15657125, "process_in_blocks": "0", "process_kernel_time": 0.100615, "process_mem_max_rss": "90328", "process_out_blocks": "0", "process_user_time": 1.026273}
[0m03:50:46.589094 [debug] [MainThread]: Command `dbt deps` succeeded at 03:50:46.588626 after 0.16 seconds
[0m03:50:46.590465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377e84d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377e84f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3781fd0b90>]}
[0m03:50:46.591425 [debug] [MainThread]: Flushing usage events
[0m03:50:47.650574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:51:37.432385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7decb4ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ded033910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7decb97dd0>]}


============================== 03:51:37.434767 | b7190cd3-1d5e-4235-9367-57ccdda45d7e ==============================
[0m03:51:37.434767 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:51:37.435957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m03:51:38.032673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7190cd3-1d5e-4235-9367-57ccdda45d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dbee72f10>]}
[0m03:51:38.104604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7190cd3-1d5e-4235-9367-57ccdda45d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7deedf8850>]}
[0m03:51:38.105818 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m03:51:38.179653 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m03:51:38.181631 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:51:38.183040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b7190cd3-1d5e-4235-9367-57ccdda45d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc5d7ca90>]}
[0m03:51:39.129366 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project.example
- models.dbt_project
[0m03:51:39.140710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7190cd3-1d5e-4235-9367-57ccdda45d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dbd124990>]}
[0m03:51:39.203809 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m03:51:39.209147 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m03:51:39.223960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7190cd3-1d5e-4235-9367-57ccdda45d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dbd0c3910>]}
[0m03:51:39.225159 [info ] [MainThread]: Found 4 models, 4 sources, 487 macros
[0m03:51:39.226267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7190cd3-1d5e-4235-9367-57ccdda45d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dbea7c550>]}
[0m03:51:39.229243 [info ] [MainThread]: 
[0m03:51:39.230500 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:51:39.231429 [info ] [MainThread]: 
[0m03:51:39.232873 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:51:39.237955 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m03:51:39.239048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:51:39.782113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m03:51:39.783168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:40.017044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7190cd3-1d5e-4235-9367-57ccdda45d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dbeae8e90>]}
[0m03:51:40.018928 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:51:40.024765 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m03:51:40.025121 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m03:51:40.025509 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m03:51:40.025865 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m03:51:40.026365 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.stg_customer ....... [RUN]
[0m03:51:40.027623 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.stg_driver ......... [RUN]
[0m03:51:40.028738 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.stg_ride ........... [RUN]
[0m03:51:40.029993 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.stg_vehicle ........ [RUN]
[0m03:51:40.031309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.stg_customer)
[0m03:51:40.032596 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m03:51:40.034403 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m03:51:40.035875 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m03:51:40.037337 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m03:51:40.038363 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m03:51:40.039320 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m03:51:40.040346 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m03:51:40.047996 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m03:51:40.051314 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m03:51:40.055683 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m03:51:40.060410 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m03:51:40.070428 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m03:51:40.077158 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m03:51:40.103838 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m03:51:40.115046 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m03:51:40.152124 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m03:51:40.153432 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m03:51:40.156050 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:51:40.160344 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m03:51:40.196248 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
),
SELECT *
FROM source
    );
  
[0m03:51:40.197601 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:51:40.198241 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`stg_customer`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
)

WITH cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m03:51:40.200194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:40.200599 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`stg_ride`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
)

SELECT *
FROM source
    );
  
[0m03:51:40.225450 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:51:40.420935 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m03:51:40.427200 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
)

WITH cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m03:51:40.690507 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:1f357af3-36f2-458e-8d19-0edfbf4cc3da&page=queryresults
[0m03:51:40.691849 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:1f357af3-36f2-458e-8d19-0edfbf4cc3da&page=queryresults
[0m03:51:40.696871 [debug] [Thread-4 (]: Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [19:1]
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql
[0m03:51:40.699082 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7190cd3-1d5e-4235-9367-57ccdda45d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dbc750090>]}
[0m03:51:40.700058 [error] [Thread-4 (]: 4 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source.stg_vehicle  [[31mERROR[0m in 0.66s]
[0m03:51:40.701238 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m03:51:40.702358 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_vehicle' to be skipped because of status 'error'.  Reason: Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [19:1]
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql.
[0m03:51:40.716636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:519f6a0e-86f0-41b2-8158-7c9575306572&page=queryresults
[0m03:51:40.718019 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:519f6a0e-86f0-41b2-8158-7c9575306572&page=queryresults
[0m03:51:40.721398 [debug] [Thread-1 (]: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [20:6]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m03:51:40.722416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7190cd3-1d5e-4235-9367-57ccdda45d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dbc750ad0>]}
[0m03:51:40.723425 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source.stg_customer  [[31mERROR[0m in 0.69s]
[0m03:51:40.724598 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m03:51:40.725682 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_customer' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [20:6]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql.
[0m03:51:40.772889 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:cc8dac86-73ac-48c6-85af-c1e36756a363&page=queryresults
[0m03:51:40.774108 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:cc8dac86-73ac-48c6-85af-c1e36756a363&page=queryresults
[0m03:51:40.777571 [debug] [Thread-2 (]: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [21:6]
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m03:51:40.778659 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7190cd3-1d5e-4235-9367-57ccdda45d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dbd1c6a90>]}
[0m03:51:40.779741 [error] [Thread-2 (]: 2 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source.stg_driver  [[31mERROR[0m in 0.75s]
[0m03:51:40.780860 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m03:51:40.782030 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_driver' to be skipped because of status 'error'.  Reason: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [21:6]
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql.
[0m03:51:40.906121 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:31ba37c3-4d51-4737-87eb-4a5a8bede1c8&page=queryresults
[0m03:51:42.967413 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7190cd3-1d5e-4235-9367-57ccdda45d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dbd0e6090>]}
[0m03:51:42.968893 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_ride ...... [[32mCREATE TABLE (70.0 rows, 6.2 KiB processed)[0m in 2.93s]
[0m03:51:42.970393 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m03:51:42.973070 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:51:42.976480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:51:42.977315 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m03:51:42.978132 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m03:51:42.978812 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m03:51:42.979523 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m03:51:42.980342 [info ] [MainThread]: 
[0m03:51:42.981362 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 3.75 seconds (3.75s).
[0m03:51:42.983605 [debug] [MainThread]: Command end result
[0m03:51:43.019384 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m03:51:43.025356 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m03:51:43.035800 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m03:51:43.036967 [info ] [MainThread]: 
[0m03:51:43.038677 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m03:51:43.039925 [info ] [MainThread]: 
[0m03:51:43.041192 [error] [MainThread]:   Database Error in model stg_vehicle (models/staging/stg_vehicle.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [19:1]
  compiled code at target/run/hailing_project/models/staging/stg_vehicle.sql
[0m03:51:43.042449 [info ] [MainThread]: 
[0m03:51:43.044025 [error] [MainThread]:   Database Error in model stg_customer (models/staging/stg_customer.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [20:6]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m03:51:43.045395 [info ] [MainThread]: 
[0m03:51:43.046603 [error] [MainThread]:   Database Error in model stg_driver (models/staging/stg_driver.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [21:6]
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m03:51:43.047640 [info ] [MainThread]: 
[0m03:51:43.048597 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m03:51:43.050753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.6623764, "process_in_blocks": "0", "process_kernel_time": 0.279745, "process_mem_max_rss": "226472", "process_out_blocks": "0", "process_user_time": 4.006348}
[0m03:51:43.052336 [debug] [MainThread]: Command `dbt run` failed at 03:51:43.052165 after 5.66 seconds
[0m03:51:43.053376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7decf42990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df04fd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7decba36d0>]}
[0m03:51:43.054444 [debug] [MainThread]: Flushing usage events
[0m03:51:44.297123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:52:34.409055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d14a4ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d14e4a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d14a4ebd0>]}


============================== 03:52:34.411673 | de1a501b-b97a-415c-8de0-788dc80242eb ==============================
[0m03:52:34.411673 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:52:34.412727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:52:34.975291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de1a501b-b97a-415c-8de0-788dc80242eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d14acbd50>]}
[0m03:52:35.019882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de1a501b-b97a-415c-8de0-788dc80242eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d16cc6290>]}
[0m03:52:35.021404 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m03:52:35.084190 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m03:52:35.209905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:52:35.211040 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/stg_vehicle.sql
[0m03:52:35.211817 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/stg_customer.sql
[0m03:52:35.449778 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project
- models.dbt_project.example
[0m03:52:35.463221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de1a501b-b97a-415c-8de0-788dc80242eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce6eb2e90>]}
[0m03:52:35.534400 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m03:52:35.539796 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m03:52:35.554360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de1a501b-b97a-415c-8de0-788dc80242eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce4ef4050>]}
[0m03:52:35.555556 [info ] [MainThread]: Found 4 models, 4 sources, 487 macros
[0m03:52:35.556727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de1a501b-b97a-415c-8de0-788dc80242eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce6c35390>]}
[0m03:52:35.560001 [info ] [MainThread]: 
[0m03:52:35.561074 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:52:35.561965 [info ] [MainThread]: 
[0m03:52:35.563230 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:52:35.568495 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m03:52:35.569612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:52:36.059137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m03:52:36.059990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:52:36.292422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de1a501b-b97a-415c-8de0-788dc80242eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d14a668d0>]}
[0m03:52:36.293387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:52:36.298922 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m03:52:36.299280 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m03:52:36.299817 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m03:52:36.300199 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m03:52:36.301256 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.stg_customer ....... [RUN]
[0m03:52:36.302525 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.stg_driver ......... [RUN]
[0m03:52:36.303743 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.stg_ride ........... [RUN]
[0m03:52:36.304819 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.stg_vehicle ........ [RUN]
[0m03:52:36.305904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.stg_customer)
[0m03:52:36.307093 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m03:52:36.308099 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m03:52:36.308953 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m03:52:36.309717 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m03:52:36.310523 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m03:52:36.311449 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m03:52:36.312287 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m03:52:36.320882 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m03:52:36.324058 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m03:52:36.328077 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m03:52:36.332522 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m03:52:36.337689 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m03:52:36.338229 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m03:52:36.349609 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m03:52:36.349973 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m03:52:36.404600 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:52:36.428087 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m03:52:36.429149 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m03:52:36.432434 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:52:36.463644 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`stg_customer`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
)

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m03:52:36.487628 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
)

SELECT *
FROM source
    );
  
[0m03:52:36.488093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:52:36.490382 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:52:36.727963 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m03:52:36.731604 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m03:52:36.736612 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
)

WITH cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m03:52:36.737835 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_ride` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
)

SELECT *
FROM source
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ride_id = DBT_INTERNAL_DEST.ride_id
            )

    
    when matched then update set
        `ride_id` = DBT_INTERNAL_SOURCE.`ride_id`,`cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`distance_km` = DBT_INTERNAL_SOURCE.`distance_km`,`fare` = DBT_INTERNAL_SOURCE.`fare`,`ride_status` = DBT_INTERNAL_SOURCE.`ride_status`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)
    values
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)


    
[0m03:52:36.991392 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:3b14d6d9-cf1f-4053-89f3-bd4f4a87e22c&page=queryresults
[0m03:52:36.993419 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:3b14d6d9-cf1f-4053-89f3-bd4f4a87e22c&page=queryresults
[0m03:52:36.999488 [debug] [Thread-1 (]: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Syntax error: Unexpected identifier "cleaned" at [20:1]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m03:52:37.002115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1a501b-b97a-415c-8de0-788dc80242eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce4f6bf50>]}
[0m03:52:37.003624 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source.stg_customer  [[31mERROR[0m in 0.70s]
[0m03:52:37.005887 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m03:52:37.008203 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_customer' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Syntax error: Unexpected identifier "cleaned" at [20:1]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql.
[0m03:52:37.083185 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:0c115b79-c3a8-42f3-b535-5e101cf409a9&page=queryresults
[0m03:52:37.085011 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:0c115b79-c3a8-42f3-b535-5e101cf409a9&page=queryresults
[0m03:52:37.091496 [debug] [Thread-2 (]: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [21:6]
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m03:52:37.092561 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1a501b-b97a-415c-8de0-788dc80242eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce4f680d0>]}
[0m03:52:37.093857 [error] [Thread-2 (]: 2 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source.stg_driver  [[31mERROR[0m in 0.79s]
[0m03:52:37.094960 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m03:52:37.096111 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_driver' to be skipped because of status 'error'.  Reason: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [21:6]
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql.
[0m03:52:37.235539 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:e74471db-864e-4bd5-b7ed-e966e126058a&page=queryresults
[0m03:52:38.120191 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:1dc6c1d3-a482-46ee-af62-ac21695f3093&page=queryresults
[0m03:52:38.917728 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1a501b-b97a-415c-8de0-788dc80242eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce4eebd50>]}
[0m03:52:38.918881 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_vehicle ... [[32mCREATE TABLE (70.0 rows, 3.8 KiB processed)[0m in 2.61s]
[0m03:52:38.920028 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m03:52:39.679385 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de1a501b-b97a-415c-8de0-788dc80242eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce4f5f290>]}
[0m03:52:39.680362 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_ride ...... [[32mMERGE (70.0 rows, 12.4 KiB processed)[0m in 3.37s]
[0m03:52:39.681451 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m03:52:39.683459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:52:39.686098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:52:39.686767 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m03:52:39.687347 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m03:52:39.688064 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m03:52:39.688677 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m03:52:39.689405 [info ] [MainThread]: 
[0m03:52:39.690190 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 4.13 seconds (4.13s).
[0m03:52:39.691872 [debug] [MainThread]: Command end result
[0m03:52:39.724313 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m03:52:39.728477 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m03:52:39.737091 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m03:52:39.737790 [info ] [MainThread]: 
[0m03:52:39.738825 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m03:52:39.739745 [info ] [MainThread]: 
[0m03:52:39.740820 [error] [MainThread]:   Database Error in model stg_customer (models/staging/stg_customer.sql)
  Syntax error: Unexpected identifier "cleaned" at [20:1]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m03:52:39.741979 [info ] [MainThread]: 
[0m03:52:39.743012 [error] [MainThread]:   Database Error in model stg_driver (models/staging/stg_driver.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [21:6]
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m03:52:39.743991 [info ] [MainThread]: 
[0m03:52:39.744993 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m03:52:39.746473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.3955393, "process_in_blocks": "0", "process_kernel_time": 0.179213, "process_mem_max_rss": "228640", "process_out_blocks": "0", "process_user_time": 3.494667}
[0m03:52:39.747372 [debug] [MainThread]: Command `dbt run` failed at 03:52:39.747265 after 5.40 seconds
[0m03:52:39.748166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d14e4a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d14acbf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d14acba50>]}
[0m03:52:39.749218 [debug] [MainThread]: Flushing usage events
[0m03:52:40.816296 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:54:09.824353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4eac2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4efd8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4eac2610>]}


============================== 03:54:09.826791 | dca53bf5-95ca-495c-a2d5-f385a35a5fe7 ==============================
[0m03:54:09.826791 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:54:09.828128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:54:10.392039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dca53bf5-95ca-495c-a2d5-f385a35a5fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4eac9d90>]}
[0m03:54:10.444749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dca53bf5-95ca-495c-a2d5-f385a35a5fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d50d3a190>]}
[0m03:54:10.446382 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m03:54:10.515417 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m03:54:10.668063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:54:10.669476 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/stg_driver.sql
[0m03:54:10.932783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project
- models.dbt_project.example
[0m03:54:10.945126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dca53bf5-95ca-495c-a2d5-f385a35a5fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d24d8fa90>]}
[0m03:54:11.016954 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m03:54:11.022375 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m03:54:11.037186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dca53bf5-95ca-495c-a2d5-f385a35a5fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d130fe950>]}
[0m03:54:11.038504 [info ] [MainThread]: Found 4 models, 4 sources, 487 macros
[0m03:54:11.040006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dca53bf5-95ca-495c-a2d5-f385a35a5fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d24a611d0>]}
[0m03:54:11.042707 [info ] [MainThread]: 
[0m03:54:11.043862 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:54:11.044906 [info ] [MainThread]: 
[0m03:54:11.046330 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:54:11.051326 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m03:54:11.052237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:54:11.620969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m03:54:11.621871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:54:11.853218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dca53bf5-95ca-495c-a2d5-f385a35a5fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d2485e910>]}
[0m03:54:11.854570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:54:11.858863 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m03:54:11.859202 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m03:54:11.859759 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m03:54:11.860114 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m03:54:11.860800 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.stg_customer ....... [RUN]
[0m03:54:11.862351 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.stg_driver ......... [RUN]
[0m03:54:11.863397 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.stg_ride ........... [RUN]
[0m03:54:11.864522 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.stg_vehicle ........ [RUN]
[0m03:54:11.865737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.stg_customer)
[0m03:54:11.867042 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m03:54:11.868162 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m03:54:11.869546 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m03:54:11.870647 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m03:54:11.871533 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m03:54:11.872319 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m03:54:11.873149 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m03:54:11.881753 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m03:54:11.885135 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m03:54:11.888635 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m03:54:11.892817 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m03:54:11.898729 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m03:54:11.899191 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m03:54:11.910645 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m03:54:11.921005 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m03:54:11.943261 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:54:11.943612 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:54:11.968643 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:54:11.973685 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m03:54:12.050539 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`stg_customer`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
)

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m03:54:12.051715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:12.258156 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m03:54:12.265814 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_ride` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
)

SELECT *
FROM source
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ride_id = DBT_INTERNAL_DEST.ride_id
            )

    
    when matched then update set
        `ride_id` = DBT_INTERNAL_SOURCE.`ride_id`,`cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`distance_km` = DBT_INTERNAL_SOURCE.`distance_km`,`fare` = DBT_INTERNAL_SOURCE.`fare`,`ride_status` = DBT_INTERNAL_SOURCE.`ride_status`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)
    values
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)


    
[0m03:54:12.282459 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m03:54:12.285197 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m03:54:12.292256 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
)

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m03:54:12.293721 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
)

SELECT *
FROM source
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.vehicle_id = DBT_INTERNAL_DEST.vehicle_id
            )

    
    when matched then update set
        `vehicle_id` = DBT_INTERNAL_SOURCE.`vehicle_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`vehicle_type` = DBT_INTERNAL_SOURCE.`vehicle_type`,`license_plate` = DBT_INTERNAL_SOURCE.`license_plate`,`year` = DBT_INTERNAL_SOURCE.`year`,`brand` = DBT_INTERNAL_SOURCE.`brand`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)
    values
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)


    
[0m03:54:12.497365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:cc35f3a9-4a3c-4aa0-9e92-a8e815d27132&page=queryresults
[0m03:54:12.498647 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:cc35f3a9-4a3c-4aa0-9e92-a8e815d27132&page=queryresults
[0m03:54:12.503409 [debug] [Thread-1 (]: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Syntax error: Unexpected identifier "cleaned" at [20:1]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m03:54:12.505335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dca53bf5-95ca-495c-a2d5-f385a35a5fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d131ddf10>]}
[0m03:54:12.506641 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source.stg_customer  [[31mERROR[0m in 0.64s]
[0m03:54:12.507699 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m03:54:12.508665 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_customer' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Syntax error: Unexpected identifier "cleaned" at [20:1]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql.
[0m03:54:12.642837 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:81548928-2f7a-48f0-a02d-c57c47f1e53f&page=queryresults
[0m03:54:12.644081 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:81548928-2f7a-48f0-a02d-c57c47f1e53f&page=queryresults
[0m03:54:12.647977 [debug] [Thread-2 (]: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Syntax error: Unexpected identifier "cleaned" at [21:1]
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m03:54:12.650207 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dca53bf5-95ca-495c-a2d5-f385a35a5fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1319d850>]}
[0m03:54:12.653167 [error] [Thread-2 (]: 2 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source.stg_driver  [[31mERROR[0m in 0.78s]
[0m03:54:12.654899 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m03:54:12.656314 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_driver' to be skipped because of status 'error'.  Reason: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Syntax error: Unexpected identifier "cleaned" at [21:1]
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql.
[0m03:54:12.860424 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a9427830-3516-49dd-9eb5-a2219a516405&page=queryresults
[0m03:54:13.771075 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:e4333740-597d-4c81-a3c3-1f327fd88867&page=queryresults
[0m03:54:14.462404 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dca53bf5-95ca-495c-a2d5-f385a35a5fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d131e4d90>]}
[0m03:54:14.463748 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_vehicle ... [[32mMERGE (70.0 rows, 7.7 KiB processed)[0m in 2.59s]
[0m03:54:14.464971 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m03:54:15.705479 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dca53bf5-95ca-495c-a2d5-f385a35a5fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d0bf5ed50>]}
[0m03:54:15.706518 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_ride ...... [[32mMERGE (70.0 rows, 12.4 KiB processed)[0m in 3.84s]
[0m03:54:15.708446 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m03:54:15.710841 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:54:15.714265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:54:15.715176 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m03:54:15.716248 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m03:54:15.717148 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m03:54:15.718336 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m03:54:15.719294 [info ] [MainThread]: 
[0m03:54:15.720339 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m03:54:15.722362 [debug] [MainThread]: Command end result
[0m03:54:15.756474 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m03:54:15.762363 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m03:54:15.772373 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m03:54:15.773330 [info ] [MainThread]: 
[0m03:54:15.774326 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m03:54:15.775362 [info ] [MainThread]: 
[0m03:54:15.776403 [error] [MainThread]:   Database Error in model stg_customer (models/staging/stg_customer.sql)
  Syntax error: Unexpected identifier "cleaned" at [20:1]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m03:54:15.778073 [info ] [MainThread]: 
[0m03:54:15.779409 [error] [MainThread]:   Database Error in model stg_driver (models/staging/stg_driver.sql)
  Syntax error: Unexpected identifier "cleaned" at [21:1]
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m03:54:15.780443 [info ] [MainThread]: 
[0m03:54:15.781604 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m03:54:15.783321 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.004255, "process_in_blocks": "0", "process_kernel_time": 0.274545, "process_mem_max_rss": "226336", "process_out_blocks": "0", "process_user_time": 3.42674}
[0m03:54:15.784707 [debug] [MainThread]: Command `dbt run` failed at 03:54:15.784406 after 6.01 seconds
[0m03:54:15.785493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4eebe650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4eb41850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4eb43c50>]}
[0m03:54:15.786593 [debug] [MainThread]: Flushing usage events
[0m03:54:16.902471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:55:09.159775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a4cbfcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a506a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a4c726d0>]}


============================== 03:55:09.162354 | b8cac8fb-cd27-41d4-8ccc-b907ce13dd9d ==============================
[0m03:55:09.162354 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:55:09.163683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:55:09.242657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8cac8fb-cd27-41d4-8ccc-b907ce13dd9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a4ccd810>]}
[0m03:55:09.294947 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18828923, "process_in_blocks": "0", "process_kernel_time": 0.039608, "process_mem_max_rss": "89936", "process_out_blocks": "0", "process_user_time": 0.960514}
[0m03:55:09.296131 [debug] [MainThread]: Command `dbt clean` succeeded at 03:55:09.296013 after 0.19 seconds
[0m03:55:09.297179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a4c72ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a4c72190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40a843cc10>]}
[0m03:55:09.298057 [debug] [MainThread]: Flushing usage events
[0m03:55:10.369621 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:55:24.770918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc383cfe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc383cf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc383ce650>]}


============================== 03:55:24.774277 | 0c7ae357-769b-49ef-8725-7187896870d1 ==============================
[0m03:55:24.774277 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:55:24.775891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:55:24.863354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c7ae357-769b-49ef-8725-7187896870d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc38302f10>]}
[0m03:55:24.872599 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:55:24.875455 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:55:24.876872 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15382788, "process_in_blocks": "0", "process_kernel_time": 0.090793, "process_mem_max_rss": "90180", "process_out_blocks": "0", "process_user_time": 0.978553}
[0m03:55:24.877995 [debug] [MainThread]: Command `dbt deps` succeeded at 03:55:24.877857 after 0.16 seconds
[0m03:55:24.878921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3841f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc38884310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc3bc24b90>]}
[0m03:55:24.879873 [debug] [MainThread]: Flushing usage events
[0m03:55:26.050892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:55:28.807178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777b2078d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777a54f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777a8f8190>]}


============================== 03:55:28.810814 | 2963f7c2-f555-493c-bdd6-ed99d18b3bd1 ==============================
[0m03:55:28.810814 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:55:28.812027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:55:29.417786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2963f7c2-f555-493c-bdd6-ed99d18b3bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7753134b50>]}
[0m03:55:29.464029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2963f7c2-f555-493c-bdd6-ed99d18b3bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775080f5d0>]}
[0m03:55:29.465558 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m03:55:29.538658 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m03:55:29.541544 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:55:29.542274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2963f7c2-f555-493c-bdd6-ed99d18b3bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775086c750>]}
[0m03:55:30.548355 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project.example
- models.dbt_project
[0m03:55:30.559047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2963f7c2-f555-493c-bdd6-ed99d18b3bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7750557c10>]}
[0m03:55:30.623650 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m03:55:30.629340 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m03:55:30.644547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2963f7c2-f555-493c-bdd6-ed99d18b3bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7750407650>]}
[0m03:55:30.645711 [info ] [MainThread]: Found 4 models, 4 sources, 487 macros
[0m03:55:30.646988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2963f7c2-f555-493c-bdd6-ed99d18b3bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775012b390>]}
[0m03:55:30.649699 [info ] [MainThread]: 
[0m03:55:30.650862 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:55:30.651836 [info ] [MainThread]: 
[0m03:55:30.653009 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:55:30.657771 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m03:55:30.658952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:55:31.214619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m03:55:31.215562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:55:31.431486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2963f7c2-f555-493c-bdd6-ed99d18b3bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77505cb690>]}
[0m03:55:31.432650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:55:31.438165 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m03:55:31.438546 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m03:55:31.439004 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m03:55:31.439377 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m03:55:31.440151 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.stg_customer ....... [RUN]
[0m03:55:31.441542 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.stg_driver ......... [RUN]
[0m03:55:31.442821 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.stg_ride ........... [RUN]
[0m03:55:31.443938 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.stg_vehicle ........ [RUN]
[0m03:55:31.445307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.stg_customer)
[0m03:55:31.446572 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m03:55:31.448002 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m03:55:31.449149 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m03:55:31.450139 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m03:55:31.450927 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m03:55:31.451735 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m03:55:31.452862 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m03:55:31.461263 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m03:55:31.465636 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m03:55:31.469369 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m03:55:31.472947 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m03:55:31.486675 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m03:55:31.498362 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m03:55:31.522128 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m03:55:31.522470 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m03:55:31.538896 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:55:31.541798 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:55:31.567226 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:55:31.575318 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m03:55:31.669405 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`stg_customer`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
)

WITH cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m03:55:31.670530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:31.918699 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m03:55:31.921156 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m03:55:31.922692 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m03:55:31.928621 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_ride` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
)

SELECT *
FROM source
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ride_id = DBT_INTERNAL_DEST.ride_id
            )

    
    when matched then update set
        `ride_id` = DBT_INTERNAL_SOURCE.`ride_id`,`cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`distance_km` = DBT_INTERNAL_SOURCE.`distance_km`,`fare` = DBT_INTERNAL_SOURCE.`fare`,`ride_status` = DBT_INTERNAL_SOURCE.`ride_status`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)
    values
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)


    
[0m03:55:31.931728 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
)

WITH cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m03:55:31.934284 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
)

SELECT *
FROM source
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.vehicle_id = DBT_INTERNAL_DEST.vehicle_id
            )

    
    when matched then update set
        `vehicle_id` = DBT_INTERNAL_SOURCE.`vehicle_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`vehicle_type` = DBT_INTERNAL_SOURCE.`vehicle_type`,`license_plate` = DBT_INTERNAL_SOURCE.`license_plate`,`year` = DBT_INTERNAL_SOURCE.`year`,`brand` = DBT_INTERNAL_SOURCE.`brand`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)
    values
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)


    
[0m03:55:32.182142 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:099f2d54-5d14-4ae4-9ffb-989e83538f9f&page=queryresults
[0m03:55:32.183346 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:099f2d54-5d14-4ae4-9ffb-989e83538f9f&page=queryresults
[0m03:55:32.187968 [debug] [Thread-1 (]: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [20:6]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m03:55:32.190308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2963f7c2-f555-493c-bdd6-ed99d18b3bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7702f8f150>]}
[0m03:55:32.191747 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source.stg_customer  [[31mERROR[0m in 0.74s]
[0m03:55:32.193153 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m03:55:32.194571 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_customer' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [20:6]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql.
[0m03:55:32.199419 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a8ef050e-ecc6-4976-bae6-17bd99d1396c&page=queryresults
[0m03:55:32.283921 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:9b6c3bff-c7bc-4c12-86a7-385f561c0395&page=queryresults
[0m03:55:32.285117 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:9b6c3bff-c7bc-4c12-86a7-385f561c0395&page=queryresults
[0m03:55:32.289236 [debug] [Thread-2 (]: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [21:6]
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m03:55:32.290314 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2963f7c2-f555-493c-bdd6-ed99d18b3bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774a90fe90>]}
[0m03:55:32.291582 [error] [Thread-2 (]: 2 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source.stg_driver  [[31mERROR[0m in 0.84s]
[0m03:55:32.292890 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m03:55:32.294284 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_driver' to be skipped because of status 'error'.  Reason: Database Error in model stg_driver (models/staging/stg_driver.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [21:6]
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql.
[0m03:55:32.472294 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5b3e4fc1-d0ad-4058-84bf-60127e0576f9&page=queryresults
[0m03:55:34.019349 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2963f7c2-f555-493c-bdd6-ed99d18b3bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774a9ef2d0>]}
[0m03:55:34.020819 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_vehicle ... [[32mMERGE (70.0 rows, 7.7 KiB processed)[0m in 2.57s]
[0m03:55:34.022224 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m03:55:34.274515 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2963f7c2-f555-493c-bdd6-ed99d18b3bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7702fe1090>]}
[0m03:55:34.276259 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_ride ...... [[32mMERGE (70.0 rows, 12.4 KiB processed)[0m in 2.83s]
[0m03:55:34.278487 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m03:55:34.281322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:55:34.285203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:55:34.285984 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m03:55:34.286849 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m03:55:34.287649 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m03:55:34.288407 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m03:55:34.289540 [info ] [MainThread]: 
[0m03:55:34.290431 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 3.64 seconds (3.64s).
[0m03:55:34.292046 [debug] [MainThread]: Command end result
[0m03:55:34.326600 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m03:55:34.330260 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m03:55:34.337377 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m03:55:34.338364 [info ] [MainThread]: 
[0m03:55:34.339345 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m03:55:34.340285 [info ] [MainThread]: 
[0m03:55:34.341190 [error] [MainThread]:   Database Error in model stg_customer (models/staging/stg_customer.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [20:6]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m03:55:34.342011 [info ] [MainThread]: 
[0m03:55:34.343022 [error] [MainThread]:   Database Error in model stg_driver (models/staging/stg_driver.sql)
  Syntax error: Expected keyword DEPTH but got identifier "cleaned" at [21:6]
  compiled code at target/run/hailing_project/models/staging/stg_driver.sql
[0m03:55:34.343830 [info ] [MainThread]: 
[0m03:55:34.344871 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m03:55:34.346684 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.5879216, "process_in_blocks": "0", "process_kernel_time": 0.23382, "process_mem_max_rss": "229560", "process_out_blocks": "0", "process_user_time": 4.188439}
[0m03:55:34.347840 [debug] [MainThread]: Command `dbt run` failed at 03:55:34.347695 after 5.59 seconds
[0m03:55:34.348837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777a57b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777deb5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777a925f50>]}
[0m03:55:34.349649 [debug] [MainThread]: Flushing usage events
[0m03:55:35.369581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:57:01.842205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee18996e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee189ebbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee18eb0a50>]}


============================== 03:57:01.845022 | faa07538-7d5c-40c2-b3fa-ba941cc648ea ==============================
[0m03:57:01.845022 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:57:01.846405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:57:01.925705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'faa07538-7d5c-40c2-b3fa-ba941cc648ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee18828290>]}
[0m03:57:01.984078 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19159567, "process_in_blocks": "0", "process_kernel_time": 0.110106, "process_mem_max_rss": "90232", "process_out_blocks": "0", "process_user_time": 0.990958}
[0m03:57:01.985043 [debug] [MainThread]: Command `dbt clean` succeeded at 03:57:01.984933 after 0.19 seconds
[0m03:57:01.985741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee189ef010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee189ee250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee1c190c10>]}
[0m03:57:01.986387 [debug] [MainThread]: Flushing usage events
[0m03:57:03.102048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:57:04.236538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5e1db990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5e22efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd60a89ed0>]}


============================== 03:57:04.239085 | 12044cc6-e7bf-4a2b-9974-6fa04b8997a3 ==============================
[0m03:57:04.239085 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:57:04.240329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:57:04.321313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12044cc6-e7bf-4a2b-9974-6fa04b8997a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5e0e3dd0>]}
[0m03:57:04.330902 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:57:04.333293 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:57:04.334731 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14978145, "process_in_blocks": "0", "process_kernel_time": 0.050052, "process_mem_max_rss": "90192", "process_out_blocks": "0", "process_user_time": 1.02107}
[0m03:57:04.335828 [debug] [MainThread]: Command `dbt deps` succeeded at 03:57:04.335688 after 0.15 seconds
[0m03:57:04.336779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5e22f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5e26a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd61a34b90>]}
[0m03:57:04.337703 [debug] [MainThread]: Flushing usage events
[0m03:57:05.361502 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:57:10.069705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db55d7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db597e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db5586e50>]}


============================== 03:57:10.072220 | 69de4a25-c58b-4675-beab-b2b8eff3ef12 ==============================
[0m03:57:10.072220 [info ] [MainThread]: Running with dbt=1.9.0
[0m03:57:10.074696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:57:10.640124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69de4a25-c58b-4675-beab-b2b8eff3ef12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8cd99ad0>]}
[0m03:57:10.688109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69de4a25-c58b-4675-beab-b2b8eff3ef12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db77d8dd0>]}
[0m03:57:10.689656 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m03:57:10.758220 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m03:57:10.761682 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:57:10.762700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '69de4a25-c58b-4675-beab-b2b8eff3ef12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d877cf610>]}
[0m03:57:11.751320 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project
- models.dbt_project.example
[0m03:57:11.764502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69de4a25-c58b-4675-beab-b2b8eff3ef12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d877c16d0>]}
[0m03:57:11.835931 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m03:57:11.842835 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m03:57:11.860727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69de4a25-c58b-4675-beab-b2b8eff3ef12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d87396ad0>]}
[0m03:57:11.861885 [info ] [MainThread]: Found 4 models, 4 sources, 487 macros
[0m03:57:11.863283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69de4a25-c58b-4675-beab-b2b8eff3ef12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d87369a10>]}
[0m03:57:11.867070 [info ] [MainThread]: 
[0m03:57:11.868330 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:57:11.869453 [info ] [MainThread]: 
[0m03:57:11.870892 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:57:11.876006 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m03:57:11.877128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:12.483653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m03:57:12.485001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:57:12.697190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69de4a25-c58b-4675-beab-b2b8eff3ef12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8746b290>]}
[0m03:57:12.701160 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:57:12.706561 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m03:57:12.706888 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m03:57:12.707224 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m03:57:12.707525 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m03:57:12.708027 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.stg_customer ....... [RUN]
[0m03:57:12.708940 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.stg_driver ......... [RUN]
[0m03:57:12.709867 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.stg_ride ........... [RUN]
[0m03:57:12.710807 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.stg_vehicle ........ [RUN]
[0m03:57:12.711929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.stg_customer)
[0m03:57:12.712899 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m03:57:12.713772 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m03:57:12.714622 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m03:57:12.715332 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m03:57:12.716134 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m03:57:12.716881 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m03:57:12.717629 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m03:57:12.724464 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m03:57:12.728563 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m03:57:12.732520 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m03:57:12.736321 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m03:57:12.748694 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m03:57:12.749993 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m03:57:12.794869 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m03:57:12.795275 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m03:57:12.797594 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:57:12.797998 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:57:12.822461 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:57:12.827901 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m03:57:12.927185 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`stg_customer`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
),

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned
    );
  
[0m03:57:12.928316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:13.157076 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m03:57:13.161516 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m03:57:13.162911 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m03:57:13.168305 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m03:57:13.169715 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_ride` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
)

SELECT *
FROM source
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ride_id = DBT_INTERNAL_DEST.ride_id
            )

    
    when matched then update set
        `ride_id` = DBT_INTERNAL_SOURCE.`ride_id`,`cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`distance_km` = DBT_INTERNAL_SOURCE.`distance_km`,`fare` = DBT_INTERNAL_SOURCE.`fare`,`ride_status` = DBT_INTERNAL_SOURCE.`ride_status`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)
    values
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)


    
[0m03:57:13.173739 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
)

SELECT *
FROM source
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.vehicle_id = DBT_INTERNAL_DEST.vehicle_id
            )

    
    when matched then update set
        `vehicle_id` = DBT_INTERNAL_SOURCE.`vehicle_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`vehicle_type` = DBT_INTERNAL_SOURCE.`vehicle_type`,`license_plate` = DBT_INTERNAL_SOURCE.`license_plate`,`year` = DBT_INTERNAL_SOURCE.`year`,`brand` = DBT_INTERNAL_SOURCE.`brand`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)
    values
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)


    
[0m03:57:13.347744 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9c82e0b7-2856-4508-9a62-6e88dec4c098&page=queryresults
[0m03:57:13.452667 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:22fa7bdc-468c-48cd-8f1c-d452a15eeef1&page=queryresults
[0m03:57:13.509953 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2034e47d-b241-441c-96b7-b0377fa7389e&page=queryresults
[0m03:57:13.798102 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d09d99b6-dd3d-4f3b-b11a-6e5e01b7e7d3&page=queryresults
[0m03:57:15.216883 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69de4a25-c58b-4675-beab-b2b8eff3ef12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d45f12190>]}
[0m03:57:15.218074 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_vehicle ... [[32mMERGE (70.0 rows, 7.7 KiB processed)[0m in 2.50s]
[0m03:57:15.219463 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m03:57:15.227541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69de4a25-c58b-4675-beab-b2b8eff3ef12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d8599fc50>]}
[0m03:57:15.228867 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_customer .. [[32mCREATE TABLE (70.0 rows, 4.8 KiB processed)[0m in 2.52s]
[0m03:57:15.230098 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m03:57:15.310368 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69de4a25-c58b-4675-beab-b2b8eff3ef12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d85957850>]}
[0m03:57:15.311608 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_driver .... [[32mMERGE (70.0 rows, 9.4 KiB processed)[0m in 2.60s]
[0m03:57:15.312911 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m03:57:15.334356 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69de4a25-c58b-4675-beab-b2b8eff3ef12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d859c6cd0>]}
[0m03:57:15.335323 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_ride ...... [[32mMERGE (70.0 rows, 12.4 KiB processed)[0m in 2.62s]
[0m03:57:15.336578 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m03:57:15.339497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:57:15.342938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:57:15.343644 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m03:57:15.344402 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m03:57:15.345062 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m03:57:15.346048 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m03:57:15.346926 [info ] [MainThread]: 
[0m03:57:15.347830 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m03:57:15.349520 [debug] [MainThread]: Command end result
[0m03:57:15.382035 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m03:57:15.386515 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m03:57:15.395721 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m03:57:15.396571 [info ] [MainThread]: 
[0m03:57:15.397619 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:57:15.398638 [info ] [MainThread]: 
[0m03:57:15.399671 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m03:57:15.401547 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.3793664, "process_in_blocks": "0", "process_kernel_time": 0.191403, "process_mem_max_rss": "226976", "process_out_blocks": "0", "process_user_time": 4.200798}
[0m03:57:15.402517 [debug] [MainThread]: Command `dbt run` succeeded at 03:57:15.402401 after 5.38 seconds
[0m03:57:15.403554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db8d50b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d87841410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db597e150>]}
[0m03:57:15.404425 [debug] [MainThread]: Flushing usage events
[0m03:57:16.432072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:14:24.057157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e02e3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e02e3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e02e2ed0>]}


============================== 07:14:24.062167 | 9217f315-1bb4-4d1d-a3d5-eb8a8b52fd2f ==============================
[0m07:14:24.062167 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:14:24.063873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:14:24.739792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9217f315-1bb4-4d1d-a3d5-eb8a8b52fd2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b247eb10>]}
[0m07:14:24.789404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9217f315-1bb4-4d1d-a3d5-eb8a8b52fd2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e256e0d0>]}
[0m07:14:24.790645 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m07:14:24.876192 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:14:25.046511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:14:25.047417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:14:25.053276 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project
- models.dbt_project.example
[0m07:14:25.080426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9217f315-1bb4-4d1d-a3d5-eb8a8b52fd2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e111e0d0>]}
[0m07:14:25.204505 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m07:14:25.213125 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m07:14:25.236328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9217f315-1bb4-4d1d-a3d5-eb8a8b52fd2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b233e390>]}
[0m07:14:25.237722 [info ] [MainThread]: Found 4 models, 4 sources, 487 macros
[0m07:14:25.238754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9217f315-1bb4-4d1d-a3d5-eb8a8b52fd2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e2662310>]}
[0m07:14:25.243057 [info ] [MainThread]: 
[0m07:14:25.244300 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:14:25.245371 [info ] [MainThread]: 
[0m07:14:25.246653 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:14:25.251061 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m07:14:25.252149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:25.932829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m07:14:25.934527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:14:26.181470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9217f315-1bb4-4d1d-a3d5-eb8a8b52fd2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e08c53d0>]}
[0m07:14:26.183857 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:14:26.191654 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m07:14:26.192053 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m07:14:26.192475 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m07:14:26.192840 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m07:14:26.193442 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.stg_customer ....... [RUN]
[0m07:14:26.196094 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.stg_driver ......... [RUN]
[0m07:14:26.197379 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.stg_ride ........... [RUN]
[0m07:14:26.198742 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.stg_vehicle ........ [RUN]
[0m07:14:26.199964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.stg_customer)
[0m07:14:26.203516 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m07:14:26.204699 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m07:14:26.206016 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m07:14:26.206896 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m07:14:26.209575 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m07:14:26.210992 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m07:14:26.212091 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m07:14:26.222007 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m07:14:26.226201 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m07:14:26.232466 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m07:14:26.237762 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m07:14:26.253551 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m07:14:26.255208 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m07:14:26.266408 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m07:14:26.289452 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m07:14:26.329708 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:14:26.331299 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:14:26.334154 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:14:26.337479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:14:26.663888 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m07:14:26.666159 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m07:14:26.667965 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m07:14:26.669058 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m07:14:26.686209 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m07:14:26.692104 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_ride` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
)

SELECT *
FROM source
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ride_id = DBT_INTERNAL_DEST.ride_id
            )

    
    when matched then update set
        `ride_id` = DBT_INTERNAL_SOURCE.`ride_id`,`cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`distance_km` = DBT_INTERNAL_SOURCE.`distance_km`,`fare` = DBT_INTERNAL_SOURCE.`fare`,`ride_status` = DBT_INTERNAL_SOURCE.`ride_status`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)
    values
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)


    
[0m07:14:26.692943 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
)

SELECT *
FROM source
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.vehicle_id = DBT_INTERNAL_DEST.vehicle_id
            )

    
    when matched then update set
        `vehicle_id` = DBT_INTERNAL_SOURCE.`vehicle_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`vehicle_type` = DBT_INTERNAL_SOURCE.`vehicle_type`,`license_plate` = DBT_INTERNAL_SOURCE.`license_plate`,`year` = DBT_INTERNAL_SOURCE.`year`,`brand` = DBT_INTERNAL_SOURCE.`brand`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)
    values
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)


    
[0m07:14:26.695761 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_customer` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
),

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.cust_id = DBT_INTERNAL_DEST.cust_id
            )

    
    when matched then update set
        `cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`email` = DBT_INTERNAL_SOURCE.`email`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)
    values
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)


    
[0m07:14:27.289022 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:0bb9971d-ed97-4412-8de7-1cd4eb96858a&page=queryresults
[0m07:14:27.534418 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:30b64f7e-61b1-4cc3-88a0-49449c954f94&page=queryresults
[0m07:14:27.539028 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:5f5e5bea-79f6-44ed-b2be-3149264083f8&page=queryresults
[0m07:14:28.140278 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:7df0087e-63ef-46b7-9232-2f978ab7357a&page=queryresults
[0m07:14:29.295070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9217f315-1bb4-4d1d-a3d5-eb8a8b52fd2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e08735d0>]}
[0m07:14:29.296256 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_customer .. [[32mMERGE (70.0 rows, 9.5 KiB processed)[0m in 3.09s]
[0m07:14:29.297908 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m07:14:29.474888 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9217f315-1bb4-4d1d-a3d5-eb8a8b52fd2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e10afa90>]}
[0m07:14:29.476368 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_vehicle ... [[32mMERGE (70.0 rows, 7.7 KiB processed)[0m in 3.27s]
[0m07:14:29.477631 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m07:14:29.667286 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9217f315-1bb4-4d1d-a3d5-eb8a8b52fd2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b2142dd0>]}
[0m07:14:29.669166 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_ride ...... [[32mMERGE (70.0 rows, 12.4 KiB processed)[0m in 3.46s]
[0m07:14:29.671011 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m07:14:30.129711 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9217f315-1bb4-4d1d-a3d5-eb8a8b52fd2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e02e9b90>]}
[0m07:14:30.130940 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_driver .... [[32mMERGE (70.0 rows, 9.4 KiB processed)[0m in 3.93s]
[0m07:14:30.133340 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m07:14:30.135664 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:14:30.138650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:14:30.139566 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m07:14:30.140512 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m07:14:30.141337 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m07:14:30.142170 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m07:14:30.143229 [info ] [MainThread]: 
[0m07:14:30.144330 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m07:14:30.146268 [debug] [MainThread]: Command end result
[0m07:14:30.181117 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m07:14:30.186507 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m07:14:30.194413 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m07:14:30.195439 [info ] [MainThread]: 
[0m07:14:30.196633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:14:30.197755 [info ] [MainThread]: 
[0m07:14:30.198773 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:14:30.200481 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.2747736, "process_in_blocks": "0", "process_kernel_time": 0.386009, "process_mem_max_rss": "222724", "process_out_blocks": "0", "process_user_time": 3.741319}
[0m07:14:30.201630 [debug] [MainThread]: Command `dbt run` succeeded at 07:14:30.201452 after 6.28 seconds
[0m07:14:30.202788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e035f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e035f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e3adcb90>]}
[0m07:14:30.203700 [debug] [MainThread]: Flushing usage events
[0m07:14:31.324369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:30:49.092343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb243071950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb243073710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb243072a10>]}


============================== 07:30:49.094968 | 9728cfc1-1b6b-4ee8-80a0-6b8a1269ab91 ==============================
[0m07:30:49.094968 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:30:49.096823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:30:49.662161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9728cfc1-1b6b-4ee8-80a0-6b8a1269ab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb243185d50>]}
[0m07:30:49.707859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9728cfc1-1b6b-4ee8-80a0-6b8a1269ab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2452f4e50>]}
[0m07:30:49.709238 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m07:30:49.773126 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:30:49.898481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 4 files changed.
[0m07:30:49.899480 [debug] [MainThread]: Partial parsing: added file: hailing_project://macros/check_if_incremental.sql
[0m07:30:49.900583 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/stg_ride.sql
[0m07:30:49.901425 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/stg_driver.sql
[0m07:30:49.902315 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/stg_vehicle.sql
[0m07:30:49.903057 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/stg_customer.sql
[0m07:30:50.157347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project
- models.dbt_project.example
[0m07:30:50.169781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9728cfc1-1b6b-4ee8-80a0-6b8a1269ab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb218f507d0>]}
[0m07:30:50.249233 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m07:30:50.255615 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m07:30:50.270170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9728cfc1-1b6b-4ee8-80a0-6b8a1269ab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb218f04450>]}
[0m07:30:50.271348 [info ] [MainThread]: Found 4 models, 4 sources, 488 macros
[0m07:30:50.272388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9728cfc1-1b6b-4ee8-80a0-6b8a1269ab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb218d4e5d0>]}
[0m07:30:50.275228 [info ] [MainThread]: 
[0m07:30:50.276310 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:50.277605 [info ] [MainThread]: 
[0m07:30:50.279144 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:30:50.284100 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m07:30:50.285414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:50.877964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m07:30:50.879091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:51.124803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9728cfc1-1b6b-4ee8-80a0-6b8a1269ab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb218d4d4d0>]}
[0m07:30:51.126503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:51.132518 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m07:30:51.132941 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m07:30:51.134089 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m07:30:51.134510 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m07:30:51.135150 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.stg_customer ....... [RUN]
[0m07:30:51.136590 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.stg_driver ......... [RUN]
[0m07:30:51.137744 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.stg_ride ........... [RUN]
[0m07:30:51.138924 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.stg_vehicle ........ [RUN]
[0m07:30:51.139939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.stg_customer)
[0m07:30:51.141051 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m07:30:51.142063 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m07:30:51.142952 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m07:30:51.143863 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m07:30:51.144646 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m07:30:51.145421 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m07:30:51.146314 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m07:30:51.156291 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m07:30:51.160500 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m07:30:51.165748 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m07:30:51.169689 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m07:30:51.175006 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m07:30:51.175513 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m07:30:51.181812 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m07:30:51.192903 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m07:30:51.213840 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:30:51.216169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:51.219998 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:30:51.223265 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:30:51.477753 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m07:30:51.486710 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.vehicle_id = DBT_INTERNAL_DEST.vehicle_id
            )

    
    when matched then update set
        `vehicle_id` = DBT_INTERNAL_SOURCE.`vehicle_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`vehicle_type` = DBT_INTERNAL_SOURCE.`vehicle_type`,`license_plate` = DBT_INTERNAL_SOURCE.`license_plate`,`year` = DBT_INTERNAL_SOURCE.`year`,`brand` = DBT_INTERNAL_SOURCE.`brand`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)
    values
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)


    
[0m07:30:51.495854 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m07:30:51.501589 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_customer` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
),

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_customer`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.cust_id = DBT_INTERNAL_DEST.cust_id
            )

    
    when matched then update set
        `cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`email` = DBT_INTERNAL_SOURCE.`email`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)
    values
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)


    
[0m07:30:51.503763 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m07:30:51.511415 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_ride` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_ride`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ride_id = DBT_INTERNAL_DEST.ride_id
            )

    
    when matched then update set
        `ride_id` = DBT_INTERNAL_SOURCE.`ride_id`,`cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`distance_km` = DBT_INTERNAL_SOURCE.`distance_km`,`fare` = DBT_INTERNAL_SOURCE.`fare`,`ride_status` = DBT_INTERNAL_SOURCE.`ride_status`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)
    values
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)


    
[0m07:30:51.532187 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m07:30:51.538923 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_driver`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m07:30:51.802681 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:090693f2-a77b-4dc8-a974-f80c6d37090c&page=queryresults
[0m07:30:51.866937 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d1f396e0-69ee-46d7-be88-08796ccc7b23&page=queryresults
[0m07:30:52.912257 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:50043940-5a09-439b-8426-768bd85eb2cb&page=queryresults
[0m07:30:52.914930 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:fd6c4e65-9a9f-4e70-89dd-ccfa76572ad6&page=queryresults
[0m07:30:53.702659 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9728cfc1-1b6b-4ee8-80a0-6b8a1269ab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb218e9c590>]}
[0m07:30:53.703990 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_vehicle ... [[32mMERGE (0.0 rows, 7.7 KiB processed)[0m in 2.56s]
[0m07:30:53.706127 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m07:30:53.754802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9728cfc1-1b6b-4ee8-80a0-6b8a1269ab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb218ddbb90>]}
[0m07:30:53.756838 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_customer .. [[32mMERGE (0.0 rows, 9.5 KiB processed)[0m in 2.61s]
[0m07:30:53.758693 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m07:30:54.561517 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9728cfc1-1b6b-4ee8-80a0-6b8a1269ab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb218dee910>]}
[0m07:30:54.564764 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_driver .... [[32mMERGE (0.0 rows, 9.4 KiB processed)[0m in 3.42s]
[0m07:30:54.567154 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m07:30:54.798589 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9728cfc1-1b6b-4ee8-80a0-6b8a1269ab91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb218ddc590>]}
[0m07:30:54.799938 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_ride ...... [[32mMERGE (0.0 rows, 12.4 KiB processed)[0m in 3.66s]
[0m07:30:54.801464 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m07:30:54.804555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:54.807896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:54.808619 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m07:30:54.809528 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m07:30:54.810651 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m07:30:54.811606 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m07:30:54.812830 [info ] [MainThread]: 
[0m07:30:54.814584 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m07:30:54.816849 [debug] [MainThread]: Command end result
[0m07:30:54.849859 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m07:30:54.854511 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m07:30:54.863605 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m07:30:54.864344 [info ] [MainThread]: 
[0m07:30:54.865567 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:54.866583 [info ] [MainThread]: 
[0m07:30:54.867577 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:30:54.869308 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.824409, "process_in_blocks": "0", "process_kernel_time": 0.194672, "process_mem_max_rss": "226324", "process_out_blocks": "0", "process_user_time": 3.463129}
[0m07:30:54.870348 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:54.870241 after 5.83 seconds
[0m07:30:54.871225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2469f1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2469f10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2469f1250>]}
[0m07:30:54.872311 [debug] [MainThread]: Flushing usage events
[0m07:30:55.990910 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:42:35.533356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda004fad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda004fa310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda004fac90>]}


============================== 07:42:35.536888 | 3b0b4895-c001-42c0-9901-b182671f7801 ==============================
[0m07:42:35.536888 [info ] [MainThread]: Running with dbt=1.9.0
[0m07:42:35.538473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:42:36.138255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b0b4895-c001-42c0-9901-b182671f7801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d2e81450>]}
[0m07:42:36.197358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b0b4895-c001-42c0-9901-b182671f7801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda027ae2d0>]}
[0m07:42:36.198620 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m07:42:36.276413 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m07:42:36.427590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:42:36.428428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:42:36.433150 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project
- models.dbt_project.example
[0m07:42:36.457172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b0b4895-c001-42c0-9901-b182671f7801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d2807790>]}
[0m07:42:36.590853 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m07:42:36.597347 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m07:42:36.615077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b0b4895-c001-42c0-9901-b182671f7801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d25779d0>]}
[0m07:42:36.616421 [info ] [MainThread]: Found 4 models, 4 sources, 488 macros
[0m07:42:36.617623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0b4895-c001-42c0-9901-b182671f7801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda01d2aa50>]}
[0m07:42:36.620269 [info ] [MainThread]: 
[0m07:42:36.621304 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:42:36.622260 [info ] [MainThread]: 
[0m07:42:36.623673 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:42:36.629307 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m07:42:36.630232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:37.168645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m07:42:37.169482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:37.359274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b0b4895-c001-42c0-9901-b182671f7801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d29c77d0>]}
[0m07:42:37.360592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:42:37.366038 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m07:42:37.366422 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m07:42:37.366910 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m07:42:37.367290 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m07:42:37.368112 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.stg_customer ....... [RUN]
[0m07:42:37.369831 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.stg_driver ......... [RUN]
[0m07:42:37.370910 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.stg_ride ........... [RUN]
[0m07:42:37.372130 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.stg_vehicle ........ [RUN]
[0m07:42:37.373291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.stg_customer)
[0m07:42:37.374617 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m07:42:37.376171 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m07:42:37.377221 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m07:42:37.378030 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m07:42:37.379097 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m07:42:37.380111 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m07:42:37.381012 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m07:42:37.398034 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m07:42:37.401786 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m07:42:37.406678 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m07:42:37.411604 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m07:42:37.417003 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m07:42:37.417593 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m07:42:37.418344 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m07:42:37.436542 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m07:42:37.465613 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:42:37.468608 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:42:37.471307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:37.475882 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:42:37.750408 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m07:42:37.752883 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m07:42:37.754469 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m07:42:37.760311 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_ride` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_ride`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ride_id = DBT_INTERNAL_DEST.ride_id
            )

    
    when matched then update set
        `ride_id` = DBT_INTERNAL_SOURCE.`ride_id`,`cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`distance_km` = DBT_INTERNAL_SOURCE.`distance_km`,`fare` = DBT_INTERNAL_SOURCE.`fare`,`ride_status` = DBT_INTERNAL_SOURCE.`ride_status`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)
    values
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)


    
[0m07:42:37.761455 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_customer` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
),

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_customer`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.cust_id = DBT_INTERNAL_DEST.cust_id
            )

    
    when matched then update set
        `cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`email` = DBT_INTERNAL_SOURCE.`email`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)
    values
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)


    
[0m07:42:37.763542 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_driver`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m07:42:37.767001 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m07:42:37.775191 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.vehicle_id = DBT_INTERNAL_DEST.vehicle_id
            )

    
    when matched then update set
        `vehicle_id` = DBT_INTERNAL_SOURCE.`vehicle_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`vehicle_type` = DBT_INTERNAL_SOURCE.`vehicle_type`,`license_plate` = DBT_INTERNAL_SOURCE.`license_plate`,`year` = DBT_INTERNAL_SOURCE.`year`,`brand` = DBT_INTERNAL_SOURCE.`brand`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)
    values
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)


    
[0m07:42:38.030298 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:48c61271-4f05-40fe-a346-89e53ea76384&page=queryresults
[0m07:42:38.038643 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:7c53dd75-39f1-4742-9386-016641bb0607&page=queryresults
[0m07:42:39.110434 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8c792602-497d-4efe-aaf1-5997c496371b&page=queryresults
[0m07:42:39.111976 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:4eb10280-dad4-41fb-9670-9016ab9bc08e&page=queryresults
[0m07:42:39.873799 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0b4895-c001-42c0-9901-b182671f7801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d28c1b50>]}
[0m07:42:39.874953 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_ride ...... [[32mMERGE (15.0 rows, 13.8 KiB processed)[0m in 2.50s]
[0m07:42:39.876635 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m07:42:39.910703 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0b4895-c001-42c0-9901-b182671f7801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d2535450>]}
[0m07:42:39.912022 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_driver .... [[32mMERGE (15.0 rows, 10.5 KiB processed)[0m in 2.54s]
[0m07:42:39.913738 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m07:42:40.607381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0b4895-c001-42c0-9901-b182671f7801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda00a8fe50>]}
[0m07:42:40.609295 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_customer .. [[32mMERGE (15.0 rows, 10.5 KiB processed)[0m in 3.23s]
[0m07:42:40.610912 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m07:42:40.629043 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b0b4895-c001-42c0-9901-b182671f7801', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0052db10>]}
[0m07:42:40.631131 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_vehicle ... [[32mMERGE (15.0 rows, 8.5 KiB processed)[0m in 3.25s]
[0m07:42:40.633420 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m07:42:40.636556 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:42:40.639742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:42:40.640702 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m07:42:40.641409 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m07:42:40.642052 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m07:42:40.642883 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m07:42:40.644114 [info ] [MainThread]: 
[0m07:42:40.645495 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m07:42:40.647562 [debug] [MainThread]: Command end result
[0m07:42:40.684982 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m07:42:40.689692 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m07:42:40.698032 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m07:42:40.698780 [info ] [MainThread]: 
[0m07:42:40.699834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:42:40.700859 [info ] [MainThread]: 
[0m07:42:40.701995 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:42:40.703611 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.221707, "process_in_blocks": "0", "process_kernel_time": 0.271276, "process_mem_max_rss": "222804", "process_out_blocks": "0", "process_user_time": 3.345746}
[0m07:42:40.704672 [debug] [MainThread]: Command `dbt run` succeeded at 07:42:40.704554 after 5.22 seconds
[0m07:42:40.705678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda03e13e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda03d2cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda008f65d0>]}
[0m07:42:40.706704 [debug] [MainThread]: Flushing usage events
[0m07:42:41.823814 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:18:12.432832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc75201efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc75201ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc75201ec90>]}


============================== 08:18:12.436866 | 873b1c9b-3fbb-4208-95d5-5d3038cd76f1 ==============================
[0m08:18:12.436866 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:18:12.438432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:18:13.019581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '873b1c9b-3fbb-4208-95d5-5d3038cd76f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7281f7fd0>]}
[0m08:18:13.068481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '873b1c9b-3fbb-4208-95d5-5d3038cd76f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7542cc9d0>]}
[0m08:18:13.069551 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m08:18:13.133470 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:18:13.303393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:18:13.304297 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:18:13.309036 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project.example
- models.dbt_project
[0m08:18:13.334214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '873b1c9b-3fbb-4208-95d5-5d3038cd76f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc728340610>]}
[0m08:18:13.454205 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:18:13.459718 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:18:13.473409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '873b1c9b-3fbb-4208-95d5-5d3038cd76f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc730bcc350>]}
[0m08:18:13.474285 [info ] [MainThread]: Found 4 models, 4 sources, 488 macros
[0m08:18:13.475356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '873b1c9b-3fbb-4208-95d5-5d3038cd76f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7283d30d0>]}
[0m08:18:13.478100 [info ] [MainThread]: 
[0m08:18:13.479228 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:18:13.480274 [info ] [MainThread]: 
[0m08:18:13.481633 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:18:13.486338 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m08:18:13.487277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:18:14.120962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m08:18:14.123822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:18:14.328906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '873b1c9b-3fbb-4208-95d5-5d3038cd76f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7298132d0>]}
[0m08:18:14.330246 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:18:14.335727 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m08:18:14.336095 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m08:18:14.336501 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m08:18:14.337017 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m08:18:14.337710 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.stg_customer ....... [RUN]
[0m08:18:14.339459 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.stg_driver ......... [RUN]
[0m08:18:14.340884 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.stg_ride ........... [RUN]
[0m08:18:14.342085 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.stg_vehicle ........ [RUN]
[0m08:18:14.343308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.stg_customer)
[0m08:18:14.344823 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m08:18:14.345920 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m08:18:14.346739 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m08:18:14.347521 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m08:18:14.348287 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m08:18:14.348945 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m08:18:14.349605 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m08:18:14.364590 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m08:18:14.368731 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m08:18:14.373105 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m08:18:14.376836 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m08:18:14.382847 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m08:18:14.383522 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m08:18:14.389653 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m08:18:14.400012 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m08:18:14.429197 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:18:14.429478 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:18:14.432490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:14.435631 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:18:14.726733 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m08:18:14.728540 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m08:18:14.729286 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m08:18:14.730515 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m08:18:14.735505 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_driver`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m08:18:14.736582 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_ride` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_ride`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ride_id = DBT_INTERNAL_DEST.ride_id
            )

    
    when matched then update set
        `ride_id` = DBT_INTERNAL_SOURCE.`ride_id`,`cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`distance_km` = DBT_INTERNAL_SOURCE.`distance_km`,`fare` = DBT_INTERNAL_SOURCE.`fare`,`ride_status` = DBT_INTERNAL_SOURCE.`ride_status`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)
    values
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)


    
[0m08:18:14.738965 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_customer` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
),

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_customer`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.cust_id = DBT_INTERNAL_DEST.cust_id
            )

    
    when matched then update set
        `cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`email` = DBT_INTERNAL_SOURCE.`email`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)
    values
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)


    
[0m08:18:14.739581 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.vehicle_id = DBT_INTERNAL_DEST.vehicle_id
            )

    
    when matched then update set
        `vehicle_id` = DBT_INTERNAL_SOURCE.`vehicle_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`vehicle_type` = DBT_INTERNAL_SOURCE.`vehicle_type`,`license_plate` = DBT_INTERNAL_SOURCE.`license_plate`,`year` = DBT_INTERNAL_SOURCE.`year`,`brand` = DBT_INTERNAL_SOURCE.`brand`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)
    values
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)


    
[0m08:18:15.072113 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:49718984-e9aa-404c-99c2-2a8a9ee4778a&page=queryresults
[0m08:18:15.075968 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c27e9b31-331d-4ef1-a721-af21532687e2&page=queryresults
[0m08:18:15.078186 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a07a28b7-71de-49a1-880d-3110dd9b5c5f&page=queryresults
[0m08:18:15.078652 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b6fb1980-78c9-41e3-8fef-05578a1c4be1&page=queryresults
[0m08:18:16.682071 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873b1c9b-3fbb-4208-95d5-5d3038cd76f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc728327bd0>]}
[0m08:18:16.682628 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873b1c9b-3fbb-4208-95d5-5d3038cd76f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc720185590>]}
[0m08:18:16.682909 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873b1c9b-3fbb-4208-95d5-5d3038cd76f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc728236210>]}
[0m08:18:16.683860 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_vehicle ... [[32mMERGE (0.0 rows, 9.3 KiB processed)[0m in 2.33s]
[0m08:18:16.685961 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_driver .... [[32mMERGE (0.0 rows, 11.5 KiB processed)[0m in 2.34s]
[0m08:18:16.687373 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_ride ...... [[32mMERGE (0.0 rows, 15.1 KiB processed)[0m in 2.34s]
[0m08:18:16.688659 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m08:18:16.690023 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m08:18:16.691368 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m08:18:16.925810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '873b1c9b-3fbb-4208-95d5-5d3038cd76f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7284a0490>]}
[0m08:18:16.928615 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_customer .. [[32mMERGE (0.0 rows, 11.5 KiB processed)[0m in 2.58s]
[0m08:18:16.931276 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m08:18:16.933597 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:18:16.936740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:18:16.937819 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m08:18:16.938708 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m08:18:16.939486 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m08:18:16.940531 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m08:18:16.941790 [info ] [MainThread]: 
[0m08:18:16.943806 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m08:18:16.945513 [debug] [MainThread]: Command end result
[0m08:18:16.989803 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:18:16.997847 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:18:17.006172 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m08:18:17.007010 [info ] [MainThread]: 
[0m08:18:17.008111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:18:17.009185 [info ] [MainThread]: 
[0m08:18:17.010118 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:18:17.011798 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.648351, "process_in_blocks": "0", "process_kernel_time": 0.190411, "process_mem_max_rss": "223264", "process_out_blocks": "0", "process_user_time": 3.397345}
[0m08:18:17.012890 [debug] [MainThread]: Command `dbt run` succeeded at 08:18:17.012744 after 4.65 seconds
[0m08:18:17.013849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc755874b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7559d1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7559d1150>]}
[0m08:18:17.014724 [debug] [MainThread]: Flushing usage events
[0m08:18:18.388019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:21:35.277834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa71026ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa71077610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa714229d0>]}


============================== 08:21:35.280368 | e7dbe8e6-b9b2-4380-bcf9-6a7a4dcf4949 ==============================
[0m08:21:35.280368 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:21:35.282387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:21:35.849786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7dbe8e6-b9b2-4380-bcf9-6a7a4dcf4949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa437f7d90>]}
[0m08:21:35.897980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7dbe8e6-b9b2-4380-bcf9-6a7a4dcf4949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa4394edd0>]}
[0m08:21:35.899081 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m08:21:35.965936 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:21:36.099694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:21:36.101230 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/sources.yml
[0m08:21:36.392563 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hailing_project.stg_customer' (models/staging/stg_customer.sql) depends on a source named 'source.customer_data' which was not found
[0m08:21:36.394691 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1627843, "process_in_blocks": "0", "process_kernel_time": 0.201076, "process_mem_max_rss": "215860", "process_out_blocks": "0", "process_user_time": 2.996037}
[0m08:21:36.395751 [debug] [MainThread]: Command `dbt run` failed at 08:21:36.395644 after 1.16 seconds
[0m08:21:36.396832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa710857d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa714228d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa749a1210>]}
[0m08:21:36.397751 [debug] [MainThread]: Flushing usage events
[0m08:21:37.585841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:21:58.696691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb527357190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb527357150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb527357390>]}


============================== 08:21:58.699223 | 3ac88093-f584-4fae-8042-6fc9b98c9baf ==============================
[0m08:21:58.699223 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:21:58.701425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:21:59.258717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ac88093-f584-4fae-8042-6fc9b98c9baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f952b4d0>]}
[0m08:21:59.304815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ac88093-f584-4fae-8042-6fc9b98c9baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5295aa690>]}
[0m08:21:59.306289 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m08:21:59.373130 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:21:59.512444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:21:59.513637 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/sources.yml
[0m08:21:59.686979 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project
- models.dbt_project.example
[0m08:21:59.699330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ac88093-f584-4fae-8042-6fc9b98c9baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f921f790>]}
[0m08:21:59.771445 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:21:59.777832 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:21:59.792999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ac88093-f584-4fae-8042-6fc9b98c9baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f8fc9550>]}
[0m08:21:59.794272 [info ] [MainThread]: Found 4 models, 4 sources, 488 macros
[0m08:21:59.795320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ac88093-f584-4fae-8042-6fc9b98c9baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb527a60c10>]}
[0m08:21:59.798178 [info ] [MainThread]: 
[0m08:21:59.799314 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:21:59.800266 [info ] [MainThread]: 
[0m08:21:59.801528 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:21:59.806732 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m08:21:59.807705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:22:00.404796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m08:22:00.405806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:22:00.625979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ac88093-f584-4fae-8042-6fc9b98c9baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5271c8490>]}
[0m08:22:00.627142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:22:00.631898 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m08:22:00.632440 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m08:22:00.632851 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m08:22:00.633224 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m08:22:00.633784 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.stg_customer ....... [RUN]
[0m08:22:00.634833 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.stg_driver ......... [RUN]
[0m08:22:00.635791 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.stg_ride ........... [RUN]
[0m08:22:00.636717 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.stg_vehicle ........ [RUN]
[0m08:22:00.637766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.stg_customer)
[0m08:22:00.638723 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m08:22:00.639631 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m08:22:00.640452 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m08:22:00.641237 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m08:22:00.641989 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m08:22:00.642641 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m08:22:00.643469 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m08:22:00.657714 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m08:22:00.661531 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m08:22:00.666182 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m08:22:00.670362 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m08:22:00.676069 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m08:22:00.676537 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m08:22:00.682740 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m08:22:00.683077 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m08:22:00.728513 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:22:00.731399 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:22:00.731912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:22:00.735429 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:22:01.021917 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m08:22:01.031763 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m08:22:01.032304 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_ride` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_ride`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ride_id = DBT_INTERNAL_DEST.ride_id
            )

    
    when matched then update set
        `ride_id` = DBT_INTERNAL_SOURCE.`ride_id`,`cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`distance_km` = DBT_INTERNAL_SOURCE.`distance_km`,`fare` = DBT_INTERNAL_SOURCE.`fare`,`ride_status` = DBT_INTERNAL_SOURCE.`ride_status`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)
    values
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)


    
[0m08:22:01.040120 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m08:22:01.042016 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_customer` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
),

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_customer`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.cust_id = DBT_INTERNAL_DEST.cust_id
            )

    
    when matched then update set
        `cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`email` = DBT_INTERNAL_SOURCE.`email`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)
    values
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)


    
[0m08:22:01.044675 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_driver`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m08:22:01.047051 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m08:22:01.055653 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.vehicle_id = DBT_INTERNAL_DEST.vehicle_id
            )

    
    when matched then update set
        `vehicle_id` = DBT_INTERNAL_SOURCE.`vehicle_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`vehicle_type` = DBT_INTERNAL_SOURCE.`vehicle_type`,`license_plate` = DBT_INTERNAL_SOURCE.`license_plate`,`year` = DBT_INTERNAL_SOURCE.`year`,`brand` = DBT_INTERNAL_SOURCE.`brand`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)
    values
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)


    
[0m08:22:01.320422 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:bf34a7f2-05d8-4b66-8f93-38355ae08d44&page=queryresults
[0m08:22:01.331037 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9c67940c-8b6f-440b-8c72-e95e28d6caeb&page=queryresults
[0m08:22:01.346206 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9fcd591b-0bb1-4f74-87e7-94b821539846&page=queryresults
[0m08:22:01.587215 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:c36f477f-d378-4222-81ba-639f48b9ab5f&page=queryresults
[0m08:22:03.143042 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ac88093-f584-4fae-8042-6fc9b98c9baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f86db890>]}
[0m08:22:03.143483 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ac88093-f584-4fae-8042-6fc9b98c9baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f9060890>]}
[0m08:22:03.144057 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ac88093-f584-4fae-8042-6fc9b98c9baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f9060fd0>]}
[0m08:22:03.144982 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_ride ...... [[32mMERGE (0.0 rows, 15.1 KiB processed)[0m in 2.50s]
[0m08:22:03.146513 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_driver .... [[32mMERGE (0.0 rows, 11.5 KiB processed)[0m in 2.50s]
[0m08:22:03.147929 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_vehicle ... [[32mMERGE (0.0 rows, 9.3 KiB processed)[0m in 2.50s]
[0m08:22:03.149289 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m08:22:03.150357 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m08:22:03.151275 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m08:22:03.396862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ac88093-f584-4fae-8042-6fc9b98c9baf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4f8696150>]}
[0m08:22:03.398466 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_customer .. [[32mMERGE (0.0 rows, 11.5 KiB processed)[0m in 2.76s]
[0m08:22:03.399879 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m08:22:03.402692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:22:03.407263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:22:03.408525 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m08:22:03.410677 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m08:22:03.411769 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m08:22:03.412743 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m08:22:03.414100 [info ] [MainThread]: 
[0m08:22:03.416519 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 3.61 seconds (3.61s).
[0m08:22:03.419113 [debug] [MainThread]: Command end result
[0m08:22:03.459681 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:22:03.464349 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:22:03.473447 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m08:22:03.474283 [info ] [MainThread]: 
[0m08:22:03.475524 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:22:03.476657 [info ] [MainThread]: 
[0m08:22:03.477740 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:22:03.479739 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8314342, "process_in_blocks": "0", "process_kernel_time": 0.144241, "process_mem_max_rss": "222996", "process_out_blocks": "0", "process_user_time": 3.451483}
[0m08:22:03.480925 [debug] [MainThread]: Command `dbt run` succeeded at 08:22:03.480799 after 4.83 seconds
[0m08:22:03.481928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb52ab48c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb52aca5350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb52aca5210>]}
[0m08:22:03.482989 [debug] [MainThread]: Flushing usage events
[0m08:22:04.544138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:22:17.701112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44daecbb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dae7b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dae7aa10>]}


============================== 08:22:17.703736 | b4a8c7b2-0f48-4de6-bf00-984e84d2b338 ==============================
[0m08:22:17.703736 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:22:17.707145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:22:18.292096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4a8c7b2-0f48-4de6-bf00-984e84d2b338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b1103810>]}
[0m08:22:18.337217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4a8c7b2-0f48-4de6-bf00-984e84d2b338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b117cf10>]}
[0m08:22:18.338226 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m08:22:18.406073 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:22:18.534804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:22:18.536253 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/sources.yml
[0m08:22:18.536954 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/stg_customer.sql
[0m08:22:18.833272 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hailing_project.stg_driver' (models/staging/stg_driver.sql) depends on a source named 'source.driver_data' which was not found
[0m08:22:18.835370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1823285, "process_in_blocks": "0", "process_kernel_time": 0.141755, "process_mem_max_rss": "215568", "process_out_blocks": "0", "process_user_time": 3.057857}
[0m08:22:18.836458 [debug] [MainThread]: Command `dbt run` failed at 08:22:18.836343 after 1.18 seconds
[0m08:22:18.837279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dacf9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dacfba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b0cd05d0>]}
[0m08:22:18.838174 [debug] [MainThread]: Flushing usage events
[0m08:22:19.859620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:22:41.760571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38887f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd388c6e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3888c36d0>]}


============================== 08:22:41.764248 | 971611f3-095f-4bdc-adff-384ed1f3b5dd ==============================
[0m08:22:41.764248 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:22:41.766273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:22:42.405008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '971611f3-095f-4bdc-adff-384ed1f3b5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3888df610>]}
[0m08:22:42.454837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '971611f3-095f-4bdc-adff-384ed1f3b5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd38ab04a10>]}
[0m08:22:42.456489 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m08:22:42.528347 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:22:42.672747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:22:42.673793 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/stg_customer.sql
[0m08:22:43.007607 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project
- models.dbt_project.example
[0m08:22:43.020459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '971611f3-095f-4bdc-adff-384ed1f3b5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35aa23810>]}
[0m08:22:43.100224 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:22:43.105650 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:22:43.121002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '971611f3-095f-4bdc-adff-384ed1f3b5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a86ff50>]}
[0m08:22:43.122311 [info ] [MainThread]: Found 4 models, 4 sources, 488 macros
[0m08:22:43.123673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '971611f3-095f-4bdc-adff-384ed1f3b5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a6d4390>]}
[0m08:22:43.126684 [info ] [MainThread]: 
[0m08:22:43.127817 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:22:43.128843 [info ] [MainThread]: 
[0m08:22:43.130513 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:22:43.136209 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m08:22:43.137209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:22:43.637140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m08:22:43.638417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:22:43.886919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '971611f3-095f-4bdc-adff-384ed1f3b5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a673d50>]}
[0m08:22:43.888157 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:22:43.894076 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m08:22:43.894455 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m08:22:43.894891 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m08:22:43.895213 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m08:22:43.895744 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.stg_customer ....... [RUN]
[0m08:22:43.896819 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.stg_driver ......... [RUN]
[0m08:22:43.897984 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.stg_ride ........... [RUN]
[0m08:22:43.899057 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.stg_vehicle ........ [RUN]
[0m08:22:43.900200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.stg_customer)
[0m08:22:43.901220 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m08:22:43.902148 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m08:22:43.903061 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m08:22:43.903774 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m08:22:43.904853 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m08:22:43.905711 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m08:22:43.906540 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m08:22:43.916133 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m08:22:43.920501 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m08:22:43.925880 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m08:22:43.930128 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m08:22:43.936002 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m08:22:43.936673 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m08:22:43.942979 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m08:22:43.953090 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m08:22:43.987034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:22:43.987499 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:22:43.989835 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:22:43.992680 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:22:44.286333 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m08:22:44.288181 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m08:22:44.292592 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_customer` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
),

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_customer`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.cust_id = DBT_INTERNAL_DEST.cust_id
            )

    
    when matched then update set
        `cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`email` = DBT_INTERNAL_SOURCE.`email`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)
    values
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)


    
[0m08:22:44.293746 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_driver`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m08:22:44.296363 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m08:22:44.303643 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m08:22:44.305470 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.vehicle_id = DBT_INTERNAL_DEST.vehicle_id
            )

    
    when matched then update set
        `vehicle_id` = DBT_INTERNAL_SOURCE.`vehicle_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`vehicle_type` = DBT_INTERNAL_SOURCE.`vehicle_type`,`license_plate` = DBT_INTERNAL_SOURCE.`license_plate`,`year` = DBT_INTERNAL_SOURCE.`year`,`brand` = DBT_INTERNAL_SOURCE.`brand`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)
    values
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)


    
[0m08:22:44.307945 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_ride` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_ride`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ride_id = DBT_INTERNAL_DEST.ride_id
            )

    
    when matched then update set
        `ride_id` = DBT_INTERNAL_SOURCE.`ride_id`,`cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`distance_km` = DBT_INTERNAL_SOURCE.`distance_km`,`fare` = DBT_INTERNAL_SOURCE.`fare`,`ride_status` = DBT_INTERNAL_SOURCE.`ride_status`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)
    values
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)


    
[0m08:22:44.560086 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:898bc365-4a1b-4083-b8c1-dfc45cf4a1f1&page=queryresults
[0m08:22:44.565353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:077de461-4221-4a1c-af9d-237cbc305ec8&page=queryresults
[0m08:22:44.731529 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:077de461-4221-4a1c-af9d-237cbc305ec8&page=queryresults
[0m08:22:44.747043 [debug] [Thread-1 (]: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Unrecognized name: created_at_at; Did you mean created_at? at [35:20]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m08:22:44.749992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '971611f3-095f-4bdc-adff-384ed1f3b5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd358405ed0>]}
[0m08:22:44.751242 [error] [Thread-1 (]: 1 of 4 ERROR creating sql incremental model rizky_dwh_hailing_source.stg_customer  [[31mERROR[0m in 0.85s]
[0m08:22:44.752903 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m08:22:44.754518 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.stg_customer' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer (models/staging/stg_customer.sql)
  Unrecognized name: created_at_at; Did you mean created_at? at [35:20]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql.
[0m08:22:44.836801 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:8a6a3c55-e78c-4954-9742-fd78f2485047&page=queryresults
[0m08:22:45.653035 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:ce572007-8886-46ca-9dbb-0cc80cf42a36&page=queryresults
[0m08:22:46.396178 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '971611f3-095f-4bdc-adff-384ed1f3b5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a5a1d10>]}
[0m08:22:46.398178 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_ride ...... [[32mMERGE (0.0 rows, 15.1 KiB processed)[0m in 2.49s]
[0m08:22:46.399788 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m08:22:46.895988 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '971611f3-095f-4bdc-adff-384ed1f3b5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35842f9d0>]}
[0m08:22:46.897519 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_vehicle ... [[32mMERGE (0.0 rows, 9.3 KiB processed)[0m in 2.99s]
[0m08:22:46.899179 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m08:22:47.464938 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '971611f3-095f-4bdc-adff-384ed1f3b5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a5a1850>]}
[0m08:22:47.466621 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_driver .... [[32mMERGE (0.0 rows, 11.5 KiB processed)[0m in 3.56s]
[0m08:22:47.468175 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m08:22:47.470574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:22:47.473975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:22:47.474902 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m08:22:47.475720 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m08:22:47.476571 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m08:22:47.477315 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m08:22:47.478392 [info ] [MainThread]: 
[0m08:22:47.479390 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m08:22:47.482287 [debug] [MainThread]: Command end result
[0m08:22:47.516280 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:22:47.520396 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:22:47.528804 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m08:22:47.529804 [info ] [MainThread]: 
[0m08:22:47.531162 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:22:47.532243 [info ] [MainThread]: 
[0m08:22:47.533362 [error] [MainThread]:   Database Error in model stg_customer (models/staging/stg_customer.sql)
  Unrecognized name: created_at_at; Did you mean created_at? at [35:20]
  compiled code at target/run/hailing_project/models/staging/stg_customer.sql
[0m08:22:47.534328 [info ] [MainThread]: 
[0m08:22:47.535393 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m08:22:47.537137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.833213, "process_in_blocks": "448", "process_kernel_time": 0.207239, "process_mem_max_rss": "228060", "process_out_blocks": "0", "process_user_time": 3.621758}
[0m08:22:47.538493 [debug] [MainThread]: Command `dbt run` failed at 08:22:47.538312 after 5.83 seconds
[0m08:22:47.539590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3888b5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34a6ba050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3888b4790>]}
[0m08:22:47.540485 [debug] [MainThread]: Flushing usage events
[0m08:22:48.770993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:23:10.006409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480d483bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480d8d84d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480d42f050>]}


============================== 08:23:10.009479 | e8c378eb-1201-41dc-995a-5ef9097b55f0 ==============================
[0m08:23:10.009479 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:23:10.010632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:23:10.703903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8c378eb-1201-41dc-995a-5ef9097b55f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47df546e10>]}
[0m08:23:10.757024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8c378eb-1201-41dc-995a-5ef9097b55f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47e4e14f10>]}
[0m08:23:10.758564 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m08:23:10.834599 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:23:10.985412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:23:10.986755 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/stg_customer.sql
[0m08:23:11.270486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project
- models.dbt_project.example
[0m08:23:11.286192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c378eb-1201-41dc-995a-5ef9097b55f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47df502290>]}
[0m08:23:11.362266 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:23:11.368632 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:23:11.383211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8c378eb-1201-41dc-995a-5ef9097b55f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47df19ea10>]}
[0m08:23:11.384297 [info ] [MainThread]: Found 4 models, 4 sources, 488 macros
[0m08:23:11.386028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8c378eb-1201-41dc-995a-5ef9097b55f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47df1a4610>]}
[0m08:23:11.389244 [info ] [MainThread]: 
[0m08:23:11.390372 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:23:11.391547 [info ] [MainThread]: 
[0m08:23:11.393473 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:23:11.398866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m08:23:11.400111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:23:11.874677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m08:23:11.875625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:23:12.104283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8c378eb-1201-41dc-995a-5ef9097b55f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47df7d4b90>]}
[0m08:23:12.105692 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:23:12.112297 [debug] [Thread-1 (]: Began running node model.hailing_project.stg_customer
[0m08:23:12.112845 [debug] [Thread-2 (]: Began running node model.hailing_project.stg_driver
[0m08:23:12.113454 [debug] [Thread-3 (]: Began running node model.hailing_project.stg_ride
[0m08:23:12.114011 [debug] [Thread-4 (]: Began running node model.hailing_project.stg_vehicle
[0m08:23:12.114755 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.stg_customer ....... [RUN]
[0m08:23:12.116068 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.stg_driver ......... [RUN]
[0m08:23:12.117779 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.stg_ride ........... [RUN]
[0m08:23:12.119291 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.stg_vehicle ........ [RUN]
[0m08:23:12.121170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.stg_customer)
[0m08:23:12.122695 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.stg_driver'
[0m08:23:12.124071 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.stg_ride'
[0m08:23:12.125413 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.stg_vehicle'
[0m08:23:12.126641 [debug] [Thread-1 (]: Began compiling node model.hailing_project.stg_customer
[0m08:23:12.127832 [debug] [Thread-2 (]: Began compiling node model.hailing_project.stg_driver
[0m08:23:12.129124 [debug] [Thread-3 (]: Began compiling node model.hailing_project.stg_ride
[0m08:23:12.130232 [debug] [Thread-4 (]: Began compiling node model.hailing_project.stg_vehicle
[0m08:23:12.144780 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.stg_customer"
[0m08:23:12.150053 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.stg_driver"
[0m08:23:12.157498 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.stg_ride"
[0m08:23:12.161654 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.stg_vehicle"
[0m08:23:12.167988 [debug] [Thread-1 (]: Began executing node model.hailing_project.stg_customer
[0m08:23:12.168905 [debug] [Thread-3 (]: Began executing node model.hailing_project.stg_ride
[0m08:23:12.174713 [debug] [Thread-4 (]: Began executing node model.hailing_project.stg_vehicle
[0m08:23:12.175104 [debug] [Thread-2 (]: Began executing node model.hailing_project.stg_driver
[0m08:23:12.211682 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:23:12.211969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:23:12.214865 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:23:12.218302 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:23:12.538360 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.stg_driver"
[0m08:23:12.539920 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.stg_ride"
[0m08:23:12.540565 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.stg_vehicle"
[0m08:23:12.537091 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.stg_customer"
[0m08:23:12.545917 [debug] [Thread-2 (]: On model.hailing_project.stg_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_driver`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m08:23:12.546812 [debug] [Thread-4 (]: On model.hailing_project.stg_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_vehicle"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_vehicle`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.vehicle_id = DBT_INTERNAL_DEST.vehicle_id
            )

    
    when matched then update set
        `vehicle_id` = DBT_INTERNAL_SOURCE.`vehicle_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`vehicle_type` = DBT_INTERNAL_SOURCE.`vehicle_type`,`license_plate` = DBT_INTERNAL_SOURCE.`license_plate`,`year` = DBT_INTERNAL_SOURCE.`year`,`brand` = DBT_INTERNAL_SOURCE.`brand`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)
    values
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)


    
[0m08:23:12.548862 [debug] [Thread-3 (]: On model.hailing_project.stg_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_ride"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_ride` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_ride`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ride_id = DBT_INTERNAL_DEST.ride_id
            )

    
    when matched then update set
        `ride_id` = DBT_INTERNAL_SOURCE.`ride_id`,`cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`distance_km` = DBT_INTERNAL_SOURCE.`distance_km`,`fare` = DBT_INTERNAL_SOURCE.`fare`,`ride_status` = DBT_INTERNAL_SOURCE.`ride_status`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)
    values
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)


    
[0m08:23:12.551573 [debug] [Thread-1 (]: On model.hailing_project.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.stg_customer"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`stg_customer` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
),

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`stg_customer`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.cust_id = DBT_INTERNAL_DEST.cust_id
            )

    
    when matched then update set
        `cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`email` = DBT_INTERNAL_SOURCE.`email`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)
    values
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)


    
[0m08:23:12.794914 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:6988f829-1759-42d0-bb8d-9fadc9750f5c&page=queryresults
[0m08:23:12.795537 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:4e4cccf0-ba08-4fe6-b244-40d31183711b&page=queryresults
[0m08:23:12.812820 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a3a3a744-253c-4f7b-b4c1-e911e23fb65b&page=queryresults
[0m08:23:12.840339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:27a1e004-58ca-4360-83e5-3d73608b0a5d&page=queryresults
[0m08:23:14.364948 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c378eb-1201-41dc-995a-5ef9097b55f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47df323a50>]}
[0m08:23:14.366262 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_vehicle ... [[32mMERGE (0.0 rows, 9.3 KiB processed)[0m in 2.24s]
[0m08:23:14.368496 [debug] [Thread-4 (]: Finished running node model.hailing_project.stg_vehicle
[0m08:23:14.564064 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c378eb-1201-41dc-995a-5ef9097b55f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47dc75b890>]}
[0m08:23:14.568138 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c378eb-1201-41dc-995a-5ef9097b55f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47dc764ed0>]}
[0m08:23:14.569354 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_ride ...... [[32mMERGE (0.0 rows, 15.1 KiB processed)[0m in 2.44s]
[0m08:23:14.572283 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_driver .... [[32mMERGE (0.0 rows, 11.5 KiB processed)[0m in 2.45s]
[0m08:23:14.574182 [debug] [Thread-3 (]: Finished running node model.hailing_project.stg_ride
[0m08:23:14.575777 [debug] [Thread-2 (]: Finished running node model.hailing_project.stg_driver
[0m08:23:14.609671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c378eb-1201-41dc-995a-5ef9097b55f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47dc74c590>]}
[0m08:23:14.610826 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model rizky_dwh_hailing_source.stg_customer .. [[32mMERGE (0.0 rows, 11.5 KiB processed)[0m in 2.49s]
[0m08:23:14.622350 [debug] [Thread-1 (]: Finished running node model.hailing_project.stg_customer
[0m08:23:14.628976 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:23:14.632897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:23:14.639967 [debug] [MainThread]: Connection 'model.hailing_project.stg_customer' was properly closed.
[0m08:23:14.641615 [debug] [MainThread]: Connection 'model.hailing_project.stg_driver' was properly closed.
[0m08:23:14.642475 [debug] [MainThread]: Connection 'model.hailing_project.stg_ride' was properly closed.
[0m08:23:14.643922 [debug] [MainThread]: Connection 'model.hailing_project.stg_vehicle' was properly closed.
[0m08:23:14.645390 [info ] [MainThread]: 
[0m08:23:14.646648 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m08:23:14.648508 [debug] [MainThread]: Command end result
[0m08:23:14.699662 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:23:14.705466 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:23:14.713966 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m08:23:14.714931 [info ] [MainThread]: 
[0m08:23:14.716212 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:23:14.717633 [info ] [MainThread]: 
[0m08:23:14.718841 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:23:14.720861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.779687, "process_in_blocks": "0", "process_kernel_time": 0.161282, "process_mem_max_rss": "224496", "process_out_blocks": "0", "process_user_time": 3.769968}
[0m08:23:14.721979 [debug] [MainThread]: Command `dbt run` succeeded at 08:23:14.721862 after 4.78 seconds
[0m08:23:14.723011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480d2abdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4810ce8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4810d787d0>]}
[0m08:23:14.724382 [debug] [MainThread]: Flushing usage events
[0m08:23:15.791846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:27:30.959413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3316be3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3316c33f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3316c2b7d0>]}


============================== 08:27:30.962303 | bea2439a-3348-4f55-a283-4c04192d726c ==============================
[0m08:27:30.962303 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:27:30.963575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:27:31.561458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bea2439a-3348-4f55-a283-4c04192d726c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ed06a950>]}
[0m08:27:31.610933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bea2439a-3348-4f55-a283-4c04192d726c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3318e96150>]}
[0m08:27:31.612449 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m08:27:31.682920 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:27:31.822084 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 4 files added, 1 files changed.
[0m08:27:31.823302 [debug] [MainThread]: Partial parsing: added file: hailing_project://models/staging/production_hailing_ride_staging.sql
[0m08:27:31.824261 [debug] [MainThread]: Partial parsing: added file: hailing_project://models/staging/production_hailing_vehicle_staging.sql
[0m08:27:31.825284 [debug] [MainThread]: Partial parsing: added file: hailing_project://models/staging/production_hailing_customer_staging.sql
[0m08:27:31.826110 [debug] [MainThread]: Partial parsing: added file: hailing_project://models/staging/production_hailing_driver_staging.sql
[0m08:27:31.826988 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/sources.yml
[0m08:27:31.827802 [debug] [MainThread]: Partial parsing: deleted file: hailing_project://models/staging/stg_customer.sql
[0m08:27:31.828532 [debug] [MainThread]: Partial parsing: deleted file: hailing_project://models/staging/stg_driver.sql
[0m08:27:31.829297 [debug] [MainThread]: Partial parsing: deleted file: hailing_project://models/staging/stg_ride.sql
[0m08:27:31.830335 [debug] [MainThread]: Partial parsing: deleted file: hailing_project://models/staging/stg_vehicle.sql
[0m08:27:32.183624 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project.example
- models.dbt_project
[0m08:27:32.197759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bea2439a-3348-4f55-a283-4c04192d726c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ec9e8610>]}
[0m08:27:32.277301 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:27:32.283668 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:27:32.298710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bea2439a-3348-4f55-a283-4c04192d726c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ec7f7290>]}
[0m08:27:32.299996 [info ] [MainThread]: Found 4 models, 4 sources, 488 macros
[0m08:27:32.301759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bea2439a-3348-4f55-a283-4c04192d726c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33172d65d0>]}
[0m08:27:32.304783 [info ] [MainThread]: 
[0m08:27:32.306121 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:27:32.307523 [info ] [MainThread]: 
[0m08:27:32.309641 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:27:32.314422 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m08:27:32.316149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:32.905040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m08:27:32.906245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:27:33.111609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bea2439a-3348-4f55-a283-4c04192d726c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ecf7c210>]}
[0m08:27:33.113027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:27:33.120084 [debug] [Thread-1 (]: Began running node model.hailing_project.production_hailing_customer_staging
[0m08:27:33.120622 [debug] [Thread-2 (]: Began running node model.hailing_project.production_hailing_driver_staging
[0m08:27:33.121101 [debug] [Thread-3 (]: Began running node model.hailing_project.production_hailing_ride_staging
[0m08:27:33.121634 [debug] [Thread-4 (]: Began running node model.hailing_project.production_hailing_vehicle_staging
[0m08:27:33.123495 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.production_hailing_customer_staging  [RUN]
[0m08:27:33.125415 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.production_hailing_driver_staging  [RUN]
[0m08:27:33.127184 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.production_hailing_ride_staging  [RUN]
[0m08:27:33.129172 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.production_hailing_vehicle_staging  [RUN]
[0m08:27:33.131370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.production_hailing_customer_staging)
[0m08:27:33.133550 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_driver_staging'
[0m08:27:33.136521 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_ride_staging'
[0m08:27:33.138106 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_vehicle_staging'
[0m08:27:33.139550 [debug] [Thread-1 (]: Began compiling node model.hailing_project.production_hailing_customer_staging
[0m08:27:33.140992 [debug] [Thread-2 (]: Began compiling node model.hailing_project.production_hailing_driver_staging
[0m08:27:33.142840 [debug] [Thread-3 (]: Began compiling node model.hailing_project.production_hailing_ride_staging
[0m08:27:33.144255 [debug] [Thread-4 (]: Began compiling node model.hailing_project.production_hailing_vehicle_staging
[0m08:27:33.154140 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.production_hailing_customer_staging"
[0m08:27:33.159558 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.production_hailing_driver_staging"
[0m08:27:33.165776 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.production_hailing_ride_staging"
[0m08:27:33.170662 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.production_hailing_vehicle_staging"
[0m08:27:33.176842 [debug] [Thread-1 (]: Began executing node model.hailing_project.production_hailing_customer_staging
[0m08:27:33.183716 [debug] [Thread-4 (]: Began executing node model.hailing_project.production_hailing_vehicle_staging
[0m08:27:33.211126 [debug] [Thread-2 (]: Began executing node model.hailing_project.production_hailing_driver_staging
[0m08:27:33.216911 [debug] [Thread-3 (]: Began executing node model.hailing_project.production_hailing_ride_staging
[0m08:27:33.273959 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.production_hailing_vehicle_staging"
[0m08:27:33.274959 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.production_hailing_customer_staging"
[0m08:27:33.277939 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.production_hailing_driver_staging"
[0m08:27:33.282491 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.production_hailing_ride_staging"
[0m08:27:33.287572 [debug] [Thread-1 (]: On model.hailing_project.production_hailing_customer_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_customer_staging"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_staging`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_source`
),

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m08:27:33.288961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:27:33.289427 [debug] [Thread-4 (]: On model.hailing_project.production_hailing_vehicle_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_vehicle_staging"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_staging`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_source`
)

SELECT *
FROM source

    );
  
[0m08:27:33.290744 [debug] [Thread-3 (]: On model.hailing_project.production_hailing_ride_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_ride_staging"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_staging`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_source`
)

SELECT *
FROM source

    );
  
[0m08:27:33.291570 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:27:33.292389 [debug] [Thread-2 (]: On model.hailing_project.production_hailing_driver_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_driver_staging"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_staging`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_source`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m08:27:33.294527 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:27:33.318625 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:27:33.706692 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:7fc33d6e-81d0-4263-95bf-1c8956f8c172&page=queryresults
[0m08:27:33.716220 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:31085e80-a3cf-4850-9b4a-0e89417e82c9&page=queryresults
[0m08:27:33.722078 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:bc8394a4-3750-4e31-b3a2-1d3aeabb0b44&page=queryresults
[0m08:27:33.726232 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9066ce79-d874-4f6f-a75a-2e05455cc4ce&page=queryresults
[0m08:27:35.593557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bea2439a-3348-4f55-a283-4c04192d726c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ecfab0d0>]}
[0m08:27:35.595426 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bea2439a-3348-4f55-a283-4c04192d726c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ec45b050>]}
[0m08:27:35.597305 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_customer_staging  [[32mCREATE TABLE (85.0 rows, 5.8 KiB processed)[0m in 2.46s]
[0m08:27:35.598170 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bea2439a-3348-4f55-a283-4c04192d726c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ec283350>]}
[0m08:27:35.599250 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_vehicle_staging  [[32mCREATE TABLE (85.0 rows, 4.7 KiB processed)[0m in 2.46s]
[0m08:27:35.600598 [debug] [Thread-1 (]: Finished running node model.hailing_project.production_hailing_customer_staging
[0m08:27:35.602178 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_driver_staging  [[32mCREATE TABLE (85.0 rows, 5.8 KiB processed)[0m in 2.46s]
[0m08:27:35.603419 [debug] [Thread-4 (]: Finished running node model.hailing_project.production_hailing_vehicle_staging
[0m08:27:35.605232 [debug] [Thread-2 (]: Finished running node model.hailing_project.production_hailing_driver_staging
[0m08:27:35.617693 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bea2439a-3348-4f55-a283-4c04192d726c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ec7f5f50>]}
[0m08:27:35.618692 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_ride_staging  [[32mCREATE TABLE (85.0 rows, 7.6 KiB processed)[0m in 2.48s]
[0m08:27:35.619871 [debug] [Thread-3 (]: Finished running node model.hailing_project.production_hailing_ride_staging
[0m08:27:35.622893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:27:35.625989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:27:35.626936 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_customer_staging' was properly closed.
[0m08:27:35.627933 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_driver_staging' was properly closed.
[0m08:27:35.628818 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_ride_staging' was properly closed.
[0m08:27:35.629777 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_vehicle_staging' was properly closed.
[0m08:27:35.630671 [info ] [MainThread]: 
[0m08:27:35.631722 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m08:27:35.633318 [debug] [MainThread]: Command end result
[0m08:27:35.668417 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:27:35.673451 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:27:35.682040 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m08:27:35.682934 [info ] [MainThread]: 
[0m08:27:35.684269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:27:35.686117 [info ] [MainThread]: 
[0m08:27:35.687174 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:27:35.688857 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7852182, "process_in_blocks": "0", "process_kernel_time": 0.270995, "process_mem_max_rss": "224704", "process_out_blocks": "0", "process_user_time": 3.663454}
[0m08:27:35.690050 [debug] [MainThread]: Command `dbt run` succeeded at 08:27:35.689879 after 4.79 seconds
[0m08:27:35.691191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3316c2b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3316fddf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f331a508b10>]}
[0m08:27:35.692269 [debug] [MainThread]: Flushing usage events
[0m08:27:36.829557 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:39:38.577262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff88def3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff88def3510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff88dea2d90>]}


============================== 08:39:38.580813 | 5b5196af-75b8-4e53-bbcd-ea4035cf723e ==============================
[0m08:39:38.580813 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:39:38.582552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:39:39.188386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b5196af-75b8-4e53-bbcd-ea4035cf723e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8647dc2d0>]}
[0m08:39:39.233777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b5196af-75b8-4e53-bbcd-ea4035cf723e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff890158b10>]}
[0m08:39:39.235247 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m08:39:39.307329 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:39:39.446764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:39:39.448612 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/sources.yml
[0m08:39:39.801061 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project
- models.dbt_project.example
[0m08:39:39.812341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b5196af-75b8-4e53-bbcd-ea4035cf723e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff88ec64490>]}
[0m08:39:39.884185 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:39:39.891044 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:39:39.905683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b5196af-75b8-4e53-bbcd-ea4035cf723e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8641aed50>]}
[0m08:39:39.906796 [info ] [MainThread]: Found 4 models, 4 sources, 488 macros
[0m08:39:39.908433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b5196af-75b8-4e53-bbcd-ea4035cf723e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85fcf7d90>]}
[0m08:39:39.911366 [info ] [MainThread]: 
[0m08:39:39.912489 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:39:39.913568 [info ] [MainThread]: 
[0m08:39:39.914949 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:39:39.920109 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m08:39:39.921037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:40.503687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m08:39:40.504818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:39:40.773147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b5196af-75b8-4e53-bbcd-ea4035cf723e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff88f098750>]}
[0m08:39:40.774127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:39:40.779144 [debug] [Thread-1 (]: Began running node model.hailing_project.production_hailing_customer_staging
[0m08:39:40.779498 [debug] [Thread-2 (]: Began running node model.hailing_project.production_hailing_driver_staging
[0m08:39:40.779838 [debug] [Thread-3 (]: Began running node model.hailing_project.production_hailing_ride_staging
[0m08:39:40.780118 [debug] [Thread-4 (]: Began running node model.hailing_project.production_hailing_vehicle_staging
[0m08:39:40.780634 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.production_hailing_customer_staging  [RUN]
[0m08:39:40.781653 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.production_hailing_driver_staging  [RUN]
[0m08:39:40.782763 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.production_hailing_ride_staging  [RUN]
[0m08:39:40.783878 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.production_hailing_vehicle_staging  [RUN]
[0m08:39:40.784902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.production_hailing_customer_staging)
[0m08:39:40.785951 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_driver_staging'
[0m08:39:40.786883 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_ride_staging'
[0m08:39:40.788751 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_vehicle_staging'
[0m08:39:40.789745 [debug] [Thread-1 (]: Began compiling node model.hailing_project.production_hailing_customer_staging
[0m08:39:40.790628 [debug] [Thread-2 (]: Began compiling node model.hailing_project.production_hailing_driver_staging
[0m08:39:40.791483 [debug] [Thread-3 (]: Began compiling node model.hailing_project.production_hailing_ride_staging
[0m08:39:40.792417 [debug] [Thread-4 (]: Began compiling node model.hailing_project.production_hailing_vehicle_staging
[0m08:39:40.800291 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.production_hailing_customer_staging"
[0m08:39:40.804776 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.production_hailing_driver_staging"
[0m08:39:40.809609 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.production_hailing_ride_staging"
[0m08:39:40.813770 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.production_hailing_vehicle_staging"
[0m08:39:40.820314 [debug] [Thread-1 (]: Began executing node model.hailing_project.production_hailing_customer_staging
[0m08:39:40.821615 [debug] [Thread-4 (]: Began executing node model.hailing_project.production_hailing_vehicle_staging
[0m08:39:40.827934 [debug] [Thread-3 (]: Began executing node model.hailing_project.production_hailing_ride_staging
[0m08:39:40.848484 [debug] [Thread-2 (]: Began executing node model.hailing_project.production_hailing_driver_staging
[0m08:39:40.905256 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.production_hailing_customer_staging"
[0m08:39:40.905858 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.production_hailing_vehicle_staging"
[0m08:39:40.910465 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.production_hailing_ride_staging"
[0m08:39:40.915140 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.production_hailing_driver_staging"
[0m08:39:40.921371 [debug] [Thread-1 (]: On model.hailing_project.production_hailing_customer_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_customer_staging"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_customer_staging`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_customer`
),

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m08:39:40.923021 [debug] [Thread-2 (]: On model.hailing_project.production_hailing_driver_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_driver_staging"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_driver_staging`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_driver`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m08:39:40.923574 [debug] [Thread-3 (]: On model.hailing_project.production_hailing_ride_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_ride_staging"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_ride_staging`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_ride`
)

SELECT *
FROM source

    );
  
[0m08:39:40.924351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:40.925255 [debug] [Thread-4 (]: On model.hailing_project.production_hailing_vehicle_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_vehicle_staging"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_vehicle_staging`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_vehicle`
)

SELECT *
FROM source

    );
  
[0m08:39:40.925913 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:39:40.927023 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:39:40.929315 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:39:41.431996 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:1363d983-f250-470b-82bc-904e80a950b5&page=queryresults
[0m08:39:41.439151 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9940b5b3-c090-43f4-a64b-faa6760986a4&page=queryresults
[0m08:39:41.448901 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:54c66f7a-af0b-476e-87a8-66e5049e5903&page=queryresults
[0m08:39:41.467382 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:a16d22a3-38b6-46f5-b56a-2a38549df091&page=queryresults
[0m08:39:43.178411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b5196af-75b8-4e53-bbcd-ea4035cf723e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff88e599f90>]}
[0m08:39:43.178990 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b5196af-75b8-4e53-bbcd-ea4035cf723e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85c138210>]}
[0m08:39:43.179664 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b5196af-75b8-4e53-bbcd-ea4035cf723e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85c11a9d0>]}
[0m08:39:43.180781 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_customer_staging  [[32mCREATE TABLE (85.0 rows, 5.8 KiB processed)[0m in 2.39s]
[0m08:39:43.182279 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_ride_staging  [[32mCREATE TABLE (85.0 rows, 7.6 KiB processed)[0m in 2.39s]
[0m08:39:43.183893 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_driver_staging  [[32mCREATE TABLE (85.0 rows, 5.8 KiB processed)[0m in 2.39s]
[0m08:39:43.187346 [debug] [Thread-1 (]: Finished running node model.hailing_project.production_hailing_customer_staging
[0m08:39:43.188234 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b5196af-75b8-4e53-bbcd-ea4035cf723e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85fa78990>]}
[0m08:39:43.189308 [debug] [Thread-3 (]: Finished running node model.hailing_project.production_hailing_ride_staging
[0m08:39:43.191172 [debug] [Thread-2 (]: Finished running node model.hailing_project.production_hailing_driver_staging
[0m08:39:43.193714 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_vehicle_staging  [[32mCREATE TABLE (85.0 rows, 4.7 KiB processed)[0m in 2.40s]
[0m08:39:43.197053 [debug] [Thread-4 (]: Finished running node model.hailing_project.production_hailing_vehicle_staging
[0m08:39:43.199905 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:39:43.204144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:39:43.205339 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_customer_staging' was properly closed.
[0m08:39:43.206770 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_driver_staging' was properly closed.
[0m08:39:43.207741 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_ride_staging' was properly closed.
[0m08:39:43.208462 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_vehicle_staging' was properly closed.
[0m08:39:43.209673 [info ] [MainThread]: 
[0m08:39:43.210887 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m08:39:43.212824 [debug] [MainThread]: Command end result
[0m08:39:43.250261 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:39:43.255282 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:39:43.264495 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m08:39:43.265487 [info ] [MainThread]: 
[0m08:39:43.266789 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:39:43.267931 [info ] [MainThread]: 
[0m08:39:43.269090 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:39:43.270753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.754618, "process_in_blocks": "0", "process_kernel_time": 0.178834, "process_mem_max_rss": "224996", "process_out_blocks": "0", "process_user_time": 3.646234}
[0m08:39:43.271813 [debug] [MainThread]: Command `dbt run` succeeded at 08:39:43.271665 after 4.76 seconds
[0m08:39:43.272837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff88e38b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8917ba890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8917bbe10>]}
[0m08:39:43.273980 [debug] [MainThread]: Flushing usage events
[0m08:39:44.535912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:41:44.508859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe0015f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdfc1db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdfc6ba90>]}


============================== 08:41:44.511995 | 9e13fda7-806a-4f8c-92f7-037962eb7068 ==============================
[0m08:41:44.511995 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:41:44.513392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:41:45.091789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e13fda7-806a-4f8c-92f7-037962eb7068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb81d5750>]}
[0m08:41:45.139722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e13fda7-806a-4f8c-92f7-037962eb7068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe1e91f50>]}
[0m08:41:45.141190 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m08:41:45.208456 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:41:45.354277 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 4 files added, 0 files changed.
[0m08:41:45.355482 [debug] [MainThread]: Partial parsing: added file: hailing_project://models/staging/production_hailing_staging_ride.sql
[0m08:41:45.356515 [debug] [MainThread]: Partial parsing: added file: hailing_project://models/staging/production_hailing_staging_customer.sql
[0m08:41:45.357617 [debug] [MainThread]: Partial parsing: added file: hailing_project://models/staging/production_hailing_staging_driver.sql
[0m08:41:45.358502 [debug] [MainThread]: Partial parsing: added file: hailing_project://models/staging/production_hailing_staging_vehicle.sql
[0m08:41:45.359555 [debug] [MainThread]: Partial parsing: deleted file: hailing_project://models/staging/production_hailing_driver_staging.sql
[0m08:41:45.360456 [debug] [MainThread]: Partial parsing: deleted file: hailing_project://models/staging/production_hailing_customer_staging.sql
[0m08:41:45.361405 [debug] [MainThread]: Partial parsing: deleted file: hailing_project://models/staging/production_hailing_ride_staging.sql
[0m08:41:45.362254 [debug] [MainThread]: Partial parsing: deleted file: hailing_project://models/staging/production_hailing_vehicle_staging.sql
[0m08:41:45.630494 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project.example
- models.dbt_project
[0m08:41:45.642505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e13fda7-806a-4f8c-92f7-037962eb7068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb1e46b10>]}
[0m08:41:45.720003 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:41:45.726872 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:41:45.741856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e13fda7-806a-4f8c-92f7-037962eb7068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb1d9ebd0>]}
[0m08:41:45.742934 [info ] [MainThread]: Found 4 models, 4 sources, 488 macros
[0m08:41:45.744183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e13fda7-806a-4f8c-92f7-037962eb7068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb1f1dd50>]}
[0m08:41:45.747599 [info ] [MainThread]: 
[0m08:41:45.748694 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:41:45.749705 [info ] [MainThread]: 
[0m08:41:45.750723 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:41:45.754864 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m08:41:45.755758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:41:46.326346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m08:41:46.327235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:41:46.584013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e13fda7-806a-4f8c-92f7-037962eb7068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb1f1e310>]}
[0m08:41:46.585502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:41:46.592811 [debug] [Thread-1 (]: Began running node model.hailing_project.production_hailing_staging_customer
[0m08:41:46.593231 [debug] [Thread-2 (]: Began running node model.hailing_project.production_hailing_staging_driver
[0m08:41:46.593562 [debug] [Thread-3 (]: Began running node model.hailing_project.production_hailing_staging_ride
[0m08:41:46.593910 [debug] [Thread-4 (]: Began running node model.hailing_project.production_hailing_staging_vehicle
[0m08:41:46.594450 [info ] [Thread-1 (]: 1 of 4 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_customer  [RUN]
[0m08:41:46.596132 [info ] [Thread-2 (]: 2 of 4 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_driver  [RUN]
[0m08:41:46.597253 [info ] [Thread-3 (]: 3 of 4 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_ride  [RUN]
[0m08:41:46.598298 [info ] [Thread-4 (]: 4 of 4 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_vehicle  [RUN]
[0m08:41:46.599467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.production_hailing_staging_customer)
[0m08:41:46.600500 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_staging_driver'
[0m08:41:46.601496 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_staging_ride'
[0m08:41:46.602530 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_staging_vehicle'
[0m08:41:46.603243 [debug] [Thread-1 (]: Began compiling node model.hailing_project.production_hailing_staging_customer
[0m08:41:46.604029 [debug] [Thread-2 (]: Began compiling node model.hailing_project.production_hailing_staging_driver
[0m08:41:46.604734 [debug] [Thread-3 (]: Began compiling node model.hailing_project.production_hailing_staging_ride
[0m08:41:46.605536 [debug] [Thread-4 (]: Began compiling node model.hailing_project.production_hailing_staging_vehicle
[0m08:41:46.614089 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_customer"
[0m08:41:46.618498 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_driver"
[0m08:41:46.622632 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_ride"
[0m08:41:46.626572 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_vehicle"
[0m08:41:46.631751 [debug] [Thread-4 (]: Began executing node model.hailing_project.production_hailing_staging_vehicle
[0m08:41:46.638684 [debug] [Thread-2 (]: Began executing node model.hailing_project.production_hailing_staging_driver
[0m08:41:46.660511 [debug] [Thread-1 (]: Began executing node model.hailing_project.production_hailing_staging_customer
[0m08:41:46.666438 [debug] [Thread-3 (]: Began executing node model.hailing_project.production_hailing_staging_ride
[0m08:41:46.716323 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_vehicle"
[0m08:41:46.718476 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_driver"
[0m08:41:46.722007 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_customer"
[0m08:41:46.727807 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_ride"
[0m08:41:46.736683 [debug] [Thread-1 (]: On model.hailing_project.production_hailing_staging_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_customer"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_customer`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_customer`
),

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m08:41:46.738298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:41:46.739047 [debug] [Thread-3 (]: On model.hailing_project.production_hailing_staging_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_ride"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_ride`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_ride`
)

SELECT *
FROM source

    );
  
[0m08:41:46.740751 [debug] [Thread-4 (]: On model.hailing_project.production_hailing_staging_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_vehicle"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_vehicle`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_vehicle`
)

SELECT *
FROM source

    );
  
[0m08:41:46.741412 [debug] [Thread-2 (]: On model.hailing_project.production_hailing_staging_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_driver"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_driver`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_driver`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned

    );
  
[0m08:41:46.742243 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:41:46.746092 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:41:46.768762 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:41:47.228720 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:cb0b32c7-6a70-428c-9c74-72a25cffcf1f&page=queryresults
[0m08:41:47.231334 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:486b0192-d722-449f-b154-09c4ef7334d7&page=queryresults
[0m08:41:47.234280 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:860fee08-ffe9-4668-8cbc-cf82af9cd63b&page=queryresults
[0m08:41:47.259504 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:05c35d65-43f5-47e1-a6c4-47b023f0b583&page=queryresults
[0m08:41:49.155470 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e13fda7-806a-4f8c-92f7-037962eb7068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effa1f6c750>]}
[0m08:41:49.155836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e13fda7-806a-4f8c-92f7-037962eb7068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb1fab690>]}
[0m08:41:49.156142 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e13fda7-806a-4f8c-92f7-037962eb7068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe099ea90>]}
[0m08:41:49.157290 [info ] [Thread-2 (]: 2 of 4 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_driver  [[32mCREATE TABLE (85.0 rows, 5.8 KiB processed)[0m in 2.55s]
[0m08:41:49.158635 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_customer  [[32mCREATE TABLE (85.0 rows, 5.8 KiB processed)[0m in 2.56s]
[0m08:41:49.160177 [info ] [Thread-3 (]: 3 of 4 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_ride  [[32mCREATE TABLE (85.0 rows, 7.6 KiB processed)[0m in 2.55s]
[0m08:41:49.161613 [debug] [Thread-2 (]: Finished running node model.hailing_project.production_hailing_staging_driver
[0m08:41:49.162813 [debug] [Thread-1 (]: Finished running node model.hailing_project.production_hailing_staging_customer
[0m08:41:49.164114 [debug] [Thread-3 (]: Finished running node model.hailing_project.production_hailing_staging_ride
[0m08:41:49.177392 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e13fda7-806a-4f8c-92f7-037962eb7068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb1a1ba90>]}
[0m08:41:49.178844 [info ] [Thread-4 (]: 4 of 4 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_vehicle  [[32mCREATE TABLE (85.0 rows, 4.7 KiB processed)[0m in 2.57s]
[0m08:41:49.180411 [debug] [Thread-4 (]: Finished running node model.hailing_project.production_hailing_staging_vehicle
[0m08:41:49.182571 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:41:49.185888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:41:49.186909 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_staging_customer' was properly closed.
[0m08:41:49.187942 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_staging_driver' was properly closed.
[0m08:41:49.188715 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_staging_ride' was properly closed.
[0m08:41:49.189306 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_staging_vehicle' was properly closed.
[0m08:41:49.190023 [info ] [MainThread]: 
[0m08:41:49.190945 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 3.44 seconds (3.44s).
[0m08:41:49.193114 [debug] [MainThread]: Command end result
[0m08:41:49.226359 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:41:49.230612 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:41:49.238958 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m08:41:49.239950 [info ] [MainThread]: 
[0m08:41:49.241156 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:41:49.242717 [info ] [MainThread]: 
[0m08:41:49.244169 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:41:49.245833 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.790658, "process_in_blocks": "0", "process_kernel_time": 0.242733, "process_mem_max_rss": "224756", "process_out_blocks": "0", "process_user_time": 3.499414}
[0m08:41:49.247003 [debug] [MainThread]: Command `dbt run` succeeded at 08:41:49.246894 after 4.79 seconds
[0m08:41:49.247855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdfc6b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdfc9b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe3438c10>]}
[0m08:41:49.248612 [debug] [MainThread]: Flushing usage events
[0m08:41:50.360982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:55:53.438048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9bb843090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9bbd23790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9bb842d90>]}


============================== 08:55:53.440785 | 188f2d7a-2cad-4b2f-9d3b-318ce69a68c5 ==============================
[0m08:55:53.440785 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:55:53.443792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:55:53.541592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '188f2d7a-2cad-4b2f-9d3b-318ce69a68c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9bb740590>]}
[0m08:55:53.616102 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.22455075, "process_in_blocks": "0", "process_kernel_time": 0.119231, "process_mem_max_rss": "89884", "process_out_blocks": "0", "process_user_time": 0.924043}
[0m08:55:53.616990 [debug] [MainThread]: Command `dbt clean` succeeded at 08:55:53.616891 after 0.23 seconds
[0m08:55:53.617840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9bf305850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9bf00cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9bbc3a090>]}
[0m08:55:53.618611 [debug] [MainThread]: Flushing usage events
[0m08:55:54.719266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:55:55.867510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eccfdb250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ecd016150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eccfdad10>]}


============================== 08:55:55.870876 | ab56964a-a0bb-4c5d-8da2-9de161090d50 ==============================
[0m08:55:55.870876 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:55:55.872480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:55:55.955841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab56964a-a0bb-4c5d-8da2-9de161090d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ecced5d90>]}
[0m08:55:55.967959 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:55:55.970791 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:55:55.972410 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1555311, "process_in_blocks": "0", "process_kernel_time": 0.109292, "process_mem_max_rss": "90120", "process_out_blocks": "0", "process_user_time": 0.963762}
[0m08:55:55.973544 [debug] [MainThread]: Command `dbt deps` succeeded at 08:55:55.973423 after 0.16 seconds
[0m08:55:55.974805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ecd04f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ecd016150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ed07f4b90>]}
[0m08:55:55.975714 [debug] [MainThread]: Flushing usage events
[0m08:55:57.027390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:55:59.333091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ec212f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ec257910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ec256f90>]}


============================== 08:55:59.336082 | 9be4d424-1a46-4f73-b13a-dc52af359668 ==============================
[0m08:55:59.336082 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:55:59.337134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:55:59.954350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9be4d424-1a46-4f73-b13a-dc52af359668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6be4273d0>]}
[0m08:56:00.011637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9be4d424-1a46-4f73-b13a-dc52af359668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ee486150>]}
[0m08:56:00.013063 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m08:56:00.111993 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:56:00.114820 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:56:00.116055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9be4d424-1a46-4f73-b13a-dc52af359668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6be40c890>]}
[0m08:56:00.959452 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_customer (models/facts/dim_customer.sql)
  expected token ',', got 'partition_by'
    line 6
      partition_by={
[0m08:56:00.961679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6971128, "process_in_blocks": "0", "process_kernel_time": 0.173183, "process_mem_max_rss": "212028", "process_out_blocks": "0", "process_user_time": 3.545171}
[0m08:56:00.962928 [debug] [MainThread]: Command `dbt run` failed at 08:56:00.962774 after 1.70 seconds
[0m08:56:00.963870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ec31dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6be517a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ec242b90>]}
[0m08:56:00.964920 [debug] [MainThread]: Flushing usage events
[0m08:56:02.218201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:56:14.289954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d0d97190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d2ba9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d0d96610>]}


============================== 08:56:14.293297 | 47699dbc-bf56-4bee-86af-c67e838e11b7 ==============================
[0m08:56:14.293297 [info ] [MainThread]: Running with dbt=1.9.0
[0m08:56:14.294521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:56:14.927525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47699dbc-bf56-4bee-86af-c67e838e11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a80db5d0>]}
[0m08:56:14.972869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47699dbc-bf56-4bee-86af-c67e838e11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d300c710>]}
[0m08:56:14.974099 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m08:56:15.043632 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m08:56:15.047056 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:56:15.048294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '47699dbc-bf56-4bee-86af-c67e838e11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a9335c90>]}
[0m08:56:16.070617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project
- models.dbt_project.example
[0m08:56:16.083971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47699dbc-bf56-4bee-86af-c67e838e11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a321bd50>]}
[0m08:56:16.160529 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:56:16.166191 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:56:16.180220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47699dbc-bf56-4bee-86af-c67e838e11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a2947010>]}
[0m08:56:16.181182 [info ] [MainThread]: Found 5 models, 4 sources, 488 macros
[0m08:56:16.182253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47699dbc-bf56-4bee-86af-c67e838e11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a2b4c910>]}
[0m08:56:16.185224 [info ] [MainThread]: 
[0m08:56:16.186651 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:56:16.187777 [info ] [MainThread]: 
[0m08:56:16.189187 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:56:16.194044 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m08:56:16.194817 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m08:56:16.195635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:16.196568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:17.174266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now create_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_facts)
[0m08:56:17.175593 [debug] [ThreadPool]: Creating schema "database: "purwadika"
schema: "rizky_dwh_hailing_source_rizky_dwh_hailing_facts"
"
[0m08:56:17.185112 [debug] [ThreadPool]: On create_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_facts: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "connection_name": "create_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_facts"} */
create schema if not exists `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_facts`
  
[0m08:56:17.185993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:56:18.033143 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:US:a4611c7b-5f04-4e83-a696-d54823fc335a&page=queryresults
[0m08:56:18.952582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_facts, now list_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_facts)
[0m08:56:18.953105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m08:56:18.954022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:56:18.955119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:56:19.504221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47699dbc-bf56-4bee-86af-c67e838e11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a2fb3650>]}
[0m08:56:19.505634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:56:19.511265 [debug] [Thread-1 (]: Began running node model.hailing_project.production_hailing_staging_customer
[0m08:56:19.511990 [debug] [Thread-2 (]: Began running node model.hailing_project.production_hailing_staging_driver
[0m08:56:19.512357 [debug] [Thread-3 (]: Began running node model.hailing_project.production_hailing_staging_ride
[0m08:56:19.512797 [debug] [Thread-4 (]: Began running node model.hailing_project.production_hailing_staging_vehicle
[0m08:56:19.513537 [info ] [Thread-1 (]: 1 of 5 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_customer  [RUN]
[0m08:56:19.514609 [info ] [Thread-2 (]: 2 of 5 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_driver  [RUN]
[0m08:56:19.515507 [info ] [Thread-3 (]: 3 of 5 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_ride  [RUN]
[0m08:56:19.516567 [info ] [Thread-4 (]: 4 of 5 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_vehicle  [RUN]
[0m08:56:19.517726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source_rizky_dwh_hailing_facts, now model.hailing_project.production_hailing_staging_customer)
[0m08:56:19.519027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.production_hailing_staging_driver)
[0m08:56:19.520188 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_staging_ride'
[0m08:56:19.521117 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_staging_vehicle'
[0m08:56:19.521991 [debug] [Thread-1 (]: Began compiling node model.hailing_project.production_hailing_staging_customer
[0m08:56:19.522896 [debug] [Thread-2 (]: Began compiling node model.hailing_project.production_hailing_staging_driver
[0m08:56:19.523746 [debug] [Thread-3 (]: Began compiling node model.hailing_project.production_hailing_staging_ride
[0m08:56:19.524590 [debug] [Thread-4 (]: Began compiling node model.hailing_project.production_hailing_staging_vehicle
[0m08:56:19.535354 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_customer"
[0m08:56:19.540152 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_driver"
[0m08:56:19.545159 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_ride"
[0m08:56:19.549713 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_vehicle"
[0m08:56:19.564158 [debug] [Thread-1 (]: Began executing node model.hailing_project.production_hailing_staging_customer
[0m08:56:19.570611 [debug] [Thread-4 (]: Began executing node model.hailing_project.production_hailing_staging_vehicle
[0m08:56:19.589141 [debug] [Thread-3 (]: Began executing node model.hailing_project.production_hailing_staging_ride
[0m08:56:19.608163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:19.609444 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:56:19.609835 [debug] [Thread-2 (]: Began executing node model.hailing_project.production_hailing_staging_driver
[0m08:56:19.612375 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:56:19.617880 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:56:19.911915 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_customer"
[0m08:56:19.915510 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_vehicle"
[0m08:56:19.916741 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_ride"
[0m08:56:19.918280 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_driver"
[0m08:56:19.929276 [debug] [Thread-1 (]: On model.hailing_project.production_hailing_staging_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_customer"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_customer` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_customer`
),

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_customer`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.cust_id = DBT_INTERNAL_DEST.cust_id
            )

    
    when matched then update set
        `cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`email` = DBT_INTERNAL_SOURCE.`email`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)
    values
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)


    
[0m08:56:19.930726 [debug] [Thread-2 (]: On model.hailing_project.production_hailing_staging_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_driver`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_driver`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m08:56:19.934719 [debug] [Thread-4 (]: On model.hailing_project.production_hailing_staging_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_vehicle"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_vehicle` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_vehicle`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_vehicle`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.vehicle_id = DBT_INTERNAL_DEST.vehicle_id
            )

    
    when matched then update set
        `vehicle_id` = DBT_INTERNAL_SOURCE.`vehicle_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`vehicle_type` = DBT_INTERNAL_SOURCE.`vehicle_type`,`license_plate` = DBT_INTERNAL_SOURCE.`license_plate`,`year` = DBT_INTERNAL_SOURCE.`year`,`brand` = DBT_INTERNAL_SOURCE.`brand`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)
    values
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)


    
[0m08:56:19.937538 [debug] [Thread-3 (]: On model.hailing_project.production_hailing_staging_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_ride"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_ride` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_ride`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_ride`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ride_id = DBT_INTERNAL_DEST.ride_id
            )

    
    when matched then update set
        `ride_id` = DBT_INTERNAL_SOURCE.`ride_id`,`cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`distance_km` = DBT_INTERNAL_SOURCE.`distance_km`,`fare` = DBT_INTERNAL_SOURCE.`fare`,`ride_status` = DBT_INTERNAL_SOURCE.`ride_status`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)
    values
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)


    
[0m08:56:20.261435 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d34d8f83-627d-4416-95ee-161fecb8b93d&page=queryresults
[0m08:56:20.261907 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:b945e293-6643-4419-8c69-ba34c7d4dd22&page=queryresults
[0m08:56:20.264128 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:29ebc6f8-24cf-46ca-ad87-cb0162c9c32b&page=queryresults
[0m08:56:20.266154 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:9bd397cb-b8f3-45da-a108-41ad7e513f76&page=queryresults
[0m08:56:21.808083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47699dbc-bf56-4bee-86af-c67e838e11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a29acdd0>]}
[0m08:56:21.809431 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_customer  [[32mMERGE (0.0 rows, 11.5 KiB processed)[0m in 2.29s]
[0m08:56:21.811020 [debug] [Thread-1 (]: Finished running node model.hailing_project.production_hailing_staging_customer
[0m08:56:21.812414 [debug] [Thread-1 (]: Began running node model.hailing_project.dim_customer
[0m08:56:21.813620 [info ] [Thread-1 (]: 5 of 5 START sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_facts.dim_customer  [RUN]
[0m08:56:21.814852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.hailing_project.production_hailing_staging_customer, now model.hailing_project.dim_customer)
[0m08:56:21.815989 [debug] [Thread-1 (]: Began compiling node model.hailing_project.dim_customer
[0m08:56:21.820607 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.dim_customer"
[0m08:56:21.831710 [debug] [Thread-1 (]: Began executing node model.hailing_project.dim_customer
[0m08:56:21.857714 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47699dbc-bf56-4bee-86af-c67e838e11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a2937890>]}
[0m08:56:21.870866 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47699dbc-bf56-4bee-86af-c67e838e11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a16be7d0>]}
[0m08:56:21.872176 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.dim_customer"
[0m08:56:21.872998 [info ] [Thread-4 (]: 4 of 5 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_vehicle  [[32mMERGE (0.0 rows, 9.3 KiB processed)[0m in 2.34s]
[0m08:56:21.874492 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_ride  [[32mMERGE (0.0 rows, 15.1 KiB processed)[0m in 2.35s]
[0m08:56:21.876872 [debug] [Thread-4 (]: Finished running node model.hailing_project.production_hailing_staging_vehicle
[0m08:56:21.877997 [debug] [Thread-3 (]: Finished running node model.hailing_project.production_hailing_staging_ride
[0m08:56:21.885955 [debug] [Thread-1 (]: On model.hailing_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.dim_customer"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source_rizky_dwh_hailing_facts`.`dim_customer`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_customer`
)

SELECT *
FROM source

    );
  
[0m08:56:21.887595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:22.066828 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47699dbc-bf56-4bee-86af-c67e838e11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a1663c10>]}
[0m08:56:22.068223 [info ] [Thread-2 (]: 2 of 5 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_driver  [[32mMERGE (0.0 rows, 11.5 KiB processed)[0m in 2.55s]
[0m08:56:22.069559 [debug] [Thread-2 (]: Finished running node model.hailing_project.production_hailing_staging_driver
[0m08:56:22.145883 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:27053855-795a-4b5e-a8d0-39f127d3302c&page=queryresults
[0m08:56:22.147182 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:27053855-795a-4b5e-a8d0-39f127d3302c&page=queryresults
[0m08:56:22.152102 [debug] [Thread-1 (]: Database Error in model dim_customer (models/facts/dim_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_facts was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/facts/dim_customer.sql
[0m08:56:22.153159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47699dbc-bf56-4bee-86af-c67e838e11b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a03f1750>]}
[0m08:56:22.155106 [error] [Thread-1 (]: 5 of 5 ERROR creating sql incremental model rizky_dwh_hailing_source_rizky_dwh_hailing_facts.dim_customer  [[31mERROR[0m in 0.34s]
[0m08:56:22.157201 [debug] [Thread-1 (]: Finished running node model.hailing_project.dim_customer
[0m08:56:22.158745 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models/facts/dim_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_facts was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/facts/dim_customer.sql.
[0m08:56:22.161659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:56:22.165718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:56:22.166637 [debug] [MainThread]: Connection 'model.hailing_project.dim_customer' was properly closed.
[0m08:56:22.167453 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_staging_driver' was properly closed.
[0m08:56:22.168136 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_staging_ride' was properly closed.
[0m08:56:22.168996 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_staging_vehicle' was properly closed.
[0m08:56:22.170079 [info ] [MainThread]: 
[0m08:56:22.171559 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 5.98 seconds (5.98s).
[0m08:56:22.174005 [debug] [MainThread]: Command end result
[0m08:56:22.211249 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:56:22.215917 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:56:22.225212 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m08:56:22.225981 [info ] [MainThread]: 
[0m08:56:22.226983 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:56:22.228025 [info ] [MainThread]: 
[0m08:56:22.229124 [error] [MainThread]:   Database Error in model dim_customer (models/facts/dim_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_source_rizky_dwh_hailing_facts was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/facts/dim_customer.sql
[0m08:56:22.230038 [info ] [MainThread]: 
[0m08:56:22.231046 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:56:22.232740 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.001722, "process_in_blocks": "0", "process_kernel_time": 0.270523, "process_mem_max_rss": "227580", "process_out_blocks": "0", "process_user_time": 4.318353}
[0m08:56:22.233893 [debug] [MainThread]: Command `dbt run` failed at 08:56:22.233774 after 8.00 seconds
[0m08:56:22.234960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d1192250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d1192490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d0e13650>]}
[0m08:56:22.235975 [debug] [MainThread]: Flushing usage events
[0m08:56:23.522471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:02:51.542904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0058c3bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0058fde110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0058c3bad0>]}


============================== 09:02:51.545550 | 330823d6-ff0a-4567-87ad-72d7c9342a21 ==============================
[0m09:02:51.545550 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:02:51.546773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:02:52.119321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '330823d6-ff0a-4567-87ad-72d7c9342a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0058beac50>]}
[0m09:02:52.177202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '330823d6-ff0a-4567-87ad-72d7c9342a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005ae5a250>]}
[0m09:02:52.178567 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m09:02:52.252413 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:02:52.400017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:02:52.401572 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/sources.yml
[0m09:02:52.402603 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/facts/dim_customer.sql
[0m09:02:52.733720 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project.example
- models.dbt_project
[0m09:02:52.745280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '330823d6-ff0a-4567-87ad-72d7c9342a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002aa17c10>]}
[0m09:02:52.819470 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m09:02:52.825069 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m09:02:52.840761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '330823d6-ff0a-4567-87ad-72d7c9342a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002a9fea10>]}
[0m09:02:52.841995 [info ] [MainThread]: Found 5 models, 8 sources, 488 macros
[0m09:02:52.843352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '330823d6-ff0a-4567-87ad-72d7c9342a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002aa0ce90>]}
[0m09:02:52.846181 [info ] [MainThread]: 
[0m09:02:52.847420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:02:52.848474 [info ] [MainThread]: 
[0m09:02:52.849960 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:02:52.855113 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m09:02:52.856788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:02:53.499168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m09:02:53.500207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:02:53.728327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '330823d6-ff0a-4567-87ad-72d7c9342a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002a9d5c50>]}
[0m09:02:53.729338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:02:53.734358 [debug] [Thread-1 (]: Began running node model.hailing_project.dim_customer
[0m09:02:53.734705 [debug] [Thread-2 (]: Began running node model.hailing_project.production_hailing_staging_customer
[0m09:02:53.735116 [debug] [Thread-3 (]: Began running node model.hailing_project.production_hailing_staging_driver
[0m09:02:53.735495 [debug] [Thread-4 (]: Began running node model.hailing_project.production_hailing_staging_ride
[0m09:02:53.736050 [info ] [Thread-1 (]: 1 of 5 START sql incremental model rizky_dwh_hailing_source.dim_customer ....... [RUN]
[0m09:02:53.737325 [info ] [Thread-2 (]: 2 of 5 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_customer  [RUN]
[0m09:02:53.738564 [info ] [Thread-3 (]: 3 of 5 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_driver  [RUN]
[0m09:02:53.739692 [info ] [Thread-4 (]: 4 of 5 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_ride  [RUN]
[0m09:02:53.741038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.dim_customer)
[0m09:02:53.742016 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_staging_customer'
[0m09:02:53.743448 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_staging_driver'
[0m09:02:53.744709 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_staging_ride'
[0m09:02:53.745860 [debug] [Thread-1 (]: Began compiling node model.hailing_project.dim_customer
[0m09:02:53.747015 [debug] [Thread-2 (]: Began compiling node model.hailing_project.production_hailing_staging_customer
[0m09:02:53.748515 [debug] [Thread-3 (]: Began compiling node model.hailing_project.production_hailing_staging_driver
[0m09:02:53.749682 [debug] [Thread-4 (]: Began compiling node model.hailing_project.production_hailing_staging_ride
[0m09:02:53.757780 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.dim_customer"
[0m09:02:53.764643 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_customer"
[0m09:02:53.768179 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_driver"
[0m09:02:53.772066 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_ride"
[0m09:02:53.777580 [debug] [Thread-3 (]: Began executing node model.hailing_project.production_hailing_staging_driver
[0m09:02:53.778568 [debug] [Thread-2 (]: Began executing node model.hailing_project.production_hailing_staging_customer
[0m09:02:53.779070 [debug] [Thread-1 (]: Began executing node model.hailing_project.dim_customer
[0m09:02:53.779403 [debug] [Thread-4 (]: Began executing node model.hailing_project.production_hailing_staging_ride
[0m09:02:53.827489 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:02:53.828068 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:02:53.851716 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:02:53.858596 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.dim_customer"
[0m09:02:53.933183 [debug] [Thread-1 (]: On model.hailing_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.dim_customer"} */

  
    

    create or replace table `purwadika`.`rizky_dwh_hailing_source`.`dim_customer`
      
    partition by timestamp_trunc(created_at, day)
    

    OPTIONS()
    as (
      

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_customer`
)

SELECT *
FROM source

    );
  
[0m09:02:53.934676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:02:54.152322 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_driver"
[0m09:02:54.153664 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_ride"
[0m09:02:54.154833 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_customer"
[0m09:02:54.159867 [debug] [Thread-3 (]: On model.hailing_project.production_hailing_staging_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_driver`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_driver`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m09:02:54.160491 [debug] [Thread-2 (]: On model.hailing_project.production_hailing_staging_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_customer"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_customer` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_customer`
),

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_customer`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.cust_id = DBT_INTERNAL_DEST.cust_id
            )

    
    when matched then update set
        `cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`email` = DBT_INTERNAL_SOURCE.`email`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)
    values
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)


    
[0m09:02:54.161284 [debug] [Thread-4 (]: On model.hailing_project.production_hailing_staging_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_ride"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_ride` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_ride`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_ride`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ride_id = DBT_INTERNAL_DEST.ride_id
            )

    
    when matched then update set
        `ride_id` = DBT_INTERNAL_SOURCE.`ride_id`,`cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`distance_km` = DBT_INTERNAL_SOURCE.`distance_km`,`fare` = DBT_INTERNAL_SOURCE.`fare`,`ride_status` = DBT_INTERNAL_SOURCE.`ride_status`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)
    values
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)


    
[0m09:02:54.370648 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f6923a34-c577-44dd-b997-85fd21cd509c&page=queryresults
[0m09:02:54.441687 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:293ccd08-85c5-4147-83ce-6594f1c73c86&page=queryresults
[0m09:02:54.481932 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:aa9af51f-d7d5-423b-804e-cd12e703d850&page=queryresults
[0m09:02:54.482568 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:59fc1ea1-e78f-42cd-bf0e-9d46f236fbb2&page=queryresults
[0m09:02:55.997230 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '330823d6-ff0a-4567-87ad-72d7c9342a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002a799f90>]}
[0m09:02:55.998739 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_driver  [[32mMERGE (0.0 rows, 11.5 KiB processed)[0m in 2.25s]
[0m09:02:56.000818 [debug] [Thread-3 (]: Finished running node model.hailing_project.production_hailing_staging_driver
[0m09:02:56.001894 [debug] [Thread-3 (]: Began running node model.hailing_project.production_hailing_staging_vehicle
[0m09:02:56.003167 [info ] [Thread-3 (]: 5 of 5 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_vehicle  [RUN]
[0m09:02:56.004397 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.hailing_project.production_hailing_staging_driver, now model.hailing_project.production_hailing_staging_vehicle)
[0m09:02:56.005565 [debug] [Thread-3 (]: Began compiling node model.hailing_project.production_hailing_staging_vehicle
[0m09:02:56.009769 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_vehicle"
[0m09:02:56.016948 [debug] [Thread-3 (]: Began executing node model.hailing_project.production_hailing_staging_vehicle
[0m09:02:56.021384 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:02:56.254285 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_vehicle"
[0m09:02:56.255329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '330823d6-ff0a-4567-87ad-72d7c9342a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002aa03c10>]}
[0m09:02:56.258163 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model rizky_dwh_hailing_source.dim_customer .. [[32mCREATE TABLE (85.0 rows, 5.7 KiB processed)[0m in 2.51s]
[0m09:02:56.260890 [debug] [Thread-1 (]: Finished running node model.hailing_project.dim_customer
[0m09:02:56.265466 [debug] [Thread-3 (]: On model.hailing_project.production_hailing_staging_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_vehicle"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_vehicle` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_vehicle`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_vehicle`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.vehicle_id = DBT_INTERNAL_DEST.vehicle_id
            )

    
    when matched then update set
        `vehicle_id` = DBT_INTERNAL_SOURCE.`vehicle_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`vehicle_type` = DBT_INTERNAL_SOURCE.`vehicle_type`,`license_plate` = DBT_INTERNAL_SOURCE.`license_plate`,`year` = DBT_INTERNAL_SOURCE.`year`,`brand` = DBT_INTERNAL_SOURCE.`brand`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)
    values
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)


    
[0m09:02:56.308142 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '330823d6-ff0a-4567-87ad-72d7c9342a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00283a4350>]}
[0m09:02:56.309167 [info ] [Thread-4 (]: 4 of 5 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_ride  [[32mMERGE (0.0 rows, 15.1 KiB processed)[0m in 2.56s]
[0m09:02:56.310601 [debug] [Thread-4 (]: Finished running node model.hailing_project.production_hailing_staging_ride
[0m09:02:56.321177 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '330823d6-ff0a-4567-87ad-72d7c9342a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f002a7ea350>]}
[0m09:02:56.322610 [info ] [Thread-2 (]: 2 of 5 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_customer  [[32mMERGE (0.0 rows, 11.5 KiB processed)[0m in 2.58s]
[0m09:02:56.324235 [debug] [Thread-2 (]: Finished running node model.hailing_project.production_hailing_staging_customer
[0m09:02:56.536349 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:d34e8e4e-03a9-4c73-8223-06ff0091a353&page=queryresults
[0m09:02:58.336631 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '330823d6-ff0a-4567-87ad-72d7c9342a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00283bc6d0>]}
[0m09:02:58.337669 [info ] [Thread-3 (]: 5 of 5 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_vehicle  [[32mMERGE (0.0 rows, 9.3 KiB processed)[0m in 2.33s]
[0m09:02:58.339068 [debug] [Thread-3 (]: Finished running node model.hailing_project.production_hailing_staging_vehicle
[0m09:02:58.341586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:02:58.344499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:02:58.346593 [debug] [MainThread]: Connection 'model.hailing_project.dim_customer' was properly closed.
[0m09:02:58.347619 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_staging_customer' was properly closed.
[0m09:02:58.348772 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_staging_vehicle' was properly closed.
[0m09:02:58.349562 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_staging_ride' was properly closed.
[0m09:02:58.350458 [info ] [MainThread]: 
[0m09:02:58.351800 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m09:02:58.354845 [debug] [MainThread]: Command end result
[0m09:02:58.389635 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m09:02:58.393696 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m09:02:58.402108 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m09:02:58.402813 [info ] [MainThread]: 
[0m09:02:58.403912 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:02:58.404872 [info ] [MainThread]: 
[0m09:02:58.405898 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:02:58.407909 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9183664, "process_in_blocks": "0", "process_kernel_time": 0.252014, "process_mem_max_rss": "225460", "process_out_blocks": "0", "process_user_time": 3.659243}
[0m09:02:58.409070 [debug] [MainThread]: Command `dbt run` succeeded at 09:02:58.408936 after 6.92 seconds
[0m09:02:58.410072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0058c5d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0058c5fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005c400b90>]}
[0m09:02:58.411296 [debug] [MainThread]: Flushing usage events
[0m09:02:59.905363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:05:40.652242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0d047210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0d09f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0d09f910>]}


============================== 09:05:40.655139 | 69f36ca5-b52f-4434-9df8-c01e6bfa18b1 ==============================
[0m09:05:40.655139 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:05:40.657692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:05:41.221983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69f36ca5-b52f-4434-9df8-c01e6bfa18b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadf7d8090>]}
[0m09:05:41.272996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69f36ca5-b52f-4434-9df8-c01e6bfa18b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0f2a18d0>]}
[0m09:05:41.274088 [info ] [MainThread]: Registered adapter: bigquery=1.9.0
[0m09:05:41.341978 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m09:05:41.506980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:05:41.508246 [debug] [MainThread]: Partial parsing: updated file: hailing_project://models/staging/sources.yml
[0m09:05:41.843912 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_project.example
- models.dbt_project
[0m09:05:41.857778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69f36ca5-b52f-4434-9df8-c01e6bfa18b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadf1e1210>]}
[0m09:05:41.924061 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m09:05:41.929959 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m09:05:41.945913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69f36ca5-b52f-4434-9df8-c01e6bfa18b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadee1c650>]}
[0m09:05:41.947028 [info ] [MainThread]: Found 5 models, 8 sources, 488 macros
[0m09:05:41.948225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69f36ca5-b52f-4434-9df8-c01e6bfa18b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadecb8d90>]}
[0m09:05:41.951359 [info ] [MainThread]: 
[0m09:05:41.952641 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:05:41.953677 [info ] [MainThread]: 
[0m09:05:41.954813 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:05:41.959141 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_purwadika'
[0m09:05:41.959976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:42.505924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_purwadika, now list_purwadika_rizky_dwh_hailing_source)
[0m09:05:42.508689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:05:42.705898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69f36ca5-b52f-4434-9df8-c01e6bfa18b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadee4bd50>]}
[0m09:05:42.707070 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:05:42.711777 [debug] [Thread-1 (]: Began running node model.hailing_project.dim_customer
[0m09:05:42.712149 [debug] [Thread-2 (]: Began running node model.hailing_project.production_hailing_staging_customer
[0m09:05:42.712530 [debug] [Thread-3 (]: Began running node model.hailing_project.production_hailing_staging_driver
[0m09:05:42.712974 [debug] [Thread-4 (]: Began running node model.hailing_project.production_hailing_staging_ride
[0m09:05:42.713593 [info ] [Thread-1 (]: 1 of 5 START sql incremental model rizky_dwh_hailing_source.dim_customer ....... [RUN]
[0m09:05:42.714723 [info ] [Thread-2 (]: 2 of 5 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_customer  [RUN]
[0m09:05:42.715762 [info ] [Thread-3 (]: 3 of 5 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_driver  [RUN]
[0m09:05:42.716752 [info ] [Thread-4 (]: 4 of 5 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_ride  [RUN]
[0m09:05:42.717724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_purwadika_rizky_dwh_hailing_source, now model.hailing_project.dim_customer)
[0m09:05:42.718797 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_staging_customer'
[0m09:05:42.719745 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_staging_driver'
[0m09:05:42.720696 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.hailing_project.production_hailing_staging_ride'
[0m09:05:42.721593 [debug] [Thread-1 (]: Began compiling node model.hailing_project.dim_customer
[0m09:05:42.722431 [debug] [Thread-2 (]: Began compiling node model.hailing_project.production_hailing_staging_customer
[0m09:05:42.723343 [debug] [Thread-3 (]: Began compiling node model.hailing_project.production_hailing_staging_driver
[0m09:05:42.724209 [debug] [Thread-4 (]: Began compiling node model.hailing_project.production_hailing_staging_ride
[0m09:05:42.733091 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.dim_customer"
[0m09:05:42.737167 [debug] [Thread-2 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_customer"
[0m09:05:42.742361 [debug] [Thread-3 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_driver"
[0m09:05:42.747988 [debug] [Thread-4 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_ride"
[0m09:05:42.757199 [debug] [Thread-4 (]: Began executing node model.hailing_project.production_hailing_staging_ride
[0m09:05:42.758157 [debug] [Thread-1 (]: Began executing node model.hailing_project.dim_customer
[0m09:05:42.759121 [debug] [Thread-3 (]: Began executing node model.hailing_project.production_hailing_staging_driver
[0m09:05:42.759747 [debug] [Thread-2 (]: Began executing node model.hailing_project.production_hailing_staging_customer
[0m09:05:42.808084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:05:42.809762 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:05:42.812481 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:05:42.815776 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:05:43.112639 [debug] [Thread-3 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_driver"
[0m09:05:43.113519 [debug] [Thread-4 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_ride"
[0m09:05:43.115071 [debug] [Thread-2 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_customer"
[0m09:05:43.116180 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.dim_customer"
[0m09:05:43.122014 [debug] [Thread-4 (]: On model.hailing_project.production_hailing_staging_ride: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_ride"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_ride` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_ride`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_ride`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ride_id = DBT_INTERNAL_DEST.ride_id
            )

    
    when matched then update set
        `ride_id` = DBT_INTERNAL_SOURCE.`ride_id`,`cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`distance_km` = DBT_INTERNAL_SOURCE.`distance_km`,`fare` = DBT_INTERNAL_SOURCE.`fare`,`ride_status` = DBT_INTERNAL_SOURCE.`ride_status`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)
    values
        (`ride_id`, `cust_id`, `driver_id`, `start_time`, `end_time`, `distance_km`, `fare`, `ride_status`, `created_at`)


    
[0m09:05:43.122620 [debug] [Thread-3 (]: On model.hailing_project.production_hailing_staging_driver: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_driver"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_driver` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_driver`
),

cleaned AS (
    SELECT
        driver_id,
        name,
        email,
        -- Standardizing phone numbers
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_driver`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.driver_id = DBT_INTERNAL_DEST.driver_id
            )

    
    when matched then update set
        `driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`email` = DBT_INTERNAL_SOURCE.`email`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)
    values
        (`driver_id`, `name`, `email`, `phone_number`, `created_at`)


    
[0m09:05:43.125599 [debug] [Thread-1 (]: On model.hailing_project.dim_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.dim_customer"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`dim_customer` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_facts`.`production_hailing_staging_customer`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`dim_customer`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.vehicle_id = DBT_INTERNAL_DEST.vehicle_id
            )

    
    when matched then update set
        `cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`email` = DBT_INTERNAL_SOURCE.`email`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)
    values
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)


    
[0m09:05:43.127344 [debug] [Thread-2 (]: On model.hailing_project.production_hailing_staging_customer: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_customer"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_customer` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_customer`
),

cleaned AS (
    SELECT
        cust_id,
        name,
        -- Standardizing phone numbers (removing parentheses, dashes, spaces)
        REGEXP_REPLACE(phone_number, r'[\s\-\(\)]', '') AS phone_number,
        email,
        created_at
    FROM source
)

SELECT * FROM cleaned

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_customer`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.cust_id = DBT_INTERNAL_DEST.cust_id
            )

    
    when matched then update set
        `cust_id` = DBT_INTERNAL_SOURCE.`cust_id`,`name` = DBT_INTERNAL_SOURCE.`name`,`phone_number` = DBT_INTERNAL_SOURCE.`phone_number`,`email` = DBT_INTERNAL_SOURCE.`email`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)
    values
        (`cust_id`, `name`, `phone_number`, `email`, `created_at`)


    
[0m09:05:43.421019 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:dc41b09a-2c91-4117-94e1-03dc32416fb4&page=queryresults
[0m09:05:43.421995 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2ebf480d-6083-4b76-b06f-cc075be5146f&page=queryresults
[0m09:05:43.445782 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:f0f01d8c-25fa-49c7-abcb-197fde24211b&page=queryresults
[0m09:05:43.792253 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2a8b8531-8b06-4a7c-90b5-eb8b68f29216&page=queryresults
[0m09:05:43.793595 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:2a8b8531-8b06-4a7c-90b5-eb8b68f29216&page=queryresults
[0m09:05:43.797989 [debug] [Thread-1 (]: Database Error in model dim_customer (models/facts/dim_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_facts was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/facts/dim_customer.sql
[0m09:05:43.800027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69f36ca5-b52f-4434-9df8-c01e6bfa18b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadc2c6610>]}
[0m09:05:43.800929 [error] [Thread-1 (]: 1 of 5 ERROR creating sql incremental model rizky_dwh_hailing_source.dim_customer  [[31mERROR[0m in 1.08s]
[0m09:05:43.802058 [debug] [Thread-1 (]: Finished running node model.hailing_project.dim_customer
[0m09:05:43.802775 [debug] [Thread-1 (]: Began running node model.hailing_project.production_hailing_staging_vehicle
[0m09:05:43.803259 [debug] [Thread-7 (]: Marking all children of 'model.hailing_project.dim_customer' to be skipped because of status 'error'.  Reason: Database Error in model dim_customer (models/facts/dim_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_facts was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/facts/dim_customer.sql.
[0m09:05:43.803975 [info ] [Thread-1 (]: 5 of 5 START sql incremental model rizky_dwh_hailing_source.production_hailing_staging_vehicle  [RUN]
[0m09:05:43.806136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.hailing_project.dim_customer, now model.hailing_project.production_hailing_staging_vehicle)
[0m09:05:43.806851 [debug] [Thread-1 (]: Began compiling node model.hailing_project.production_hailing_staging_vehicle
[0m09:05:43.811173 [debug] [Thread-1 (]: Writing injected SQL for node "model.hailing_project.production_hailing_staging_vehicle"
[0m09:05:43.817349 [debug] [Thread-1 (]: Began executing node model.hailing_project.production_hailing_staging_vehicle
[0m09:05:43.821184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:05:44.027398 [debug] [Thread-1 (]: Writing runtime sql for node "model.hailing_project.production_hailing_staging_vehicle"
[0m09:05:44.035178 [debug] [Thread-1 (]: On model.hailing_project.production_hailing_staging_vehicle: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "hailing_project", "target_name": "dev", "node_id": "model.hailing_project.production_hailing_staging_vehicle"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_vehicle` as DBT_INTERNAL_DEST
        using (

WITH source AS (
    SELECT *
    FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_source_vehicle`
)

SELECT *
FROM source

    WHERE created_at > (
        SELECT MAX(created_at)
        FROM `purwadika`.`rizky_dwh_hailing_source`.`production_hailing_staging_vehicle`
    )

        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.vehicle_id = DBT_INTERNAL_DEST.vehicle_id
            )

    
    when matched then update set
        `vehicle_id` = DBT_INTERNAL_SOURCE.`vehicle_id`,`driver_id` = DBT_INTERNAL_SOURCE.`driver_id`,`vehicle_type` = DBT_INTERNAL_SOURCE.`vehicle_type`,`license_plate` = DBT_INTERNAL_SOURCE.`license_plate`,`year` = DBT_INTERNAL_SOURCE.`year`,`brand` = DBT_INTERNAL_SOURCE.`brand`,`created_at` = DBT_INTERNAL_SOURCE.`created_at`
    

    when not matched then insert
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)
    values
        (`vehicle_id`, `driver_id`, `vehicle_type`, `license_plate`, `year`, `brand`, `created_at`)


    
[0m09:05:44.295538 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=purwadika&j=bq:asia-southeast2:1650f28a-0e0d-472d-9078-a9b6e4b6dc61&page=queryresults
[0m09:05:44.982314 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69f36ca5-b52f-4434-9df8-c01e6bfa18b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadc1a4910>]}
[0m09:05:44.984122 [info ] [Thread-4 (]: 4 of 5 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_ride  [[32mMERGE (0.0 rows, 15.1 KiB processed)[0m in 2.26s]
[0m09:05:44.985539 [debug] [Thread-4 (]: Finished running node model.hailing_project.production_hailing_staging_ride
[0m09:05:45.233156 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69f36ca5-b52f-4434-9df8-c01e6bfa18b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feac6ec44d0>]}
[0m09:05:45.235443 [info ] [Thread-3 (]: 3 of 5 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_driver  [[32mMERGE (0.0 rows, 11.5 KiB processed)[0m in 2.51s]
[0m09:05:45.237945 [debug] [Thread-3 (]: Finished running node model.hailing_project.production_hailing_staging_driver
[0m09:05:45.255788 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69f36ca5-b52f-4434-9df8-c01e6bfa18b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadc2c0210>]}
[0m09:05:45.257290 [info ] [Thread-2 (]: 2 of 5 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_customer  [[32mMERGE (0.0 rows, 11.5 KiB processed)[0m in 2.54s]
[0m09:05:45.258591 [debug] [Thread-2 (]: Finished running node model.hailing_project.production_hailing_staging_customer
[0m09:05:46.947955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69f36ca5-b52f-4434-9df8-c01e6bfa18b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadc298f50>]}
[0m09:05:46.949453 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model rizky_dwh_hailing_source.production_hailing_staging_vehicle  [[32mMERGE (0.0 rows, 9.3 KiB processed)[0m in 3.14s]
[0m09:05:46.950578 [debug] [Thread-1 (]: Finished running node model.hailing_project.production_hailing_staging_vehicle
[0m09:05:46.952496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:05:46.955351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:05:46.955931 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_staging_vehicle' was properly closed.
[0m09:05:46.956816 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_staging_customer' was properly closed.
[0m09:05:46.957511 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_staging_driver' was properly closed.
[0m09:05:46.958173 [debug] [MainThread]: Connection 'model.hailing_project.production_hailing_staging_ride' was properly closed.
[0m09:05:46.959013 [info ] [MainThread]: 
[0m09:05:46.959783 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m09:05:46.961654 [debug] [MainThread]: Command end result
[0m09:05:46.996389 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m09:05:47.001341 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m09:05:47.010074 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m09:05:47.010829 [info ] [MainThread]: 
[0m09:05:47.012168 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:05:47.013214 [info ] [MainThread]: 
[0m09:05:47.014350 [error] [MainThread]:   Database Error in model dim_customer (models/facts/dim_customer.sql)
  Not found: Dataset purwadika:rizky_dwh_hailing_facts was not found in location asia-southeast2
  compiled code at target/run/hailing_project/models/facts/dim_customer.sql
[0m09:05:47.015429 [info ] [MainThread]: 
[0m09:05:47.016467 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m09:05:47.018282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.4130325, "process_in_blocks": "0", "process_kernel_time": 0.23354, "process_mem_max_rss": "228600", "process_out_blocks": "0", "process_user_time": 3.564031}
[0m09:05:47.019699 [debug] [MainThread]: Command `dbt run` failed at 09:05:47.019516 after 6.41 seconds
[0m09:05:47.020730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0cec76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10995290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10995390>]}
[0m09:05:47.021595 [debug] [MainThread]: Flushing usage events
[0m09:05:48.408742 [debug] [MainThread]: An error was encountered while trying to flush usage events
